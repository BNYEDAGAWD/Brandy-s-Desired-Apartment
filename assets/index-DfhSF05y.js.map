{"version":3,"file":"index-DfhSF05y.js","sources":["../../js/deepsearch-client.js","../../js/real-search-engine.js","../../js/scoring.js","../../js/lazy-loading.js","../../js/link-health-monitor.js","../../js/app.js"],"sourcesContent":["/**\n * DeepSearchAgent Client\n * Handles communication with the Python DeepSearchAgent backend\n */\nexport class DeepSearchClient {\n    constructor() {\n        // Try local development first, fallback to production\n        this.baseUrl = this.detectBackendUrl();\n        this.isBackendAvailable = false;\n        this.lastHealthCheck = null;\n    }\n\n    detectBackendUrl() {\n        // Check if we're in development mode\n        const isDev = window.location.hostname === 'localhost' || \n                      window.location.hostname === '127.0.0.1';\n        \n        if (isDev) {\n            return 'http://localhost:8000';\n        }\n        \n        // For production GitHub Pages, check for deployed backend\n        // You can deploy the backend to Railway, Render, or similar service\n        // and update this URL when ready\n        \n        // For now, always try localhost first (for local development)\n        // Then fall back to demo mode if not available\n        return 'http://localhost:8000';\n    }\n\n    async checkHealth() {\n        if (!this.baseUrl) {\n            return { available: false, reason: 'Backend URL not configured' };\n        }\n\n        try {\n            const controller = new AbortController();\n            const timeoutId = setTimeout(() => controller.abort(), 5000);\n            \n            const response = await fetch(`${this.baseUrl}/health`, {\n                method: 'GET',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                // Short timeout for health check\n                signal: controller.signal\n            });\n            \n            clearTimeout(timeoutId);\n\n            if (response.ok) {\n                const health = await response.json();\n                this.isBackendAvailable = health.agent_ready;\n                this.lastHealthCheck = new Date();\n                return { available: this.isBackendAvailable, health };\n            } else {\n                return { available: false, reason: `HTTP ${response.status}` };\n            }\n        } catch (error) {\n            this.isBackendAvailable = false;\n            return { \n                available: false, \n                reason: error.name === 'AbortError' ? 'Timeout' : error.message \n            };\n        }\n    }\n\n    async searchApartments(zipCodes = null, filters = {}) {\n        // Check backend availability first\n        const healthCheck = await this.checkHealth();\n        if (!healthCheck.available) {\n            throw new Error(`DeepSearchAgent backend not available: ${healthCheck.reason}`);\n        }\n\n        try {\n            const requestBody = {\n                zip_codes: zipCodes,\n                max_results: filters.maxResults || 50,\n                filters: {\n                    min_price: filters.minPrice,\n                    max_price: filters.maxPrice,\n                    min_score: filters.minScore,\n                    required_amenities: filters.requiredAmenities\n                }\n            };\n\n            console.log('üîç Sending search request to DeepSearchAgent:', requestBody);\n\n            const controller = new AbortController();\n            const timeoutId = setTimeout(() => controller.abort(), 60000);\n            \n            const response = await fetch(`${this.baseUrl}/search`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify(requestBody),\n                // Longer timeout for search requests\n                signal: controller.signal\n            });\n            \n            clearTimeout(timeoutId);\n\n            if (!response.ok) {\n                const errorData = await response.json().catch(() => ({}));\n                throw new Error(errorData.detail || `Search failed with status ${response.status}`);\n            }\n\n            const searchResults = await response.json();\n            console.log('‚úÖ DeepSearchAgent search completed:', searchResults);\n\n            return this.transformSearchResults(searchResults);\n\n        } catch (error) {\n            console.error('‚ùå DeepSearchAgent search failed:', error);\n            throw error;\n        }\n    }\n\n    async verifyListing(listingUrl) {\n        const healthCheck = await this.checkHealth();\n        if (!healthCheck.available) {\n            throw new Error(`DeepSearchAgent backend not available: ${healthCheck.reason}`);\n        }\n\n        try {\n            const controller = new AbortController();\n            const timeoutId = setTimeout(() => controller.abort(), 30000);\n            \n            const response = await fetch(`${this.baseUrl}/verify-listing`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({ listing_url: listingUrl }),\n                signal: controller.signal\n            });\n            \n            clearTimeout(timeoutId);\n\n            if (!response.ok) {\n                throw new Error(`Verification failed with status ${response.status}`);\n            }\n\n            return await response.json();\n\n        } catch (error) {\n            console.error('‚ùå Listing verification failed:', error);\n            throw error;\n        }\n    }\n\n    async getSearchConfig() {\n        const healthCheck = await this.checkHealth();\n        if (!healthCheck.available) {\n            return null;\n        }\n\n        try {\n            const response = await fetch(`${this.baseUrl}/config`);\n            if (response.ok) {\n                return await response.json();\n            }\n        } catch (error) {\n            console.warn('Could not fetch search config:', error);\n        }\n        return null;\n    }\n\n    transformSearchResults(searchResults) {\n        if (!searchResults.success || !searchResults.apartments) {\n            return [];\n        }\n\n        return searchResults.apartments.map(apartment => this.transformApartment(apartment));\n    }\n\n    transformApartment(apartment) {\n        // Transform DeepSearchAgent apartment format to frontend format\n        const transformed = {\n            id: apartment.id || this.generateId(apartment),\n            title: apartment.title || this.generateTitle(apartment),\n            address: apartment.address || 'Address not available',\n            zipCode: apartment.zip_code || apartment.zipCode || 'Unknown',\n            price: apartment.price || 0,\n            bedrooms: apartment.bedrooms || 2,\n            bathrooms: apartment.bathrooms || 1.5,\n            sqft: apartment.sqft || null,\n            floor: apartment.floor || null,\n            \n            // Features and amenities\n            features: this.transformAmenities(apartment.amenities || []),\n            highlightFeatures: this.getHighlightFeatures(apartment.amenities || []),\n            \n            // Status flags\n            recentlyRenovated: this.hasAmenity(apartment.amenities, 'recently_renovated'),\n            premiumAmenities: this.hasPremiumAmenities(apartment.amenities || []),\n            \n            // Dates\n            datePosted: apartment.datePosted || apartment.found_at || new Date().toISOString(),\n            \n            // Source information\n            source: apartment.platform || apartment.source || 'DeepSearch',\n            url: apartment.url || apartment.source_url,\n            \n            // Contact information\n            contact: apartment.contact || {},\n            \n            // Images\n            images: apartment.images || [],\n            \n            // Description\n            description: apartment.description || this.generateDescription(apartment),\n            \n            // Scoring information\n            score: this.calculateDisplayScore(apartment),\n            scoreBreakdown: apartment.validation || {},\n            \n            // URL health and backup information\n            urlHealth: this.transformUrlHealth(apartment),\n            urlHealthSummary: this.generateUrlHealthSummary(apartment),\n            backupUrls: apartment.backup_urls || [],\n            \n            // Metadata\n            searchMetadata: apartment.search_metadata || {},\n            extractedAt: apartment.extracted_at || new Date().toISOString()\n        };\n\n        return transformed;\n    }\n\n    generateId(apartment) {\n        // Generate a unique ID from apartment data\n        const components = [\n            apartment.address || '',\n            apartment.price || '',\n            apartment.bedrooms || '',\n            Date.now()\n        ];\n        return `apt_${components.join('_').replace(/[^a-zA-Z0-9_]/g, '_')}`;\n    }\n\n    generateTitle(apartment) {\n        const bedrooms = apartment.bedrooms || 2;\n        const area = this.extractAreaFromAddress(apartment.address) || 'West LA';\n        return `${bedrooms}-Bedroom Apartment in ${area}`;\n    }\n\n    extractAreaFromAddress(address) {\n        if (!address) return null;\n        \n        const areas = ['Mar Vista', 'Culver City', 'Palms', 'Venice', 'Santa Monica'];\n        for (const area of areas) {\n            if (address.toLowerCase().includes(area.toLowerCase())) {\n                return area;\n            }\n        }\n        return null;\n    }\n\n    transformAmenities(amenities) {\n        // Map DeepSearchAgent amenity format to frontend format\n        const amenityMap = {\n            'washer_dryer': 'In-Unit Washer/Dryer',\n            'air_conditioning': 'Central Air Conditioning',\n            'outdoor_space': 'Private Balcony',\n            'parking': 'Parking Garage',\n            'pool': 'Swimming Pool',\n            'gym': 'Fitness Center',\n            'dishwasher': 'Dishwasher',\n            'hardwood': 'Hardwood Floors',\n            'granite': 'Granite Countertops',\n            'stainless': 'Stainless Steel Appliances'\n        };\n\n        return amenities.map(amenity => amenityMap[amenity] || this.capitalizeAmenity(amenity));\n    }\n\n    capitalizeAmenity(amenity) {\n        return amenity.replace(/_/g, ' ')\n                    .split(' ')\n                    .map(word => word.charAt(0).toUpperCase() + word.slice(1))\n                    .join(' ');\n    }\n\n    getHighlightFeatures(amenities) {\n        const highlights = [\n            'washer_dryer',\n            'air_conditioning', \n            'outdoor_space',\n            'recently_renovated',\n            'hardwood',\n            'granite'\n        ];\n        \n        return amenities.filter(amenity => highlights.includes(amenity))\n                       .map(amenity => this.transformAmenities([amenity])[0]);\n    }\n\n    hasAmenity(amenities, targetAmenity) {\n        return amenities && amenities.includes(targetAmenity);\n    }\n\n    hasPremiumAmenities(amenities) {\n        const premiumFeatures = ['pool', 'gym', 'parking', 'granite', 'stainless'];\n        return premiumFeatures.some(feature => amenities.includes(feature));\n    }\n\n    generateDescription(apartment) {\n        const bedrooms = apartment.bedrooms || 2;\n        const area = this.extractAreaFromAddress(apartment.address) || 'West LA';\n        const price = apartment.price ? `$${apartment.price.toLocaleString()}` : 'Contact for pricing';\n        \n        return `Beautiful ${bedrooms}-bedroom apartment in ${area}. ` +\n               `Rent: ${price}/month. Verified listing found through DeepSearch AI. ` +\n               `Contact directly for viewing and more information.`;\n    }\n\n    calculateDisplayScore(apartment) {\n        // Use validation score if available, otherwise calculate basic score\n        const validation = apartment.validation;\n        if (validation && validation.percentage) {\n            return Math.round(validation.percentage);\n        }\n\n        // Fallback scoring based on available data\n        let score = 60; // Base score\n        \n        // Price appropriateness (within target range)\n        const price = apartment.price || 0;\n        if (price >= 4400 && price <= 5200) {\n            score += 20;\n        }\n        \n        // Required amenities\n        const amenities = apartment.amenities || [];\n        if (amenities.includes('washer_dryer')) score += 5;\n        if (amenities.includes('air_conditioning')) score += 5;\n        if (amenities.includes('outdoor_space')) score += 5;\n        \n        // Premium features\n        if (this.hasPremiumAmenities(amenities)) score += 5;\n        \n        return Math.min(100, Math.max(0, score));\n    }\n\n    transformUrlHealth(apartment) {\n        // DeepSearchAgent provides verification status\n        const verification = apartment.verification;\n        if (!verification) {\n            return { healthy: true, status: 'unverified' };\n        }\n\n        return {\n            healthy: verification.verified,\n            status: verification.verified ? 'verified' : 'failed',\n            error: verification.error,\n            responseTime: verification.response_time,\n            verifiedAt: verification.verified_at\n        };\n    }\n\n    generateUrlHealthSummary(apartment) {\n        const health = this.transformUrlHealth(apartment);\n        \n        if (health.healthy) {\n            return {\n                className: 'healthy',\n                icon: 'fas fa-check-circle',\n                message: 'Link verified and accessible'\n            };\n        } else {\n            return {\n                className: 'error',\n                icon: 'fas fa-exclamation-triangle',\n                message: 'Primary link may not work - see alternatives'\n            };\n        }\n    }\n\n    // Static method to check if DeepSearch is available\n    static async isAvailable() {\n        const client = new DeepSearchClient();\n        const health = await client.checkHealth();\n        return health.available;\n    }\n\n    // Get backend status for debugging\n    getBackendStatus() {\n        return {\n            baseUrl: this.baseUrl,\n            isAvailable: this.isBackendAvailable,\n            lastHealthCheck: this.lastHealthCheck\n        };\n    }\n}","import { DeepSearchClient } from './deepsearch-client.js';\n\n/**\n * Real Apartment Search Engine powered by DeepSearchAgent\n * Replaces all mock data with live search results\n */\nexport class RealApartmentSearchEngine {\n    constructor() {\n        this.searchCriteria = {\n            minRent: 4400,\n            maxRent: 5200,\n            bedrooms: 2,\n            minBathrooms: 1.5,\n            maxBathrooms: 2.0,\n            zipCodes: ['90066', '90230', '90232', '90034'],\n            zipCodePriority: {\n                '90066': 1, // Mar Vista - highest priority\n                '90230': 2, // Central Culver City\n                '90232': 3, // Southeast Culver City\n                '90034': 4  // Palms\n            },\n            requiredAmenities: [\n                'washer_dryer',\n                'air_conditioning',\n                'outdoor_space',\n                'above_ground_floor'\n            ],\n            preferredFeatures: [\n                'recently_renovated',\n                'modern_interior',\n                'natural_light'\n            ]\n        };\n        \n        this.deepSearchClient = new DeepSearchClient();\n        this.isDeepSearchAvailable = false;\n        this.fallbackEnabled = true; // Allow fallback to demo data if needed\n    }\n\n    async searchApartments(progressCallback) {\n        console.log('üè† Starting real apartment search with DeepSearchAgent...');\n        \n        // Check if DeepSearchAgent backend is available\n        const healthCheck = await this.deepSearchClient.checkHealth();\n        this.isDeepSearchAvailable = healthCheck.available;\n        \n        if (progressCallback) progressCallback(10);\n        \n        if (!this.isDeepSearchAvailable) {\n            console.warn('‚ö†Ô∏è DeepSearchAgent not available:', healthCheck.reason);\n            \n            if (this.fallbackEnabled) {\n                console.log('üìã Falling back to demo data mode...');\n                return this.generateDemoData(progressCallback);\n            } else {\n                throw new Error(`DeepSearchAgent backend not available: ${healthCheck.reason}`);\n            }\n        }\n\n        try {\n            // Update progress\n            if (progressCallback) progressCallback(25);\n            \n            // Prepare search filters\n            const searchFilters = {\n                minPrice: this.searchCriteria.minRent,\n                maxPrice: this.searchCriteria.maxRent,\n                maxResults: 50,\n                requiredAmenities: this.searchCriteria.requiredAmenities\n            };\n            \n            console.log('üîç Searching with DeepSearchAgent...', {\n                zipCodes: this.searchCriteria.zipCodes,\n                filters: searchFilters\n            });\n            \n            // Update progress\n            if (progressCallback) progressCallback(50);\n            \n            // Execute search using DeepSearchAgent\n            const searchResults = await this.deepSearchClient.searchApartments(\n                this.searchCriteria.zipCodes,\n                searchFilters\n            );\n            \n            console.log(`‚úÖ DeepSearchAgent found ${searchResults.length} apartments`);\n            \n            // Update progress\n            if (progressCallback) progressCallback(75);\n            \n            // Validate and filter results\n            const validApartments = searchResults.filter(apt => this.validateApartment(apt));\n            \n            console.log(`‚úÖ ${validApartments.length} apartments passed validation`);\n            \n            // Sort by priority (zip code and score)\n            const sortedApartments = this.sortApartmentsByPriority(validApartments);\n            \n            // Update progress\n            if (progressCallback) progressCallback(100);\n            \n            // Log summary\n            this.logSearchSummary(sortedApartments);\n            \n            return sortedApartments;\n            \n        } catch (error) {\n            console.error('‚ùå DeepSearchAgent search failed:', error);\n            \n            if (this.fallbackEnabled) {\n                console.log('üìã Falling back to demo data due to search error...');\n                return this.generateDemoData(progressCallback);\n            } else {\n                throw error;\n            }\n        }\n    }\n\n    validateApartment(apartment) {\n        const criteria = this.searchCriteria;\n        \n        // Check price range\n        if (apartment.price < criteria.minRent || apartment.price > criteria.maxRent) {\n            console.log(`‚ùå Apartment rejected - price ${apartment.price} outside range`);\n            return false;\n        }\n        \n        // Check bedrooms\n        if (apartment.bedrooms !== criteria.bedrooms) {\n            console.log(`‚ùå Apartment rejected - ${apartment.bedrooms} bedrooms, need ${criteria.bedrooms}`);\n            return false;\n        }\n        \n        // Check bathrooms\n        if (apartment.bathrooms < criteria.minBathrooms || apartment.bathrooms > criteria.maxBathrooms) {\n            console.log(`‚ùå Apartment rejected - ${apartment.bathrooms} bathrooms outside range`);\n            return false;\n        }\n        \n        // Check if URL is accessible\n        if (!apartment.url || apartment.url.trim() === '') {\n            console.log(`‚ùå Apartment rejected - no valid URL`);\n            return false;\n        }\n        \n        console.log(`‚úÖ Apartment validated: ${apartment.title}`);\n        return true;\n    }\n\n    sortApartmentsByPriority(apartments) {\n        return apartments.sort((a, b) => {\n            // First sort by zip code priority\n            const priorityA = this.searchCriteria.zipCodePriority[a.zipCode] || 999;\n            const priorityB = this.searchCriteria.zipCodePriority[b.zipCode] || 999;\n            \n            if (priorityA !== priorityB) {\n                return priorityA - priorityB;\n            }\n            \n            // Then sort by score\n            return (b.score || 0) - (a.score || 0);\n        });\n    }\n\n    logSearchSummary(apartments) {\n        console.log('\\nüìä SEARCH SUMMARY:');\n        console.log(`Total apartments found: ${apartments.length}`);\n        \n        // Group by zip code\n        const byZipCode = apartments.reduce((acc, apt) => {\n            acc[apt.zipCode] = (acc[apt.zipCode] || 0) + 1;\n            return acc;\n        }, {});\n        \n        console.log('Breakdown by zip code:');\n        Object.entries(byZipCode).forEach(([zip, count]) => {\n            const area = this.getAreaName(zip);\n            console.log(`  ${zip} (${area}): ${count} apartments`);\n        });\n        \n        // Price range\n        const prices = apartments.map(apt => apt.price).filter(p => p > 0);\n        if (prices.length > 0) {\n            const minPrice = Math.min(...prices);\n            const maxPrice = Math.max(...prices);\n            const avgPrice = Math.round(prices.reduce((sum, p) => sum + p, 0) / prices.length);\n            console.log(`Price range: $${minPrice.toLocaleString()} - $${maxPrice.toLocaleString()} (avg: $${avgPrice.toLocaleString()})`);\n        }\n        \n        // Score distribution\n        const scores = apartments.map(apt => apt.score).filter(s => s > 0);\n        if (scores.length > 0) {\n            const avgScore = Math.round(scores.reduce((sum, s) => sum + s, 0) / scores.length);\n            const highScore = Math.max(...scores);\n            console.log(`Score range: ${Math.min(...scores)} - ${highScore} (avg: ${avgScore})`);\n        }\n        \n        console.log('\\nüéØ Top 5 matches:');\n        apartments.slice(0, 5).forEach((apt, index) => {\n            console.log(`${index + 1}. ${apt.title} - ${apt.address} - $${apt.price} (Score: ${apt.score})`);\n        });\n    }\n\n    getAreaName(zipCode) {\n        const areaMap = {\n            '90066': 'Mar Vista',\n            '90230': 'Culver City',\n            '90232': 'Culver City',\n            '90034': 'Palms'\n        };\n        return areaMap[zipCode] || 'West LA';\n    }\n\n    // Fallback demo data generator (improved version of mock data)\n    async generateDemoData(progressCallback) {\n        console.log('üìã Generating enhanced demo data...');\n        \n        const demoApartments = [];\n        const totalSteps = this.searchCriteria.zipCodes.length;\n        \n        for (let i = 0; i < totalSteps; i++) {\n            const zipCode = this.searchCriteria.zipCodes[i];\n            \n            if (progressCallback) {\n                progressCallback(25 + (i / totalSteps) * 50);\n            }\n            \n            const zipApartments = this.generateZipCodeDemoData(zipCode);\n            demoApartments.push(...zipApartments);\n            \n            // Simulate processing delay\n            await this.delay(200);\n        }\n        \n        if (progressCallback) progressCallback(90);\n        \n        // Add realistic variation and validation\n        const validDemoApartments = demoApartments\n            .filter(apt => this.validateApartment(apt))\n            .map(apt => this.enhanceDemoApartment(apt));\n        \n        if (progressCallback) progressCallback(100);\n        \n        console.log(`üìã Generated ${validDemoApartments.length} demo apartments`);\n        return this.sortApartmentsByPriority(validDemoApartments);\n    }\n\n    generateZipCodeDemoData(zipCode) {\n        const apartmentCount = Math.floor(Math.random() * 8) + 3; // 3-10 apartments per zip\n        const apartments = [];\n        \n        const zipCodeData = {\n            '90066': {\n                areaName: 'Mar Vista',\n                basePrice: 4800,\n                priceVariance: 300,\n                neighborhoods: ['Mar Vista', 'Venice Adjacent']\n            },\n            '90230': {\n                areaName: 'Culver City',\n                basePrice: 4600,\n                priceVariance: 400,\n                neighborhoods: ['Downtown Culver City', 'Arts District']\n            },\n            '90232': {\n                areaName: 'Culver City',\n                basePrice: 4500,\n                priceVariance: 350,\n                neighborhoods: ['Fox Hills', 'Culver West']\n            },\n            '90034': {\n                areaName: 'Palms',\n                basePrice: 4400,\n                priceVariance: 300,\n                neighborhoods: ['Palms', 'Motor Avenue']\n            }\n        };\n        \n        const areaData = zipCodeData[zipCode];\n        \n        for (let i = 0; i < apartmentCount; i++) {\n            const apartment = this.generateSingleDemoApartment(zipCode, areaData, i);\n            apartments.push(apartment);\n        }\n        \n        return apartments;\n    }\n\n    generateSingleDemoApartment(zipCode, areaData, index) {\n        const buildingNumber = Math.floor(Math.random() * 9999) + 1000;\n        const streetNames = [\n            'Pacific Ave', 'Lincoln Blvd', 'Venice Blvd', 'Washington Blvd',\n            'Motor Ave', 'Sepulveda Blvd', 'Culver Blvd', 'Jefferson Blvd'\n        ];\n        const streetName = streetNames[Math.floor(Math.random() * streetNames.length)];\n        \n        // Realistic price calculation\n        const basePrice = areaData.basePrice;\n        const priceOffset = (Math.random() - 0.5) * areaData.priceVariance * 2;\n        const price = Math.max(4400, Math.min(5200, Math.round((basePrice + priceOffset) / 50) * 50));\n        \n        // Realistic apartment features\n        const features = this.generateRealisticFeatures();\n        const bathrooms = Math.random() > 0.4 ? 2.0 : 1.5;\n        const sqft = 900 + Math.floor(Math.random() * 400);\n        const floor = Math.floor(Math.random() * 8) + 2;\n        \n        // Realistic availability\n        const daysAgo = Math.floor(Math.random() * 14); // 0-14 days ago\n        const datePosted = new Date(Date.now() - daysAgo * 24 * 60 * 60 * 1000);\n        \n        return {\n            id: `demo_${zipCode}_${index}_${Date.now()}`,\n            title: `Luxury 2-Bedroom in ${areaData.areaName}`,\n            address: `${buildingNumber} ${streetName}, ${areaData.areaName}, CA ${zipCode}`,\n            zipCode,\n            price,\n            bedrooms: 2,\n            bathrooms,\n            sqft,\n            floor,\n            features,\n            highlightFeatures: this.getHighlightFeatures(features),\n            recentlyRenovated: features.includes('Recently Renovated'),\n            premiumAmenities: features.includes('Swimming Pool') || features.includes('Fitness Center'),\n            datePosted: datePosted.toISOString(),\n            source: 'Demo Data',\n            url: this.generateDemoUrl(areaData.areaName, zipCode),\n            backupUrls: this.generateDemoBackupUrls(areaData.areaName, zipCode),\n            contact: {\n                phone: this.generatePhoneNumber(),\n                email: `leasing@${areaData.areaName.toLowerCase().replace(/\\s/g, '')}apartments.com`\n            },\n            images: this.generateDemoImages(),\n            description: this.generateDemoDescription(areaData.areaName, features),\n            score: 0 // Will be calculated by scoring system\n        };\n    }\n\n    generateRealisticFeatures() {\n        // Always include required amenities for demo\n        const requiredFeatures = [\n            'In-Unit Washer/Dryer',\n            'Central Air Conditioning',\n            'Private Balcony'\n        ];\n        \n        // Optional features with realistic probabilities\n        const optionalFeatures = [\n            { feature: 'Stainless Steel Appliances', probability: 0.8 },\n            { feature: 'Hardwood Floors', probability: 0.6 },\n            { feature: 'Granite Countertops', probability: 0.7 },\n            { feature: 'Walk-in Closet', probability: 0.5 },\n            { feature: 'Swimming Pool', probability: 0.3 },\n            { feature: 'Fitness Center', probability: 0.4 },\n            { feature: 'Parking Garage', probability: 0.9 },\n            { feature: 'Pet Friendly', probability: 0.6 },\n            { feature: 'Dishwasher', probability: 0.8 },\n            { feature: 'Recently Renovated', probability: 0.4 },\n            { feature: 'High Ceilings', probability: 0.5 },\n            { feature: 'Modern Kitchen', probability: 0.7 },\n            { feature: 'Storage Unit', probability: 0.3 }\n        ];\n        \n        const selectedFeatures = [...requiredFeatures];\n        \n        optionalFeatures.forEach(({ feature, probability }) => {\n            if (Math.random() < probability) {\n                selectedFeatures.push(feature);\n            }\n        });\n        \n        return selectedFeatures;\n    }\n\n    getHighlightFeatures(features) {\n        const highlights = [\n            'In-Unit Washer/Dryer',\n            'Central Air Conditioning',\n            'Private Balcony',\n            'Recently Renovated',\n            'Modern Kitchen',\n            'Granite Countertops'\n        ];\n        \n        return features.filter(feature => highlights.includes(feature));\n    }\n\n    generateDemoUrl(areaName, zipCode) {\n        // Generate realistic looking URLs for demo\n        const sources = [\n            'apartments.com',\n            'zillow.com',\n            'trulia.com',\n            'hotpads.com'\n        ];\n        \n        const source = sources[Math.floor(Math.random() * sources.length)];\n        const cleanArea = areaName.toLowerCase().replace(/\\s/g, '-');\n        \n        return `https://www.${source}/${cleanArea}-ca-${zipCode}/apartments-for-rent`;\n    }\n\n    generateDemoBackupUrls(areaName, zipCode) {\n        const query = encodeURIComponent(`${areaName} CA ${zipCode} apartments rent 2 bedroom`);\n        \n        return [\n            {\n                name: 'Google Search',\n                url: `https://www.google.com/search?q=${query}`,\n                type: 'search',\n                priority: 1,\n                description: 'Search all listings'\n            },\n            {\n                name: 'Zillow Rentals',\n                url: `https://www.zillow.com/los-angeles-ca/rentals/`,\n                type: 'listings',\n                priority: 1,\n                description: 'Browse rentals'\n            }\n        ];\n    }\n\n    generatePhoneNumber() {\n        const areaCodes = ['310', '424', '323'];\n        const areaCode = areaCodes[Math.floor(Math.random() * areaCodes.length)];\n        const exchange = Math.floor(Math.random() * 900) + 100;\n        const number = Math.floor(Math.random() * 9000) + 1000;\n        return `(${areaCode}) ${exchange}-${number}`;\n    }\n\n    generateDemoImages() {\n        const imageCount = Math.floor(Math.random() * 4) + 2; // 2-5 images\n        const images = [];\n        \n        for (let i = 0; i < imageCount; i++) {\n            // Use placeholder service for demo images\n            images.push(`https://picsum.photos/600/400?random=${Date.now()}_${i}`);\n        }\n        \n        return images;\n    }\n\n    generateDemoDescription(areaName, features) {\n        const descriptions = [\n            `Beautiful 2-bedroom apartment in the heart of ${areaName}. This stunning unit features modern finishes and premium amenities.`,\n            `Discover luxury living in this contemporary apartment in ${areaName}. Perfectly designed for comfort and style.`,\n            `Spacious and bright 2-bedroom unit in a desirable ${areaName} location. This apartment offers the perfect blend of comfort and convenience.`\n        ];\n        \n        const baseDescription = descriptions[Math.floor(Math.random() * descriptions.length)];\n        const keyFeatures = features.slice(0, 3).join(', ');\n        \n        return `${baseDescription} Key features include: ${keyFeatures}. Contact us today to schedule a viewing! [Demo Data]`;\n    }\n\n    enhanceDemoApartment(apartment) {\n        // Add realistic URL health simulation\n        apartment.urlHealth = {\n            healthy: Math.random() > 0.1, // 90% success rate\n            status: Math.random() > 0.1 ? 'verified' : 'failed',\n            responseTime: Math.floor(Math.random() * 1000) + 200\n        };\n        \n        apartment.urlHealthSummary = apartment.urlHealth.healthy ? {\n            className: 'healthy',\n            icon: 'fas fa-check-circle',\n            message: 'Link verified (Demo Data)'\n        } : {\n            className: 'warning',\n            icon: 'fas fa-exclamation-triangle',\n            message: 'Demo link simulation'\n        };\n        \n        return apartment;\n    }\n\n    delay(ms) {\n        return new Promise(resolve => setTimeout(resolve, ms));\n    }\n\n    // Method to enable/disable fallback mode\n    setFallbackEnabled(enabled) {\n        this.fallbackEnabled = enabled;\n        console.log(`üìã Demo fallback ${enabled ? 'enabled' : 'disabled'}`);\n    }\n\n    // Get search engine status\n    getStatus() {\n        return {\n            deepSearchAvailable: this.isDeepSearchAvailable,\n            fallbackEnabled: this.fallbackEnabled,\n            backendStatus: this.deepSearchClient.getBackendStatus(),\n            searchCriteria: this.searchCriteria\n        };\n    }\n}","export class ApartmentScoring {\n    constructor() {\n        this.weights = {\n            // Base criteria (50 points total)\n            rentInRange: 20,        // Within $4,400-$5,200 range\n            mandatoryAmenities: 30, // All required amenities present\n            \n            // Quality factors (35 points total)\n            renovationRecency: 25,  // Recently renovated (within 10 years)\n            naturalLight: 15,       // Natural light indicators\n            outdoorSpaceQuality: 10, // Quality of balcony/patio/terrace\n            \n            // Location factors (10 points total)\n            zipCodePriority: 10,    // Preferred zip code ranking\n            \n            // Bonus factors (15 points total)\n            premiumAmenities: 5,    // Premium building amenities\n            locationRating: 5,      // Excellent location ratings\n            professionalPhotos: 3,  // Quality listing photos\n            floorLevel: 2,          // Higher floors preferred\n        };\n        \n        this.maxScore = 100;\n    }\n\n    calculateScore(apartment, searchCriteria = {\n        minRent: 4400,\n        maxRent: 5200,\n        zipCodePriority: {\n            '90066': 1,\n            '90230': 2, \n            '90232': 3,\n            '90034': 4\n        }\n    }) {\n        let totalScore = 0;\n        const scoreBreakdown = {};\n        \n        // Base Score: Rent within range (20 points)\n        const rentScore = this.calculateRentScore(apartment.price, searchCriteria);\n        scoreBreakdown.rent = rentScore;\n        totalScore += rentScore;\n        \n        // Mandatory amenities (30 points)\n        const amenityScore = this.calculateMandatoryAmenityScore(apartment);\n        scoreBreakdown.amenities = amenityScore;\n        totalScore += amenityScore;\n        \n        // Renovation recency (25 points)\n        const renovationScore = this.calculateRenovationScore(apartment);\n        scoreBreakdown.renovation = renovationScore;\n        totalScore += renovationScore;\n        \n        // Natural light (15 points)\n        const lightScore = this.calculateNaturalLightScore(apartment);\n        scoreBreakdown.naturalLight = lightScore;\n        totalScore += lightScore;\n        \n        // Outdoor space quality (10 points)\n        const outdoorScore = this.calculateOutdoorSpaceScore(apartment);\n        scoreBreakdown.outdoorSpace = outdoorScore;\n        totalScore += outdoorScore;\n        \n        // Zip code priority (10 points)\n        const locationScore = this.calculateZipCodeScore(apartment.zipCode, searchCriteria);\n        scoreBreakdown.location = locationScore;\n        totalScore += locationScore;\n        \n        // Bonus: Premium amenities (5 points)\n        const premiumScore = this.calculatePremiumAmenitiesScore(apartment);\n        scoreBreakdown.premiumAmenities = premiumScore;\n        totalScore += premiumScore;\n        \n        // Bonus: Location rating (5 points)\n        const ratingScore = this.calculateLocationRatingScore(apartment);\n        scoreBreakdown.locationRating = ratingScore;\n        totalScore += ratingScore;\n        \n        // Bonus: Professional photos (3 points)\n        const photoScore = this.calculatePhotoScore(apartment);\n        scoreBreakdown.photos = photoScore;\n        totalScore += photoScore;\n        \n        // Bonus: Floor level preference (2 points)\n        const floorScore = this.calculateFloorScore(apartment);\n        scoreBreakdown.floor = floorScore;\n        totalScore += floorScore;\n        \n        return Math.round(Math.min(totalScore, this.maxScore));\n    }\n\n    getScoreBreakdown(apartment, searchCriteria = {\n        minRent: 4400,\n        maxRent: 5200,\n        zipCodePriority: {\n            '90066': 1,\n            '90230': 2,\n            '90232': 3, \n            '90034': 4\n        }\n    }) {\n        const breakdown = {};\n        \n        breakdown.price = this.calculateRentScore(apartment.price, searchCriteria);\n        breakdown.specs = this.calculateMandatoryAmenityScore(apartment);\n        breakdown.floor = this.calculateFloorScore(apartment);\n        breakdown.features = this.calculateRenovationScore(apartment) + \n                           this.calculateNaturalLightScore(apartment) + \n                           this.calculateOutdoorSpaceScore(apartment);\n        breakdown.renovation = apartment.recentlyRenovated ? 10 : 0;\n        \n        breakdown.total = Math.min(\n            breakdown.price + breakdown.specs + breakdown.floor + \n            breakdown.features + breakdown.renovation, \n            100\n        );\n        \n        return breakdown;\n    }\n\n    calculateRentScore(price, searchCriteria) {\n        const { minRent, maxRent } = searchCriteria;\n        \n        if (price < minRent || price > maxRent) {\n            return 0;\n        }\n        \n        const optimalRent = (minRent + maxRent) / 2;\n        const maxDeviation = (maxRent - minRent) / 2;\n        const deviation = Math.abs(price - optimalRent);\n        const score = this.weights.rentInRange * (1 - deviation / maxDeviation);\n        \n        return Math.round(score);\n    }\n\n    calculateMandatoryAmenityScore(apartment) {\n        const requiredAmenities = {\n            washerDryer: false,\n            airConditioning: false,\n            outdoorSpace: false,\n            aboveGroundFloor: false\n        };\n        \n        const features = apartment.features.map(f => f.toLowerCase());\n        \n        requiredAmenities.washerDryer = features.some(f => \n            (f.includes('washer') && f.includes('dryer')) || \n            f.includes('w/d') || \n            f.includes('laundry')\n        );\n        \n        requiredAmenities.airConditioning = features.some(f => \n            f.includes('air') || \n            f.includes('conditioning') || \n            f.includes('hvac') ||\n            f.includes('central air')\n        );\n        \n        requiredAmenities.outdoorSpace = features.some(f => \n            f.includes('balcony') || \n            f.includes('patio') || \n            f.includes('terrace') ||\n            f.includes('deck') ||\n            f.includes('outdoor')\n        );\n        \n        requiredAmenities.aboveGroundFloor = apartment.floor > 1;\n        \n        const metRequirements = Object.values(requiredAmenities).filter(Boolean).length;\n        const totalRequirements = Object.keys(requiredAmenities).length;\n        const completionRate = metRequirements / totalRequirements;\n        \n        return Math.round(this.weights.mandatoryAmenities * completionRate);\n    }\n\n    calculateRenovationScore(apartment) {\n        const features = apartment.features.map(f => f.toLowerCase());\n        \n        const renovationKeywords = [\n            'renovated', 'updated', 'remodeled', 'modern', 'new',\n            'contemporary', 'upgraded', 'refreshed', 'redesigned'\n        ];\n        \n        const hasRenovationKeywords = features.some(f => \n            renovationKeywords.some(keyword => f.includes(keyword))\n        );\n        \n        const explicitlyRenovated = apartment.recentlyRenovated || false;\n        \n        const modernAmenities = [\n            'stainless steel', 'granite', 'quartz', 'hardwood',\n            'modern kitchen', 'designer', 'luxury'\n        ];\n        \n        const hasModernAmenities = features.some(f => \n            modernAmenities.some(amenity => f.includes(amenity))\n        );\n        \n        let score = 0;\n        \n        if (explicitlyRenovated) {\n            score = this.weights.renovationRecency;\n        } else if (hasRenovationKeywords && hasModernAmenities) {\n            score = this.weights.renovationRecency * 0.8;\n        } else if (hasRenovationKeywords || hasModernAmenities) {\n            score = this.weights.renovationRecency * 0.5;\n        } else {\n            score = this.weights.renovationRecency * 0.2;\n        }\n        \n        return Math.round(score);\n    }\n\n    calculateNaturalLightScore(apartment) {\n        const features = apartment.features.map(f => f.toLowerCase());\n        const description = apartment.description?.toLowerCase() || '';\n        \n        const lightKeywords = [\n            'natural light', 'bright', 'sunny', 'light-filled',\n            'windows', 'large windows', 'floor-to-ceiling',\n            'multiple exposures', 'corner unit'\n        ];\n        \n        const lightIndicators = features.concat([description]).some(text => \n            lightKeywords.some(keyword => text.includes(keyword))\n        );\n        \n        const floorBonus = apartment.floor > 5 ? 0.2 : 0;\n        \n        let score = 0;\n        \n        if (lightIndicators) {\n            score = this.weights.naturalLight * (0.8 + floorBonus);\n        } else {\n            score = this.weights.naturalLight * (0.4 + floorBonus);\n        }\n        \n        return Math.round(score);\n    }\n\n    calculateOutdoorSpaceScore(apartment) {\n        const features = apartment.features.map(f => f.toLowerCase());\n        \n        const outdoorSpaceTypes = {\n            'private balcony': 1.0,\n            'terrace': 1.0,\n            'private patio': 0.9,\n            'deck': 0.8,\n            'balcony': 0.7,\n            'patio': 0.6,\n            'outdoor': 0.5\n        };\n        \n        let maxScore = 0;\n        \n        for (const [spaceType, multiplier] of Object.entries(outdoorSpaceTypes)) {\n            if (features.some(f => f.includes(spaceType))) {\n                maxScore = Math.max(maxScore, this.weights.outdoorSpaceQuality * multiplier);\n            }\n        }\n        \n        return Math.round(maxScore);\n    }\n\n    calculateZipCodeScore(zipCode, searchCriteria) {\n        const priority = searchCriteria.zipCodePriority[zipCode] || 5;\n        const scoreMultiplier = Math.max(0, (5 - priority) / 4);\n        return Math.round(this.weights.zipCodePriority * scoreMultiplier);\n    }\n\n    calculatePremiumAmenitiesScore(apartment) {\n        const features = apartment.features.map(f => f.toLowerCase());\n        \n        const premiumAmenities = [\n            'swimming pool', 'fitness center', 'gym', 'concierge',\n            'doorman', 'roof deck', 'rooftop', 'parking garage',\n            'valet parking', 'business center', 'club room'\n        ];\n        \n        const premiumCount = features.filter(f => \n            premiumAmenities.some(amenity => f.includes(amenity))\n        ).length;\n        \n        const score = Math.min(premiumCount * 1.5, this.weights.premiumAmenities);\n        return Math.round(score);\n    }\n\n    calculateLocationRatingScore(apartment) {\n        const zipCodeRatings = {\n            '90066': 4.5,\n            '90230': 4.2,\n            '90232': 3.8,\n            '90034': 3.5\n        };\n        \n        const baseRating = zipCodeRatings[apartment.zipCode] || 3.0;\n        const priceBonus = apartment.price > 4800 ? 0.2 : 0;\n        const finalRating = Math.min(baseRating + priceBonus, 5.0);\n        const scoreMultiplier = Math.max(0, (finalRating - 3.0) / 2.0);\n        \n        return Math.round(this.weights.locationRating * scoreMultiplier);\n    }\n\n    calculatePhotoScore(apartment) {\n        const imageCount = apartment.images?.length || 0;\n        \n        if (imageCount >= 5) {\n            return this.weights.professionalPhotos;\n        } else if (imageCount >= 3) {\n            return Math.round(this.weights.professionalPhotos * 0.7);\n        } else if (imageCount >= 1) {\n            return Math.round(this.weights.professionalPhotos * 0.4);\n        } else {\n            return 0;\n        }\n    }\n\n    calculateFloorScore(apartment) {\n        const floor = apartment.floor || 2;\n        \n        if (floor >= 3 && floor <= 6) {\n            return this.weights.floorLevel;\n        } else if (floor === 2 || floor === 7 || floor === 8) {\n            return Math.round(this.weights.floorLevel * 0.7);\n        } else if (floor > 8) {\n            return Math.round(this.weights.floorLevel * 0.5);\n        } else {\n            return 0;\n        }\n    }\n}","/**\n * Lazy Loading utility for property images with Intersection Observer\n * Optimizes performance by loading images only when they enter the viewport\n */\nexport class LazyImageLoader {\n    constructor(options = {}) {\n        this.options = {\n            rootMargin: '50px',\n            threshold: 0.1,\n            placeholderSrc: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9ImciIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPjxzdG9wIG9mZnNldD0iMCUiIHN0b3AtY29sb3I9IiNmNWY1ZjUiLz48c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiNlZWVlZWUiLz48L2xpbmVhckdyYWRpZW50PjwvZGVmcz48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ1cmwoI2cpIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNHB4IiBmaWxsPSIjOTk5OTk5IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIj5Mb2FkaW5nLi4uPC90ZXh0Pjwvc3ZnPg==',\n            errorSrc: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjVmNWY1Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNHB4IiBmaWxsPSIjOTk5OTk5IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIj5JbWFnZSBVbmF2YWlsYWJsZTwvdGV4dD48L3N2Zz4=',\n            fadeInDuration: 300,\n            retryAttempts: 2,\n            retryDelay: 1000,\n            ...options\n        };\n\n        this.observer = null;\n        this.loadedImages = new Set();\n        this.failedImages = new Set();\n        this.retryCount = new Map();\n        \n        this.init();\n    }\n\n    init() {\n        if (!('IntersectionObserver' in window)) {\n            // Fallback for older browsers\n            this.loadAllImages();\n            return;\n        }\n\n        this.observer = new IntersectionObserver((entries) => {\n            entries.forEach(entry => {\n                if (entry.isIntersecting) {\n                    this.loadImage(entry.target);\n                }\n            });\n        }, {\n            rootMargin: this.options.rootMargin,\n            threshold: this.options.threshold\n        });\n\n        this.observeImages();\n    }\n\n    observeImages() {\n        const images = document.querySelectorAll('img[data-src]');\n        images.forEach(img => {\n            if (!this.loadedImages.has(img)) {\n                this.setupImageForLazyLoading(img);\n                this.observer.observe(img);\n            }\n        });\n    }\n\n    setupImageForLazyLoading(img) {\n        // Set placeholder if no src is set\n        if (!img.src || img.src === '') {\n            img.src = this.options.placeholderSrc;\n        }\n\n        // Add loading class\n        img.classList.add('lazy-loading');\n        \n        // Add loading indicator\n        this.addLoadingIndicator(img);\n\n        // Set initial opacity for fade effect\n        img.style.opacity = '0';\n        img.style.transition = `opacity ${this.options.fadeInDuration}ms ease-in-out`;\n    }\n\n    addLoadingIndicator(img) {\n        const container = img.parentElement;\n        if (!container.classList.contains('image-container')) {\n            // Wrap img in container if not already wrapped\n            const wrapper = document.createElement('div');\n            wrapper.className = 'image-container';\n            img.parentNode.insertBefore(wrapper, img);\n            wrapper.appendChild(img);\n        }\n\n        // Add loading indicator\n        if (!container.querySelector('.loading-indicator')) {\n            const indicator = document.createElement('div');\n            indicator.className = 'loading-indicator';\n            indicator.innerHTML = `\n                <div class=\"loading-spinner\">\n                    <div class=\"spinner\"></div>\n                </div>\n            `;\n            container.appendChild(indicator);\n        }\n    }\n\n    async loadImage(img) {\n        const src = img.getAttribute('data-src');\n        if (!src || this.loadedImages.has(img)) {\n            return;\n        }\n\n        try {\n            // Stop observing this image\n            if (this.observer) {\n                this.observer.unobserve(img);\n            }\n\n            // Pre-load the image\n            await this.preloadImage(src);\n\n            // Set the actual source\n            img.src = src;\n            img.removeAttribute('data-src');\n\n            // Add loaded class and fade in\n            img.classList.remove('lazy-loading');\n            img.classList.add('lazy-loaded');\n            \n            // Fade in effect\n            img.style.opacity = '1';\n\n            // Remove loading indicator\n            this.removeLoadingIndicator(img);\n\n            // Mark as loaded\n            this.loadedImages.add(img);\n\n            // Trigger custom event\n            img.dispatchEvent(new CustomEvent('lazyLoaded', {\n                detail: { src, img }\n            }));\n\n        } catch (error) {\n            console.warn('Failed to load image:', src, error);\n            await this.handleImageError(img, src);\n        }\n    }\n\n    preloadImage(src) {\n        return new Promise((resolve, reject) => {\n            const img = new Image();\n            \n            img.onload = () => resolve(img);\n            img.onerror = () => reject(new Error(`Failed to load image: ${src}`));\n            \n            // Set a timeout for the image load\n            setTimeout(() => {\n                reject(new Error(`Image load timeout: ${src}`));\n            }, 10000);\n            \n            img.src = src;\n        });\n    }\n\n    async handleImageError(img, originalSrc) {\n        const retryKey = originalSrc;\n        const currentRetries = this.retryCount.get(retryKey) || 0;\n\n        if (currentRetries < this.options.retryAttempts) {\n            // Retry loading\n            this.retryCount.set(retryKey, currentRetries + 1);\n            \n            await new Promise(resolve => setTimeout(resolve, this.options.retryDelay));\n            \n            try {\n                await this.preloadImage(originalSrc);\n                img.src = originalSrc;\n                img.removeAttribute('data-src');\n                img.classList.remove('lazy-loading');\n                img.classList.add('lazy-loaded');\n                img.style.opacity = '1';\n                this.removeLoadingIndicator(img);\n                this.loadedImages.add(img);\n                return;\n            } catch {\n                console.warn(`Retry ${currentRetries + 1} failed for image:`, originalSrc);\n            }\n        }\n\n        // Final fallback\n        img.src = this.options.errorSrc;\n        img.classList.remove('lazy-loading');\n        img.classList.add('lazy-error');\n        img.style.opacity = '1';\n        this.removeLoadingIndicator(img);\n        this.failedImages.add(img);\n\n        // Trigger error event\n        img.dispatchEvent(new CustomEvent('lazyLoadError', {\n            detail: { originalSrc, img }\n        }));\n    }\n\n    removeLoadingIndicator(img) {\n        const container = img.parentElement;\n        const indicator = container.querySelector('.loading-indicator');\n        if (indicator) {\n            indicator.classList.add('fade-out');\n            setTimeout(() => {\n                if (indicator.parentNode) {\n                    indicator.parentNode.removeChild(indicator);\n                }\n            }, 200);\n        }\n    }\n\n    // Fallback for browsers without Intersection Observer\n    loadAllImages() {\n        const images = document.querySelectorAll('img[data-src]');\n        images.forEach(img => {\n            this.setupImageForLazyLoading(img);\n            this.loadImage(img);\n        });\n    }\n\n    // Refresh observer for dynamically added images\n    refresh() {\n        if (this.observer) {\n            this.observeImages();\n        }\n    }\n\n    // Add new images to be lazy loaded\n    observe(images) {\n        if (!this.observer) return;\n\n        const imgArray = Array.isArray(images) ? images : [images];\n        imgArray.forEach(img => {\n            if (img.tagName === 'IMG' && img.hasAttribute('data-src')) {\n                this.setupImageForLazyLoading(img);\n                this.observer.observe(img);\n            }\n        });\n    }\n\n    // Manually load specific images\n    loadImagesInContainer(container) {\n        const images = container.querySelectorAll('img[data-src]');\n        images.forEach(img => this.loadImage(img));\n    }\n\n    // Get loading statistics\n    getStats() {\n        return {\n            loaded: this.loadedImages.size,\n            failed: this.failedImages.size,\n            pending: document.querySelectorAll('img[data-src]').length\n        };\n    }\n\n    // Destroy the lazy loader\n    destroy() {\n        if (this.observer) {\n            this.observer.disconnect();\n            this.observer = null;\n        }\n        this.loadedImages.clear();\n        this.failedImages.clear();\n        this.retryCount.clear();\n    }\n}\n\n// Create singleton instance\nexport const lazyLoader = new LazyImageLoader();\n\n// Auto-initialize when DOM is ready\nif (typeof window !== 'undefined') {\n    if (document.readyState === 'loading') {\n        document.addEventListener('DOMContentLoaded', () => {\n            lazyLoader.refresh();\n        });\n    } else {\n        lazyLoader.refresh();\n    }\n}","/**\n * Link Health Monitor\n * Monitors and tracks the health of apartment listing URLs\n * Provides fallback mechanisms for dead links\n */\n\nexport class LinkHealthMonitor {\n    constructor() {\n        this.healthCache = new Map();\n        this.maxCacheAge = 5 * 60 * 1000; // 5 minutes\n        this.timeoutDuration = 10000; // 10 seconds\n    }\n\n    /**\n     * Check if a URL is accessible with enhanced error handling\n     * @param {string} url - URL to check\n     * @returns {Promise<{healthy: boolean, status: string, responseTime: number}>}\n     */\n    async checkUrlHealth(url) {\n        // Check cache first\n        const cached = this.getFromCache(url);\n        if (cached) {\n            return cached;\n        }\n\n        const startTime = Date.now();\n        let timeoutId;\n        \n        try {\n            // Enhanced URL validation\n            if (!this.isValidUrl(url)) {\n                throw new Error('Invalid URL format');\n            }\n\n            // Use a timeout to prevent hanging requests\n            const controller = new window.AbortController();\n            timeoutId = setTimeout(() => controller.abort(), this.timeoutDuration);\n\n            // Try multiple methods for better reliability\n            let response;\n            try {\n                // First try HEAD request with no-cors\n                response = await fetch(url, {\n                    method: 'HEAD',\n                    signal: controller.signal,\n                    mode: 'no-cors',\n                    cache: 'no-cache',\n                    redirect: 'follow'\n                });\n            } catch {\n                // If HEAD fails, try GET with no-cors as fallback\n                response = await fetch(url, {\n                    method: 'GET',\n                    signal: controller.signal,\n                    mode: 'no-cors',\n                    cache: 'no-cache',\n                    redirect: 'follow'\n                });\n            }\n\n            clearTimeout(timeoutId);\n            const responseTime = Date.now() - startTime;\n\n            // Enhanced status detection\n            let actualStatus = 'accessible';\n            let healthy = true;\n\n            // For no-cors requests, we can't read the actual status\n            // but if no error was thrown, the URL is likely accessible\n            if (response.type === 'opaque') {\n                actualStatus = 'cors_accessible';\n            } else if (response.status) {\n                actualStatus = response.status;\n                healthy = response.status >= 200 && response.status < 400;\n            }\n\n            const result = {\n                healthy,\n                status: actualStatus,\n                responseTime,\n                lastChecked: Date.now(),\n                method: 'validated'\n            };\n\n            this.setCache(url, result);\n            return result;\n\n        } catch (error) {\n            if (timeoutId) clearTimeout(timeoutId);\n            const responseTime = Date.now() - startTime;\n\n            let status = 'unknown';\n            let healthy = false;\n\n            // Enhanced error classification\n            if (error.name === 'AbortError') {\n                status = 'timeout';\n            } else if (error.message.includes('CORS') || error.message.includes('cross-origin')) {  \n                // CORS blocked - URL might still work for users\n                status = 'cors_blocked';\n                healthy = true; // Assume healthy since we can't verify\n            } else if (error.message.includes('NetworkError') || error.message.includes('Failed to fetch')) {\n                // Check if it's a potential domain issue\n                if (this.isKnownGoodDomain(url)) {\n                    status = 'network_cors';\n                    healthy = true; // Known good domain, likely CORS issue\n                } else {\n                    status = 'network_error';\n                }\n            } else if (error.message.includes('404') || error.message.includes('Not Found')) {\n                status = '404_not_found';\n            } else if (error.message.includes('Invalid URL')) {\n                status = 'invalid_url';\n            } else {\n                status = 'error';\n            }\n\n            const result = {\n                healthy,\n                status,\n                responseTime,\n                error: error.message,\n                lastChecked: Date.now(),\n                method: 'error_detected'\n            };\n\n            this.setCache(url, result);\n            return result;\n        }\n    }\n\n    /**\n     * Validate URL format\n     * @param {string} url - URL to validate\n     * @returns {boolean} Whether URL is valid\n     */\n    isValidUrl(url) {\n        try {\n            const urlObj = new URL(url);\n            return urlObj.protocol === 'http:' || urlObj.protocol === 'https:';\n        } catch {\n            return false;\n        }\n    }\n\n    /**\n     * Check if domain is known to be reliable\n     * @param {string} url - URL to check\n     * @returns {boolean} Whether domain is known good\n     */\n    isKnownGoodDomain(url) {\n        const knownGoodDomains = [\n            'apartments.com',\n            'zillow.com',\n            'trulia.com',\n            'hotpads.com',\n            'westsiderentals.com',\n            'realtor.com',\n            'rent.com',\n            'padmapper.com',\n            'craigslist.org',\n            'facebook.com',\n            'google.com'\n        ];\n\n        try {\n            const hostname = new URL(url).hostname.toLowerCase();\n            return knownGoodDomains.some(domain => hostname.includes(domain));\n        } catch {\n            return false;\n        }\n    }\n\n    /**\n     * Check health of multiple URLs\n     * @param {Array<string>} urls - URLs to check\n     * @returns {Promise<Array<{url: string, health: Object}>>}\n     */\n    async checkMultipleUrls(urls) {\n        const checks = urls.map(async (url) => ({\n            url,\n            health: await this.checkUrlHealth(url)\n        }));\n\n        return await Promise.all(checks);\n    }\n\n    /**\n     * Get health status from cache\n     * @param {string} url - URL to lookup\n     * @returns {Object|null} Cached health result or null\n     */\n    getFromCache(url) {\n        const cached = this.healthCache.get(url);\n        if (cached && (Date.now() - cached.lastChecked) < this.maxCacheAge) {\n            return cached;\n        }\n        return null;\n    }\n\n    /**\n     * Store health status in cache\n     * @param {string} url - URL to cache\n     * @param {Object} result - Health check result\n     */\n    setCache(url, result) {\n        this.healthCache.set(url, result);\n        \n        // Clean up old cache entries periodically\n        if (this.healthCache.size > 100) {\n            this.cleanupCache();\n        }\n    }\n\n    /**\n     * Remove old entries from cache\n     */\n    cleanupCache() {\n        const now = Date.now();\n        for (const [url, result] of this.healthCache.entries()) {\n            if ((now - result.lastChecked) > this.maxCacheAge) {\n                this.healthCache.delete(url);\n            }\n        }\n    }\n\n    /**\n     * Get health summary for UI display\n     * @param {Object} healthResult - Result from checkUrlHealth\n     * @returns {Object} UI-friendly health summary\n     */\n    getHealthSummary(healthResult) {\n        const { healthy, status, responseTime, error } = healthResult;\n\n        let summary = {\n            className: 'unknown',\n            icon: 'fas fa-question-circle',\n            message: 'Unknown status',\n            color: '#6c757d'\n        };\n\n        if (healthy) {\n            if (status === 'cors_blocked') {\n                summary = {\n                    className: 'warning',\n                    icon: 'fas fa-exclamation-triangle',\n                    message: 'Cannot verify (CORS), but likely accessible',\n                    color: '#f39c12'\n                };\n            } else {\n                summary = {\n                    className: 'healthy',\n                    icon: 'fas fa-check-circle',\n                    message: `Accessible (${responseTime}ms)`,\n                    color: '#27ae60'\n                };\n            }\n        } else {\n            switch (status) {\n                case 'timeout':\n                    summary = {\n                        className: 'error',\n                        icon: 'fas fa-clock',\n                        message: 'Connection timeout',\n                        color: '#e74c3c'\n                    };\n                    break;\n                case '404_not_found':\n                    summary = {\n                        className: 'error',\n                        icon: 'fas fa-unlink',\n                        message: 'Page not found (404)',\n                        color: '#e74c3c'\n                    };\n                    break;\n                case 'network_error':\n                    summary = {\n                        className: 'error',\n                        icon: 'fas fa-wifi',\n                        message: 'Network error',\n                        color: '#e74c3c'\n                    };\n                    break;\n                default:\n                    summary = {\n                        className: 'error',\n                        icon: 'fas fa-exclamation-circle',\n                        message: error ? `Error: ${error.substring(0, 50)}...` : 'Connection failed',\n                        color: '#e74c3c'\n                    };\n            }\n        }\n\n        return summary;\n    }\n\n    /**\n     * Generate comprehensive alternative search URLs for dead links\n     * @param {string} areaName - Area name (e.g., \"Mar Vista\")\n     * @param {string} zipCode - Zip code (e.g., \"90066\")\n     * @param {number} price - Price range\n     * @returns {Array<{name: string, url: string, priority: number, type: string}>} Alternative URLs\n     */\n    generateAlternativeUrls(areaName, zipCode, price) {\n        const encodedArea = encodeURIComponent(areaName || '');\n        const encodedQuery = encodeURIComponent(`${areaName} CA ${zipCode} apartments rent 2 bedroom`);\n        const priceQuery = price ? encodeURIComponent(`${areaName} apartments under ${price} rent`) : encodedQuery;\n        \n        return [\n            // High-priority alternatives - General searches that always work\n            {\n                name: 'Google Search',\n                url: `https://www.google.com/search?q=${encodedQuery}&tbm=&tbs=qdr:m`,\n                type: 'search',\n                priority: 1,\n                description: 'Comprehensive search results'\n            },\n            {\n                name: 'Apartments.com',\n                url: `https://www.apartments.com/los-angeles-ca/`,\n                type: 'listings',\n                priority: 1,\n                description: 'Browse LA apartments'\n            },\n            {\n                name: 'Zillow Rentals',\n                url: `https://www.zillow.com/los-angeles-ca/rentals/`,\n                type: 'listings',\n                priority: 1,\n                description: 'Rental listings on Zillow'\n            },\n            \n            // Medium-priority alternatives - More specific searches\n            {\n                name: 'Rent.com Search',\n                url: `https://www.rent.com/california/los-angeles-apartments`,\n                type: 'listings',\n                priority: 2,\n                description: 'Rent.com listings'\n            },\n            {\n                name: 'HotPads',\n                url: `https://hotpads.com/los-angeles-ca/apartments-for-rent`,\n                type: 'listings',\n                priority: 2,\n                description: 'Map-based apartment search'\n            },\n            {\n                name: 'Trulia Rentals',\n                url: `https://www.trulia.com/for_rent/Los_Angeles,CA/`,\n                type: 'listings',\n                priority: 2,\n                description: 'Neighborhood-focused search'\n            },\n            \n            // Specialized alternatives\n            {\n                name: 'Westside Rentals',\n                url: `https://www.westsiderentals.com/`,\n                type: 'listings',\n                priority: 2,\n                description: 'Westside LA specialist'\n            },\n            {\n                name: 'PadMapper',\n                url: `https://www.padmapper.com/apartments/los-angeles-ca`,\n                type: 'listings',\n                priority: 3,\n                description: 'Interactive map search'\n            },\n            \n            // Community-based alternatives\n            {\n                name: 'Craigslist LA',\n                url: `https://losangeles.craigslist.org/search/apa?query=${encodedArea}+${zipCode}`,\n                type: 'community',\n                priority: 3,\n                description: 'Community listings'\n            },\n            {\n                name: 'Facebook Marketplace',\n                url: `https://www.facebook.com/marketplace/los-angeles/propertyrentals`,\n                type: 'community',\n                priority: 3,\n                description: 'Social marketplace'\n            },\n            \n            // Backup generic searches\n            {\n                name: 'Bing Search',\n                url: `https://www.bing.com/search?q=${priceQuery}`,\n                type: 'search',\n                priority: 4,\n                description: 'Alternative search engine'\n            },\n            {\n                name: 'Realtor.com',\n                url: `https://www.realtor.com/apartments-for-rent/Los-Angeles_CA`,\n                type: 'listings',\n                priority: 4,\n                description: 'Realtor apartment listings'\n            }\n        ].sort((a, b) => a.priority - b.priority);\n    }\n\n    /**\n     * Generate smart backup URLs based on primary URL failure type\n     * @param {string} primaryUrl - The failed primary URL\n     * @param {string} areaName - Area name\n     * @param {string} zipCode - Zip code  \n     * @param {number} price - Price range\n     * @param {string} failureType - Type of failure detected\n     * @returns {Array} Tailored backup URLs\n     */\n    generateSmartBackups(primaryUrl, areaName, zipCode, price, failureType) {\n        const allAlternatives = this.generateAlternativeUrls(areaName, zipCode, price);\n        \n        // Filter based on failure type\n        switch (failureType) {\n            case 'cors_blocked':\n            case 'network_cors':\n                // CORS issues - prioritize search engines and known-good domains\n                return allAlternatives.filter(alt => \n                    alt.type === 'search' || alt.priority <= 2\n                ).slice(0, 4);\n                \n            case 'timeout':\n                // Timeout issues - prioritize faster, simpler sites\n                return allAlternatives.filter(alt => \n                    alt.priority <= 2 && alt.type !== 'community'\n                ).slice(0, 3);\n                \n            case '404_not_found':\n            case 'invalid_url':\n                // URL structure issues - provide comprehensive alternatives\n                return allAlternatives.slice(0, 6);\n                \n            default:\n                // Generic failure - provide balanced mix\n                return allAlternatives.slice(0, 5);\n        }\n    }\n\n    /**\n     * Monitor apartment URLs and update health status\n     * @param {Array<Object>} apartments - Array of apartment objects\n     * @returns {Promise<Array<Object>>} Apartments with health status\n     */\n    async monitorApartmentUrls(apartments) {\n        // eslint-disable-next-line no-console\n        console.log(`üîç Monitoring health of ${apartments.length} apartment URLs...`);\n        \n        const monitored = [];\n        \n        for (const apartment of apartments) {\n            try {\n                const health = await this.checkUrlHealth(apartment.url);\n                const healthSummary = this.getHealthSummary(health);\n                \n                monitored.push({\n                    ...apartment,\n                    urlHealth: health,\n                    urlHealthSummary: healthSummary,\n                    // Add alternative URLs if main link is unhealthy\n                    alternativeUrls: !health.healthy ? \n                        this.generateAlternativeUrls(apartment.address?.split(',')[1]?.trim(), apartment.zipCode, apartment.price) : \n                        apartment.backupUrls || []\n                });\n                \n                // Add small delay to avoid overwhelming servers\n                await new Promise(resolve => setTimeout(resolve, 100));\n                \n            } catch (error) {\n                // eslint-disable-next-line no-console\n                console.warn(`Failed to monitor URL for apartment ${apartment.id}:`, error);\n                monitored.push({\n                    ...apartment,\n                    urlHealth: { healthy: false, status: 'monitor_error', error: error.message },\n                    urlHealthSummary: {\n                        className: 'error',\n                        icon: 'fas fa-exclamation-circle',\n                        message: 'Monitoring failed',\n                        color: '#e74c3c'\n                    }\n                });\n            }\n        }\n        \n        // eslint-disable-next-line no-console\n        console.log(`‚úÖ URL monitoring complete. ${monitored.filter(a => a.urlHealth?.healthy).length}/${monitored.length} URLs appear healthy.`);\n        \n        return monitored;\n    }\n\n    /**\n     * Clear all cached health data\n     */\n    clearCache() {\n        this.healthCache.clear();\n    }\n\n    /**\n     * Get cache statistics\n     * @returns {Object} Cache statistics\n     */\n    getCacheStats() {\n        const entries = Array.from(this.healthCache.values());\n        \n        return {\n            totalEntries: this.healthCache.size,\n            healthyUrls: entries.filter(e => e.healthy).length,\n            unhealthyUrls: entries.filter(e => !e.healthy).length,\n            averageResponseTime: entries.length > 0 ? \n                entries.reduce((sum, e) => sum + (e.responseTime || 0), 0) / entries.length : 0,\n            oldestEntry: entries.length > 0 ? \n                Math.min(...entries.map(e => e.lastChecked)) : null,\n            newestEntry: entries.length > 0 ? \n                Math.max(...entries.map(e => e.lastChecked)) : null\n        };\n    }\n}\n\n// Export singleton instance\nexport const linkHealthMonitor = new LinkHealthMonitor();","import { RealApartmentSearchEngine } from './real-search-engine.js';\nimport { ApartmentScoring } from './scoring.js';\nimport { lazyLoader } from './lazy-loading.js';\nimport { linkHealthMonitor } from './link-health-monitor.js';\n\nexport class ApartmentFinderApp {\n    constructor() {\n        this.apartments = [];\n        this.filteredApartments = [];\n        this.bookmarkedApartments = JSON.parse(localStorage.getItem('bookmarkedApartments') || '[]');\n        this.isSearching = false;\n        \n        this.init();\n    }\n\n    init() {\n        this.bindEvents();\n        this.loadBookmarks();\n        // eslint-disable-next-line no-console\n        console.log('Apartment Finder App initialized');\n    }\n\n    bindEvents() {\n        // Search button\n        const searchBtn = document.getElementById('searchBtn');\n        searchBtn.addEventListener('click', () => this.startSearch());\n\n        // Filter controls\n        const sortBy = document.getElementById('sortBy');\n        sortBy.addEventListener('change', () => this.applyFilters());\n\n        const minScore = document.getElementById('minScore');\n        minScore.addEventListener('input', (e) => {\n            document.getElementById('minScoreValue').textContent = e.target.value;\n            this.applyFilters();\n        });\n\n        // Filter checkboxes\n        ['recentOnly', 'renovatedOnly', 'premiumOnly'].forEach(id => {\n            document.getElementById(id).addEventListener('change', () => this.applyFilters());\n        });\n\n        // Filter panel toggle\n        const toggleFilters = document.getElementById('toggleFilters');\n        const filterContent = document.querySelector('.filter-content');\n        toggleFilters.addEventListener('click', () => {\n            const isExpanded = filterContent.style.display !== 'none';\n            filterContent.style.display = isExpanded ? 'none' : 'block';\n            toggleFilters.innerHTML = isExpanded ? \n                '<i class=\"fas fa-chevron-down\"></i>' : \n                '<i class=\"fas fa-chevron-up\"></i>';\n        });\n\n        // Modal controls\n        const modal = document.getElementById('apartmentModal');\n        const closeModal = document.getElementById('closeModal');\n        \n        closeModal.addEventListener('click', () => this.closeModal());\n        modal.addEventListener('click', (e) => {\n            if (e.target === modal) this.closeModal();\n        });\n\n        // Export button\n        const exportBtn = document.getElementById('exportBtn');\n        exportBtn.addEventListener('click', () => this.exportResults());\n\n        // Keyboard shortcuts\n        document.addEventListener('keydown', (e) => {\n            if (e.key === 'Escape' && modal.style.display !== 'none') {\n                this.closeModal();\n            }\n            if (e.key === 'Enter' && e.ctrlKey && !this.isSearching) {\n                this.startSearch();\n            }\n        });\n    }\n\n    async startSearch() {\n        if (this.isSearching) return;\n        \n        this.isSearching = true;\n        this.showLoadingState();\n        \n        try {\n            // Initialize real search engine and scoring\n            const searchEngine = new RealApartmentSearchEngine();\n            const scorer = new ApartmentScoring();\n            \n            // Show search engine status\n            const status = searchEngine.getStatus();\n            console.log('üîß Search Engine Status:', status);\n            \n            // Start search with progress updates\n            const apartments = await searchEngine.searchApartments((progress) => {\n                this.updateProgress(progress);\n            });\n            \n            // Score apartments using the scoring system\n            this.apartments = apartments.map(apt => ({\n                ...apt,\n                score: scorer.calculateScore(apt),\n                scoreBreakdown: scorer.getScoreBreakdown(apt)\n            }));\n            \n            // Monitor URL health for better user experience\n            // eslint-disable-next-line no-console\n            console.log('üîç Checking apartment listing URLs...');\n            this.apartments = await linkHealthMonitor.monitorApartmentUrls(this.apartments);\n            \n            this.applyFilters();\n            this.showResults();\n            \n        } catch (error) {\n            // eslint-disable-next-line no-console\n            console.error('Search failed:', error);\n            this.showToast('Search failed. Please try again.', 'error');\n        } finally {\n            this.isSearching = false;\n            this.hideLoadingState();\n        }\n    }\n\n    showLoadingState() {\n        const searchBtn = document.getElementById('searchBtn');\n        const loadingIndicator = document.getElementById('loadingIndicator');\n        \n        searchBtn.style.display = 'none';\n        loadingIndicator.style.display = 'block';\n        \n        // Hide results section\n        document.getElementById('resultsSection').style.display = 'none';\n        document.getElementById('filterPanel').style.display = 'none';\n    }\n\n    hideLoadingState() {\n        const searchBtn = document.getElementById('searchBtn');\n        const loadingIndicator = document.getElementById('loadingIndicator');\n        \n        searchBtn.style.display = 'inline-block';\n        loadingIndicator.style.display = 'none';\n    }\n\n    updateProgress(progress) {\n        const steps = ['step1', 'step2', 'step3', 'step4'];\n        const currentStep = Math.min(Math.floor(progress / 25), 3);\n        \n        steps.forEach((stepId, index) => {\n            const element = document.getElementById(stepId);\n            if (index < currentStep) {\n                element.className = 'step completed';\n            } else if (index === currentStep) {\n                element.className = 'step active';\n            } else {\n                element.className = 'step';\n            }\n        });\n    }\n\n    applyFilters() {\n        if (!this.apartments.length) return;\n\n        let filtered = [...this.apartments];\n        \n        // Apply score filter\n        const minScore = parseInt(document.getElementById('minScore').value);\n        filtered = filtered.filter(apt => apt.score >= minScore);\n        \n        // Apply checkbox filters\n        if (document.getElementById('recentOnly').checked) {\n            const weekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);\n            filtered = filtered.filter(apt => new Date(apt.datePosted) > weekAgo);\n        }\n        \n        if (document.getElementById('renovatedOnly').checked) {\n            filtered = filtered.filter(apt => apt.recentlyRenovated);\n        }\n        \n        if (document.getElementById('premiumOnly').checked) {\n            filtered = filtered.filter(apt => apt.premiumAmenities);\n        }\n        \n        // Apply sorting\n        const sortBy = document.getElementById('sortBy').value;\n        filtered.sort((a, b) => {\n            switch (sortBy) {\n                case 'score': return b.score - a.score;\n                case 'price-low': return a.price - b.price;\n                case 'price-high': return b.price - a.price;\n                case 'newest': return new Date(b.datePosted) - new Date(a.datePosted);\n                default: return b.score - a.score;\n            }\n        });\n        \n        this.filteredApartments = filtered;\n        this.renderResults();\n    }\n\n    showResults() {\n        document.getElementById('resultsSection').style.display = 'block';\n        document.getElementById('filterPanel').style.display = 'block';\n        \n        // Scroll to results\n        document.getElementById('resultsSection').scrollIntoView({ \n            behavior: 'smooth' \n        });\n    }\n\n    renderResults() {\n        const resultsGrid = document.getElementById('resultsGrid');\n        const recentResults = document.getElementById('recentResults');\n        const recentListings = document.getElementById('recentListings');\n        const noResults = document.getElementById('noResults');\n        const resultsCount = document.getElementById('resultsCount');\n        \n        // Update results count\n        resultsCount.textContent = `${this.filteredApartments.length} apartments found`;\n        \n        if (this.filteredApartments.length === 0) {\n            resultsGrid.innerHTML = '';\n            recentResults.innerHTML = '';\n            recentListings.style.display = 'none';\n            noResults.style.display = 'block';\n            return;\n        }\n        \n        noResults.style.display = 'none';\n        \n        // Separate recent listings (past week)\n        const weekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);\n        const recentApartments = this.filteredApartments.filter(apt => \n            new Date(apt.datePosted) > weekAgo\n        );\n        const allApartments = this.filteredApartments;\n        \n        // Render recent listings\n        if (recentApartments.length > 0) {\n            recentListings.style.display = 'block';\n            recentResults.innerHTML = recentApartments\n                .slice(0, 6)\n                .map(apt => this.createApartmentCard(apt, true))\n                .join('');\n        } else {\n            recentListings.style.display = 'none';\n        }\n        \n        // Render all results\n        resultsGrid.innerHTML = allApartments\n            .map(apt => this.createApartmentCard(apt))\n            .join('');\n        \n        // Add click events to apartment cards\n        document.querySelectorAll('.apartment-card').forEach(card => {\n            card.addEventListener('click', () => {\n                const apartmentId = card.dataset.apartmentId;\n                const apartment = this.apartments.find(apt => apt.id === apartmentId);\n                this.showApartmentDetails(apartment);\n            });\n        });\n\n        // Add backup link toggle functionality\n        document.querySelectorAll('.show-backups-btn').forEach(button => {\n            button.addEventListener('click', (e) => {\n                e.stopPropagation();\n                this.toggleBackupLinks(button);\n            });\n        });\n\n        // Add modal backup toggle functionality\n        document.querySelectorAll('.expand-more-backups').forEach(button => {\n            button.addEventListener('click', (e) => {\n                e.stopPropagation();\n                this.toggleAdditionalBackups(button);\n            });\n        });\n\n        // Initialize lazy loading for new images\n        setTimeout(() => {\n            lazyLoader.refresh();\n        }, 100);\n    }\n\n    createApartmentCard(apartment) {\n        const scoreClass = apartment.score >= 80 ? 'high' : \n                          apartment.score >= 60 ? 'medium' : 'low';\n        \n        const features = apartment.features.slice(0, 3).map(feature => \n            `<span class=\"feature-tag ${apartment.highlightFeatures?.includes(feature) ? 'highlight' : ''}\">${feature}</span>`\n        ).join('');\n        \n        const bookmarked = this.bookmarkedApartments.includes(apartment.id);\n        \n        return `\n            <div class=\"apartment-card fade-in\" data-apartment-id=\"${apartment.id}\">\n                <div class=\"card-image\">\n                    <div class=\"image-container\">\n                        ${apartment.images && apartment.images.length > 0 ? \n                            `<img class=\"property-image\" data-src=\"${apartment.images[0]}\" alt=\"${apartment.title}\" onerror=\"this.classList.add('lazy-error')\">` :\n                            '<div class=\"no-image-placeholder\"><i class=\"fas fa-image\"></i><span>No Image Available</span></div>'\n                        }\n                    </div>\n                    <div class=\"score-badge ${scoreClass}\">${apartment.score}</div>\n                    ${bookmarked ? '<div class=\"bookmark-indicator\"><i class=\"fas fa-bookmark\"></i></div>' : ''}\n                </div>\n                <div class=\"card-content\">\n                    <h3 class=\"card-title\">${apartment.title}</h3>\n                    <p class=\"card-address\">\n                        <i class=\"fas fa-map-marker-alt\"></i>\n                        ${apartment.address}\n                    </p>\n                    \n                    <div class=\"card-details\">\n                        <div class=\"detail-item\">\n                            <i class=\"fas fa-bed\"></i>\n                            ${apartment.bedrooms} bed\n                        </div>\n                        <div class=\"detail-item\">\n                            <i class=\"fas fa-bath\"></i>\n                            ${apartment.bathrooms} bath\n                        </div>\n                        <div class=\"detail-item\">\n                            <i class=\"fas fa-ruler-combined\"></i>\n                            ${apartment.sqft || 'N/A'} sq ft\n                        </div>\n                        <div class=\"detail-item\">\n                            <i class=\"fas fa-building\"></i>\n                            Floor ${apartment.floor || 'N/A'}\n                        </div>\n                    </div>\n                    \n                    <div class=\"card-features\">\n                        ${features}\n                        ${apartment.features.length > 3 ? \n                            `<span class=\"feature-tag\">+${apartment.features.length - 3} more</span>` : \n                            ''\n                        }\n                    </div>\n                    \n                    <div class=\"card-price\">$${apartment.price.toLocaleString()}/month</div>\n                    \n                    <div class=\"card-actions\">\n                        <div class=\"listing-buttons\">\n                            ${this.renderPrimaryListingButton(apartment)}\n                            ${this.renderBackupOptions(apartment)}\n                        </div>\n                        <div class=\"listing-info\">\n                            <span class=\"listing-source\">Primary source: ${apartment.source}</span>\n                            ${apartment.urlHealthSummary ? `\n                                <div class=\"link-health-indicator ${apartment.urlHealthSummary.className}\">\n                                    <i class=\"${apartment.urlHealthSummary.icon}\"></i>\n                                    <span class=\"health-tooltip\">${apartment.urlHealthSummary.message}</span>\n                                </div>\n                            ` : ''}\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `;\n    }\n\n    renderPrimaryListingButton(apartment) {\n        const healthStatus = apartment.urlHealth;\n        \n        let buttonClass = 'view-listing-btn primary';\n        let buttonText = `View on ${apartment.source}`;\n        let icon = 'fas fa-external-link-alt';\n        \n        if (healthStatus && !healthStatus.healthy) {\n            buttonClass += ' warning';\n            buttonText = `Try ${apartment.source}`;\n            icon = 'fas fa-exclamation-triangle';\n        }\n        \n        return `\n            <a href=\"${apartment.url}\" target=\"_blank\" rel=\"noopener noreferrer\" \n               class=\"${buttonClass}\" onclick=\"event.stopPropagation();\"\n               title=\"${healthStatus ? healthStatus.status : 'Link status unknown'}\">\n                <i class=\"${icon}\"></i>\n                ${buttonText}\n            </a>\n        `;\n    }\n\n    renderBackupOptions(apartment) {\n        const backupUrls = apartment.backupUrls || apartment.alternativeUrls || [];\n        \n        if (backupUrls.length === 0) {\n            return '';\n        }\n\n        const priorityBackups = backupUrls.filter(backup => backup.priority <= 2).slice(0, 3);\n        const additionalBackups = backupUrls.filter(backup => backup.priority > 2);\n\n        let backupHtml = '';\n        \n        // Always show top priority backups if primary link is unhealthy\n        const showBackupsByDefault = apartment.urlHealth && !apartment.urlHealth.healthy;\n        \n        if (priorityBackups.length > 0) {\n            backupHtml += `\n                <div class=\"backup-links\" style=\"display: ${showBackupsByDefault ? 'block' : 'none'};\">\n                    ${priorityBackups.map(backup => `\n                        <a href=\"${backup.url}\" target=\"_blank\" rel=\"noopener noreferrer\" \n                           class=\"view-listing-btn backup ${backup.type === 'search' ? 'search' : 'listing'}\" \n                           onclick=\"event.stopPropagation();\"\n                           title=\"${backup.description || backup.name}\">\n                            <i class=\"fas fa-${backup.type === 'search' ? 'search' : 'building'}\"></i>\n                            ${backup.name}\n                        </a>\n                    `).join('')}\n                </div>\n            `;\n        }\n\n        // Show toggle button for additional options\n        if (priorityBackups.length > 0 || additionalBackups.length > 0) {\n            const buttonText = showBackupsByDefault ? 'Hide Alternatives' : 'More Options';\n            const chevronDirection = showBackupsByDefault ? 'up' : 'down';\n            \n            backupHtml += `\n                <button class=\"show-backups-btn ${showBackupsByDefault ? 'expanded' : ''}\" \n                        onclick=\"event.stopPropagation();\">\n                    <i class=\"fas fa-chevron-${chevronDirection}\"></i>\n                    ${buttonText}\n                </button>\n            `;\n        }\n\n        return backupHtml;\n    }\n\n    showApartmentDetails(apartment) {\n        const modal = document.getElementById('apartmentModal');\n        const modalTitle = document.getElementById('modalTitle');\n        const modalBody = document.getElementById('modalBody');\n        const bookmarkBtn = document.getElementById('bookmarkBtn');\n        \n        modalTitle.textContent = apartment.title;\n        \n        const scoreClass = apartment.score >= 80 ? 'high' : \n                          apartment.score >= 60 ? 'medium' : 'low';\n        \n        const imageGallery = apartment.images && apartment.images.length > 0 ? \n            `<div class=\"image-gallery\">\n                ${apartment.images.map((img, index) => \n                    `<div class=\"image-container\" style=\"margin-bottom: 1rem;\">\n                        <img class=\"property-image\" \n                             ${index === 0 ? `src=\"${img}\"` : `data-src=\"${img}\"`} \n                             alt=\"Apartment image\" \n                             style=\"width: 100%; border-radius: 8px;\"\n                             onerror=\"this.classList.add('lazy-error')\">\n                    </div>`\n                ).join('')}\n            </div>` : \n            '<div class=\"no-image\">No images available</div>';\n        \n        modalBody.innerHTML = `\n            ${imageGallery}\n            \n            <div class=\"apartment-details\">\n                <div class=\"detail-header\">\n                    <div class=\"score-display\">\n                        <span class=\"score-badge ${scoreClass}\">${apartment.score}</span>\n                        <span class=\"score-label\">Match Score</span>\n                    </div>\n                    <div class=\"price-display\">\n                        <span class=\"price\">$${apartment.price.toLocaleString()}</span>\n                        <span class=\"price-label\">per month</span>\n                    </div>\n                </div>\n                \n                <div class=\"address-section\">\n                    <h4><i class=\"fas fa-map-marker-alt\"></i> Address</h4>\n                    <p>${apartment.address}</p>\n                    <p><strong>Zip Code:</strong> ${apartment.zipCode}</p>\n                </div>\n                \n                <div class=\"specs-section\">\n                    <h4><i class=\"fas fa-info-circle\"></i> Specifications</h4>\n                    <div class=\"specs-grid\">\n                        <div class=\"spec-item\">\n                            <i class=\"fas fa-bed\"></i>\n                            <span>${apartment.bedrooms} Bedrooms</span>\n                        </div>\n                        <div class=\"spec-item\">\n                            <i class=\"fas fa-bath\"></i>\n                            <span>${apartment.bathrooms} Bathrooms</span>\n                        </div>\n                        <div class=\"spec-item\">\n                            <i class=\"fas fa-ruler-combined\"></i>\n                            <span>${apartment.sqft || 'N/A'} sq ft</span>\n                        </div>\n                        <div class=\"spec-item\">\n                            <i class=\"fas fa-building\"></i>\n                            <span>Floor ${apartment.floor || 'N/A'}</span>\n                        </div>\n                    </div>\n                </div>\n                \n                <div class=\"amenities-section\">\n                    <h4><i class=\"fas fa-star\"></i> Amenities & Features</h4>\n                    <div class=\"amenities-grid\">\n                        ${apartment.features.map(feature => \n                            `<div class=\"amenity-item ${apartment.highlightFeatures?.includes(feature) ? 'highlight' : ''}\">\n                                <i class=\"fas fa-check\"></i>\n                                ${feature}\n                            </div>`\n                        ).join('')}\n                    </div>\n                </div>\n                \n                ${apartment.description ? `\n                    <div class=\"description-section\">\n                        <h4><i class=\"fas fa-file-text\"></i> Description</h4>\n                        <p>${apartment.description}</p>\n                    </div>\n                ` : ''}\n                \n                <div class=\"listing-url-section\">\n                    <h4><i class=\"fas fa-external-link-alt\"></i> View Full Listing</h4>\n                    <div class=\"url-container\">\n                        ${this.renderModalPrimaryButton(apartment)}\n                        ${this.renderModalHealthStatus(apartment)}\n                        ${this.renderModalBackupOptions(apartment)}\n                    </div>\n                </div>\n                \n                <div class=\"contact-section\">\n                    <h4><i class=\"fas fa-phone\"></i> Contact Information</h4>\n                    <p><strong>Phone:</strong> ${apartment.contact?.phone || 'Not available'}</p>\n                    <p><strong>Email:</strong> ${apartment.contact?.email || 'Not available'}</p>\n                    <p><strong>Source:</strong> ${apartment.source}</p>\n                    <p><strong>Posted:</strong> ${new Date(apartment.datePosted).toLocaleDateString()}</p>\n                </div>\n            </div>\n        `;\n        \n        // Update bookmark button\n        const isBookmarked = this.bookmarkedApartments.includes(apartment.id);\n        bookmarkBtn.innerHTML = isBookmarked ? \n            '<i class=\"fas fa-bookmark\"></i> Bookmarked' : \n            '<i class=\"far fa-bookmark\"></i> Bookmark';\n        \n        bookmarkBtn.onclick = () => this.toggleBookmark(apartment.id);\n        \n        // Show modal\n        modal.style.display = 'flex';\n        setTimeout(() => {\n            modal.classList.add('show');\n            // Initialize lazy loading for modal images\n            lazyLoader.refresh();\n        }, 10);\n    }\n\n    closeModal() {\n        const modal = document.getElementById('apartmentModal');\n        modal.classList.remove('show');\n        setTimeout(() => modal.style.display = 'none', 300);\n    }\n\n    toggleBookmark(apartmentId) {\n        const index = this.bookmarkedApartments.indexOf(apartmentId);\n        if (index > -1) {\n            this.bookmarkedApartments.splice(index, 1);\n            this.showToast('Bookmark removed', 'warning');\n        } else {\n            this.bookmarkedApartments.push(apartmentId);\n            this.showToast('Apartment bookmarked!', 'success');\n        }\n        \n        localStorage.setItem('bookmarkedApartments', JSON.stringify(this.bookmarkedApartments));\n        this.renderResults(); // Re-render to update bookmark indicators\n        \n        // Update bookmark button in modal\n        const bookmarkBtn = document.getElementById('bookmarkBtn');\n        const isBookmarked = this.bookmarkedApartments.includes(apartmentId);\n        bookmarkBtn.innerHTML = isBookmarked ? \n            '<i class=\"fas fa-bookmark\"></i> Bookmarked' : \n            '<i class=\"far fa-bookmark\"></i> Bookmark';\n    }\n\n    loadBookmarks() {\n        // eslint-disable-next-line no-console\n        console.log(`Loaded ${this.bookmarkedApartments.length} bookmarked apartments`);\n    }\n\n    exportResults() {\n        if (this.filteredApartments.length === 0) {\n            this.showToast('No results to export', 'warning');\n            return;\n        }\n        \n        const exportData = this.filteredApartments.map(apt => ({\n            title: apt.title,\n            address: apt.address,\n            price: apt.price,\n            bedrooms: apt.bedrooms,\n            bathrooms: apt.bathrooms,\n            sqft: apt.sqft,\n            score: apt.score,\n            features: apt.features.join(', '),\n            contact: apt.contact?.phone || '',\n            source: apt.source,\n            datePosted: apt.datePosted\n        }));\n        \n        const csv = this.convertToCSV(exportData);\n        this.downloadCSV(csv, 'apartment-search-results.csv');\n        this.showToast('Results exported successfully!', 'success');\n    }\n\n    convertToCSV(data) {\n        const headers = Object.keys(data[0]).join(',');\n        const rows = data.map(row => \n            Object.values(row).map(value => \n                typeof value === 'string' && value.includes(',') ? \n                    `\"${value}\"` : value\n            ).join(',')\n        );\n        return [headers, ...rows].join('\\n');\n    }\n\n    downloadCSV(csv, filename) {\n        const blob = new Blob([csv], { type: 'text/csv' });\n        const url = window.URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.setAttribute('hidden', '');\n        a.setAttribute('href', url);\n        a.setAttribute('download', filename);\n        document.body.appendChild(a);\n        a.click();\n        document.body.removeChild(a);\n        window.URL.revokeObjectURL(url);\n    }\n\n    showToast(message, type = 'success') {\n        const container = document.getElementById('toastContainer');\n        const toast = document.createElement('div');\n        toast.className = `toast ${type}`;\n        toast.innerHTML = `\n            <div class=\"toast-content\">\n                <i class=\"fas fa-${type === 'success' ? 'check-circle' : \n                                 type === 'error' ? 'exclamation-circle' : \n                                 'exclamation-triangle'}\"></i>\n                <span>${message}</span>\n            </div>\n        `;\n        \n        container.appendChild(toast);\n        setTimeout(() => toast.classList.add('show'), 100);\n        \n        setTimeout(() => {\n            toast.classList.remove('show');\n            setTimeout(() => container.removeChild(toast), 300);\n        }, 4000);\n    }\n\n    renderModalPrimaryButton(apartment) {\n        const healthStatus = apartment.urlHealth;\n        \n        let buttonClass = 'modal-view-listing-btn primary';\n        let buttonText = `View on ${apartment.source}`;\n        let icon = 'fas fa-external-link-alt';\n        \n        if (healthStatus && !healthStatus.healthy) {\n            buttonClass += ' warning';\n            buttonText = `Try ${apartment.source} (may not work)`;\n            icon = 'fas fa-exclamation-triangle';\n        }\n        \n        return `\n            <a href=\"${apartment.url}\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"${buttonClass}\">\n                <i class=\"${icon}\"></i>\n                ${buttonText}\n            </a>\n        `;\n    }\n\n    renderModalHealthStatus(apartment) {\n        const healthStatus = apartment.urlHealth;\n        const healthSummary = apartment.urlHealthSummary;\n        \n        if (!healthStatus || !healthSummary) {\n            return `<p class=\"url-disclaimer\">Primary listing from ${  apartment.source  }. Link status unknown.</p>`;\n        }\n\n        let statusHtml = '';\n        \n        if (healthStatus.healthy) {\n            if (healthStatus.status === 'cors_accessible' || healthStatus.status === 'cors_blocked') {\n                statusHtml = `\n                    <div class=\"health-status warning\">\n                        <i class=\"fas fa-info-circle\"></i>\n                        <span>Link appears to work but cannot be fully verified due to browser security restrictions.</span>\n                    </div>\n                `;\n            } else {\n                statusHtml = `\n                    <div class=\"health-status healthy\">\n                        <i class=\"fas fa-check-circle\"></i>\n                        <span>Link verified and accessible (response: ${healthStatus.responseTime}ms)</span>\n                    </div>\n                `;\n            }\n        } else {\n            statusHtml = `\n                <div class=\"health-status error\">\n                    <i class=\"fas fa-exclamation-triangle\"></i>\n                    <span>Primary link may not work: ${healthSummary.message}. Try alternatives below.</span>\n                </div>\n            `;\n        }\n\n        return `${statusHtml  }<p class=\"url-disclaimer\">Primary listing from ${apartment.source}.</p>`;\n    }\n\n    renderModalBackupOptions(apartment) {\n        const backupUrls = apartment.backupUrls || apartment.alternativeUrls || [];\n        \n        if (backupUrls.length === 0) {\n            return '';\n        }\n\n        const priorityBackups = backupUrls.filter(backup => backup.priority <= 2);\n        const additionalBackups = backupUrls.filter(backup => backup.priority > 2);\n\n        let backupHtml = `\n            <div class=\"backup-options\">\n                <h5><i class=\"fas fa-life-ring\"></i> Alternative Search Options</h5>\n        `;\n\n        if (apartment.urlHealth && !apartment.urlHealth.healthy) {\n            backupHtml += '<p class=\"backup-info urgent\">‚ö†Ô∏è Primary link issue detected. These alternatives are recommended:</p>';\n        } else {\n            backupHtml += '<p class=\"backup-info\">If the primary link doesn\\'t work, try these alternatives:</p>';\n        }\n\n        // Priority backups (always show if primary is unhealthy)\n        if (priorityBackups.length > 0) {\n            backupHtml += `\n                <div class=\"backup-buttons priority\">\n                    <h6>Recommended Alternatives:</h6>\n                    ${priorityBackups.map(backup => `\n                        <a href=\"${backup.url}\" target=\"_blank\" rel=\"noopener noreferrer\" \n                           class=\"modal-view-listing-btn backup ${backup.type === 'search' ? 'search' : 'listing'}\"\n                           title=\"${backup.description || backup.name}\">\n                            <i class=\"fas fa-${backup.type === 'search' ? 'search' : 'building'}\"></i>\n                            ${backup.name}\n                            ${backup.description ? `<small>${backup.description}</small>` : ''}\n                        </a>\n                    `).join('')}\n                </div>\n            `;\n        }\n\n        // Additional backups (collapsible)\n        if (additionalBackups.length > 0) {\n            backupHtml += `\n                <div class=\"additional-backups\">\n                    <button class=\"expand-more-backups\" onclick=\"event.stopPropagation();\">\n                        <i class=\"fas fa-chevron-down\"></i>\n                        Show More Options (${additionalBackups.length})\n                    </button>\n                    <div class=\"backup-buttons additional\" style=\"display: none;\">\n                        ${additionalBackups.map(backup => `\n                            <a href=\"${backup.url}\" target=\"_blank\" rel=\"noopener noreferrer\" \n                               class=\"modal-view-listing-btn backup ${backup.type}\"\n                               title=\"${backup.description || backup.name}\">\n                                <i class=\"fas fa-${backup.type === 'search' ? 'search' : 'building'}\"></i>\n                                ${backup.name}\n                            </a>\n                        `).join('')}\n                    </div>\n                </div>\n            `;\n        }\n\n        backupHtml += '</div>';\n        return backupHtml;\n    }\n\n    toggleBackupLinks(button) {\n        const backupLinks = button.parentElement.querySelector('.backup-links');\n        const chevron = button.querySelector('i');\n        \n        if (backupLinks) {\n            const isVisible = backupLinks.style.display !== 'none';\n            backupLinks.style.display = isVisible ? 'none' : 'block';\n            \n            // Update button text and icon\n            const buttonText = button.childNodes[1]; // Text node after icon\n            if (isVisible) {\n                buttonText.textContent = ' More Options';\n                chevron.className = 'fas fa-chevron-down';\n                button.classList.remove('expanded');\n            } else {\n                buttonText.textContent = ' Hide Alternatives';\n                chevron.className = 'fas fa-chevron-up';\n                button.classList.add('expanded');\n            }\n        }\n    }\n\n    toggleAdditionalBackups(button) {\n        const additionalBackups = button.parentElement.querySelector('.backup-buttons.additional');\n        const chevron = button.querySelector('i');\n        \n        if (additionalBackups) {\n            const isVisible = additionalBackups.style.display !== 'none';\n            additionalBackups.style.display = isVisible ? 'none' : 'block';\n            \n            // Update button icon and text\n            if (isVisible) {\n                button.innerHTML = `<i class=\"fas fa-chevron-down\"></i> Show More Options (${additionalBackups.children.length})`;\n            } else {\n                button.innerHTML = `<i class=\"fas fa-chevron-up\"></i> Hide Additional Options`;\n            }\n        }\n    }\n}\n\n// Initialize app when DOM is loaded\nif (typeof window !== 'undefined') {\n    document.addEventListener('DOMContentLoaded', () => {\n        new ApartmentFinderApp();\n    });\n}"],"names":["DeepSearchClient","constructor","this","baseUrl","detectBackendUrl","isBackendAvailable","lastHealthCheck","window","location","hostname","checkHealth","available","reason","controller","AbortController","timeoutId","setTimeout","abort","response","fetch","concat","method","headers","signal","clearTimeout","ok","health","json","agent_ready","Date","status","error","name","message","searchApartments","zipCodes","filters","healthCheck","Error","requestBody","zip_codes","max_results","maxResults","min_price","minPrice","max_price","maxPrice","min_score","minScore","required_amenities","requiredAmenities","console","log","body","JSON","stringify","errorData","catch","detail","searchResults","transformSearchResults","verifyListing","listingUrl","listing_url","getSearchConfig","warn","success","apartments","map","transformApartment","apartment","id","generateId","title","generateTitle","address","zipCode","zip_code","price","bedrooms","bathrooms","sqft","floor","features","transformAmenities","amenities","highlightFeatures","getHighlightFeatures","recentlyRenovated","hasAmenity","premiumAmenities","hasPremiumAmenities","datePosted","found_at","toISOString","source","platform","url","source_url","contact","images","description","generateDescription","score","calculateDisplayScore","scoreBreakdown","validation","urlHealth","transformUrlHealth","urlHealthSummary","generateUrlHealthSummary","backupUrls","backup_urls","searchMetadata","search_metadata","extractedAt","extracted_at","components","now","join","replace","area","extractAreaFromAddress","areas","toLowerCase","includes","amenityMap","washer_dryer","air_conditioning","outdoor_space","parking","pool","gym","dishwasher","hardwood","granite","stainless","amenity","capitalizeAmenity","split","word","charAt","toUpperCase","slice","highlights","filter","targetAmenity","some","feature","toLocaleString","percentage","Math","round","min","max","verification","healthy","verified","responseTime","response_time","verifiedAt","verified_at","className","icon","isAvailable","client","getBackendStatus","RealApartmentSearchEngine","searchCriteria","minRent","maxRent","minBathrooms","maxBathrooms","zipCodePriority","preferredFeatures","deepSearchClient","isDeepSearchAvailable","fallbackEnabled","progressCallback","generateDemoData","searchFilters","length","validApartments","validateApartment","apt","sortedApartments","sortApartmentsByPriority","logSearchSummary","criteria","trim","sort","a","b","priorityA","priorityB","byZipCode","reduce","acc","Object","entries","forEach","zip","count","getAreaName","prices","p","avgPrice","sum","scores","s","avgScore","highScore","index","demoApartments","totalSteps","i","zipApartments","generateZipCodeDemoData","push","delay","validDemoApartments","enhanceDemoApartment","apartmentCount","random","areaData","areaName","basePrice","priceVariance","neighborhoods","generateSingleDemoApartment","buildingNumber","streetNames","streetName","priceOffset","generateRealisticFeatures","daysAgo","generateDemoUrl","generateDemoBackupUrls","phone","generatePhoneNumber","email","generateDemoImages","generateDemoDescription","selectedFeatures","probability","sources","cleanArea","query","encodeURIComponent","type","priority","areaCodes","areaCode","exchange","number","imageCount","descriptions","baseDescription","keyFeatures","ms","Promise","resolve","setFallbackEnabled","enabled","getStatus","deepSearchAvailable","backendStatus","ApartmentScoring","weights","rentInRange","mandatoryAmenities","renovationRecency","naturalLight","outdoorSpaceQuality","locationRating","professionalPhotos","floorLevel","maxScore","calculateScore","totalScore","calculateRentScore","calculateMandatoryAmenityScore","calculateRenovationScore","calculateNaturalLightScore","calculateOutdoorSpaceScore","calculateZipCodeScore","calculatePremiumAmenitiesScore","calculateLocationRatingScore","calculatePhotoScore","calculateFloorScore","getScoreBreakdown","breakdown","specs","renovation","total","optimalRent","maxDeviation","deviation","abs","washerDryer","airConditioning","outdoorSpace","aboveGroundFloor","f","completionRate","values","Boolean","keys","renovationKeywords","hasRenovationKeywords","keyword","explicitlyRenovated","modernAmenities","hasModernAmenities","_a","lightKeywords","lightIndicators","text","floorBonus","outdoorSpaceTypes","terrace","deck","balcony","patio","outdoor","spaceType","multiplier","scoreMultiplier","premiumCount","baseRating","priceBonus","finalRating","lazyLoader","options","rootMargin","threshold","placeholderSrc","errorSrc","fadeInDuration","retryAttempts","retryDelay","observer","loadedImages","Set","failedImages","retryCount","Map","init","IntersectionObserver","entry","isIntersecting","loadImage","target","observeImages","loadAllImages","document","querySelectorAll","img","has","setupImageForLazyLoading","observe","src","classList","add","addLoadingIndicator","style","opacity","transition","container","parentElement","contains","wrapper","createElement","parentNode","insertBefore","appendChild","querySelector","indicator","innerHTML","getAttribute","unobserve","preloadImage","removeAttribute","remove","removeLoadingIndicator","dispatchEvent","CustomEvent","handleImageError","reject","Image","onload","onerror","originalSrc","retryKey","currentRetries","get","set","e","removeChild","refresh","Array","isArray","tagName","hasAttribute","loadImagesInContainer","getStats","loaded","size","failed","pending","destroy","disconnect","clear","readyState","addEventListener","linkHealthMonitor","healthCache","maxCacheAge","timeoutDuration","checkUrlHealth","cached","getFromCache","startTime","isValidUrl","mode","cache","redirect","actualStatus","result","lastChecked","setCache","isKnownGoodDomain","urlObj","URL","protocol","knownGoodDomains","domain","checkMultipleUrls","urls","checks","async","all","cleanupCache","delete","getHealthSummary","healthResult","summary","color","substring","generateAlternativeUrls","encodedArea","encodedQuery","priceQuery","generateSmartBackups","primaryUrl","failureType","allAlternatives","alt","monitorApartmentUrls","monitored","healthSummary","alternativeUrls","_b","clearCache","getCacheStats","from","totalEntries","healthyUrls","unhealthyUrls","averageResponseTime","oldestEntry","newestEntry","ApartmentFinderApp","filteredApartments","bookmarkedApartments","parse","localStorage","getItem","isSearching","bindEvents","loadBookmarks","getElementById","startSearch","applyFilters","textContent","value","toggleFilters","filterContent","isExpanded","display","modal","closeModal","exportResults","key","ctrlKey","showLoadingState","searchEngine","scorer","progress","updateProgress","showResults","showToast","hideLoadingState","searchBtn","loadingIndicator","currentStep","stepId","element","filtered","parseInt","checked","weekAgo","sortBy","renderResults","scrollIntoView","behavior","resultsGrid","recentResults","recentListings","noResults","recentApartments","allApartments","createApartmentCard","card","apartmentId","dataset","find","showApartmentDetails","button","stopPropagation","toggleBackupLinks","toggleAdditionalBackups","scoreClass","bookmarked","renderPrimaryListingButton","renderBackupOptions","healthStatus","buttonClass","buttonText","priorityBackups","backup","additionalBackups","backupHtml","showBackupsByDefault","chevronDirection","modalTitle","modalBody","bookmarkBtn","imageGallery","renderModalPrimaryButton","renderModalHealthStatus","renderModalBackupOptions","toLocaleDateString","isBookmarked","onclick","toggleBookmark","indexOf","splice","setItem","exportData","csv","convertToCSV","downloadCSV","data","row","filename","blob","Blob","createObjectURL","setAttribute","click","revokeObjectURL","toast","statusHtml","backupLinks","chevron","isVisible","childNodes","children"],"mappings":"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"}