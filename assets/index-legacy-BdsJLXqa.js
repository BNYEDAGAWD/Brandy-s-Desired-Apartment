System.register([],function(e,a){"use strict";return{execute:function(){var e=document.createElement("style");e.textContent="*{margin:0;padding:0;box-sizing:border-box}:root{--emerald-green: #10b981;--sapphire-blue: #0ea5e9;--pure-white: #ffffff;--gray-50: #f9fafb;--gray-200: #e5e7eb;--gray-300: #d1d5db;--gray-400: #9ca3af;--gray-500: #6b7280;--gray-900: #111827;--primary-color: var(--emerald-green);--secondary-color: var(--sapphire-blue);--success-color: var(--emerald-green);--warning-color: #f59e0b;--error-color: #ef4444;--bg-primary: var(--pure-white);--bg-secondary: var(--gray-50);--text-primary: var(--gray-900);--text-secondary: var(--gray-500);--text-light: var(--gray-400);--border-color: var(--gray-200);--shadow-subtle: 0 1px 3px rgba(0, 0, 0, .1);--shadow-card: 0 1px 3px rgba(0, 0, 0, .1);--spacing-xs: .5rem;--spacing-sm: .75rem;--spacing-md: 1rem;--spacing-lg: 1.5rem;--spacing-xl: 2rem;--spacing-2xl: 2.5rem;--border-radius: .5rem;--border-radius-sm: .25rem;--border-radius-lg: .75rem;--font-weight-normal: 400;--font-weight-semibold: 600;--transition-fast: .15s ease;--transition-base: .2s ease}html{font-size:16px;line-height:1.6}body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif;background-color:var(--bg-secondary);color:var(--text-primary);font-weight:var(--font-weight-normal)}h1,h2,h3,h4,h5,h6{font-weight:var(--font-weight-semibold);color:var(--text-primary);line-height:1.3}h1{font-size:2rem}h2{font-size:1.5rem}h3{font-size:1.25rem}h4{font-size:1.125rem}a{color:var(--secondary-color);text-decoration:none;transition:color var(--transition-base)}a:hover{color:var(--primary-color)}.container{max-width:1200px;margin:0 auto;padding:0 var(--spacing-lg)}.header{background-color:var(--primary-color);color:var(--pure-white);height:80px;display:flex;align-items:center}.header-title{font-size:1.5rem;font-weight:var(--font-weight-semibold);margin:0}.header-subtitle{font-size:.875rem;opacity:.9;margin-top:var(--spacing-xs);font-weight:var(--font-weight-normal)}.main{padding:var(--spacing-2xl) 0}.search-section{margin-bottom:var(--spacing-2xl)}.search-card{background:var(--bg-primary);border-radius:var(--border-radius-lg);padding:var(--spacing-2xl);box-shadow:var(--shadow-card);border:1px solid var(--border-color)}.search-card h2{margin-bottom:var(--spacing-md);color:var(--text-primary)}.search-description{color:var(--text-secondary);margin-bottom:var(--spacing-xl);line-height:1.6}.search-criteria{margin-bottom:var(--spacing-xl)}.criteria-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:var(--spacing-lg)}.criteria-item{display:flex;align-items:center;gap:var(--spacing-sm);color:var(--text-secondary)}.criteria-item i{color:var(--primary-color);width:20px;text-align:center}.btn,.search-btn,.view-listing-btn,.modal-view-listing-btn{display:inline-flex;align-items:center;justify-content:center;gap:var(--spacing-sm);padding:var(--spacing-sm) var(--spacing-lg);border-radius:var(--border-radius);font-weight:var(--font-weight-semibold);text-decoration:none;border:none;cursor:pointer;transition:all var(--transition-base);min-height:44px;font-size:.875rem}.btn-primary,.search-btn{background-color:var(--primary-color);color:var(--pure-white);border:2px solid var(--primary-color)}.btn-primary:hover,.search-btn:hover{background-color:#059669;border-color:#059669;color:var(--pure-white)}.btn-secondary,.view-listing-btn{background-color:transparent;color:var(--secondary-color);border:2px solid var(--secondary-color)}.btn-secondary:hover,.view-listing-btn:hover{background-color:var(--secondary-color);color:var(--pure-white)}.btn-warning,.view-listing-btn.warning{background-color:transparent;color:var(--warning-color);border:2px solid var(--warning-color)}.btn-warning:hover,.view-listing-btn.warning:hover{background-color:var(--warning-color);color:var(--pure-white)}.loading-indicator{text-align:center;padding:var(--spacing-2xl);background:var(--bg-primary);border-radius:var(--border-radius-lg);box-shadow:var(--shadow-card);margin-bottom:var(--spacing-xl)}.spinner{width:24px;height:24px;border:2px solid var(--border-color);border-top:2px solid var(--secondary-color);border-radius:50%;animation:spin 1s linear infinite;margin:0 auto var(--spacing-md)}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.progress-steps{margin-top:var(--spacing-lg)}.step{padding:var(--spacing-sm) 0;color:var(--text-secondary);font-size:.875rem}.step.active{color:var(--secondary-color);font-weight:var(--font-weight-semibold)}.step.completed{color:var(--primary-color);font-weight:var(--font-weight-semibold)}.filter-panel{background:var(--bg-primary);border-radius:var(--border-radius-lg);border:1px solid var(--border-color);margin-bottom:var(--spacing-xl);overflow:hidden}.filter-header{display:flex;justify-content:space-between;align-items:center;padding:var(--spacing-lg);border-bottom:1px solid var(--border-color)}.filter-header h3{color:var(--text-primary);font-size:1rem;display:flex;align-items:center;gap:var(--spacing-sm)}.toggle-btn{background:var(--secondary-color);color:var(--pure-white);border:none;border-radius:var(--border-radius);padding:var(--spacing-sm);cursor:pointer;transition:background-color var(--transition-base);min-height:44px;min-width:44px}.toggle-btn:hover{background-color:#0284c7}.filter-content{padding:var(--spacing-lg);display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:var(--spacing-lg)}.filter-group{display:flex;flex-direction:column;gap:var(--spacing-sm)}.filter-group label{font-weight:var(--font-weight-semibold);color:var(--text-primary);font-size:.875rem}.filter-group select,.filter-group input[type=range]{padding:var(--spacing-sm);border:1px solid var(--border-color);border-radius:var(--border-radius);background:var(--bg-primary);color:var(--text-primary);font-size:.875rem}.filter-group select:focus,.filter-group input:focus{outline:none;border-color:var(--secondary-color);box-shadow:0 0 0 2px rgba(14,165,233,.1)}.checkbox-group{display:flex;flex-direction:column;gap:var(--spacing-sm)}.checkbox-group label{display:flex;align-items:center;gap:var(--spacing-sm);font-weight:var(--font-weight-normal);cursor:pointer}.checkbox-group input[type=checkbox]{accent-color:var(--primary-color)}.results-section{margin-top:var(--spacing-2xl)}.results-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--spacing-xl);flex-wrap:wrap;gap:var(--spacing-md)}.results-stats{display:flex;align-items:center;gap:var(--spacing-lg)}.results-count{color:var(--text-secondary);font-size:.875rem}.export-btn{background:transparent;color:var(--text-secondary);border:1px solid var(--border-color);padding:var(--spacing-sm) var(--spacing-md);border-radius:var(--border-radius);font-size:.875rem;cursor:pointer;transition:all var(--transition-base);min-height:44px}.export-btn:hover{border-color:var(--secondary-color);color:var(--secondary-color)}.results-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:var(--spacing-xl)}.recent-listings{margin-bottom:var(--spacing-2xl)}.recent-listings h3{color:var(--text-primary);margin-bottom:var(--spacing-lg);display:flex;align-items:center;gap:var(--spacing-sm)}.recent-listings h3 i{color:var(--warning-color)}.recent-grid{grid-template-columns:repeat(auto-fill,minmax(320px,1fr))}.apartment-card{background:var(--bg-primary);border-radius:var(--border-radius-lg);overflow:hidden;cursor:pointer;transition:all var(--transition-base);border:2px solid transparent;box-shadow:var(--shadow-card)}.apartment-card:hover{border-color:var(--secondary-color)}.card-image{position:relative;height:200px;overflow:hidden}.image-container{position:relative;width:100%;height:100%;background-color:var(--gray-50);display:flex;align-items:center;justify-content:center}.property-image{width:100%;height:100%;object-fit:cover;transition:opacity var(--transition-base)}.property-image.lazy-loading{opacity:0}.property-image.lazy-loaded{opacity:1}.property-image.lazy-error{opacity:1;filter:grayscale(100%)}.no-image-placeholder{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;color:var(--text-light);font-size:.875rem;gap:var(--spacing-sm)}.no-image-placeholder i{font-size:2rem;opacity:.5}.score-badge{position:absolute;top:var(--spacing-sm);right:var(--spacing-sm);width:8px;height:8px;border-radius:50%}.score-badge.high{background-color:var(--success-color)}.score-badge.medium{background-color:var(--warning-color)}.score-badge.low{background-color:var(--error-color)}.bookmark-indicator{position:absolute;top:var(--spacing-sm);left:var(--spacing-sm);color:var(--primary-color);font-size:1.25rem}.card-content{padding:var(--spacing-lg)}.card-title{font-size:1.125rem;margin-bottom:var(--spacing-sm);color:var(--text-primary);font-weight:var(--font-weight-semibold)}.card-address{color:var(--text-secondary);font-size:.875rem;margin-bottom:var(--spacing-md);display:flex;align-items:center;gap:var(--spacing-sm)}.card-address i{color:var(--text-light)}.card-details{display:grid;grid-template-columns:repeat(2,1fr);gap:var(--spacing-sm);margin-bottom:var(--spacing-md)}.detail-item{display:flex;align-items:center;gap:var(--spacing-sm);color:var(--text-secondary);font-size:.875rem}.detail-item i{color:var(--text-light);width:16px;text-align:center}.card-features{display:flex;flex-wrap:wrap;gap:var(--spacing-sm);margin-bottom:var(--spacing-md)}.feature-tag{background:var(--gray-50);color:var(--text-secondary);padding:var(--spacing-xs) var(--spacing-sm);border-radius:var(--border-radius-sm);font-size:.75rem;border:1px solid var(--border-color)}.feature-tag.highlight{background:rgba(16,185,129,.1);color:var(--primary-color);border-color:rgba(16,185,129,.2)}.card-price{font-size:1.25rem;font-weight:var(--font-weight-semibold);color:var(--primary-color);margin-bottom:var(--spacing-md)}.card-actions{border-top:1px solid var(--border-color);padding-top:var(--spacing-md)}.listing-buttons{display:flex;flex-direction:column;gap:var(--spacing-sm)}.listing-info{display:flex;justify-content:space-between;align-items:center;margin-top:var(--spacing-sm);padding-top:var(--spacing-sm)}.listing-source{font-size:.75rem;color:var(--text-light)}.listing-source strong{color:var(--primary-color);text-transform:none}.data-freshness{display:block;font-size:.7rem;color:var(--text-light);margin-top:2px;opacity:.8}.link-health-indicator{position:relative;display:inline-flex;align-items:center;gap:var(--spacing-xs);font-size:.75rem;padding:2px var(--spacing-sm);border-radius:12px;cursor:help}.link-health-indicator.healthy{color:var(--success-color);background-color:rgba(16,185,129,.1)}.link-health-indicator.warning{color:var(--warning-color);background-color:rgba(245,158,11,.1)}.link-health-indicator.error{color:var(--error-color);background-color:rgba(239,68,68,.1)}.health-tooltip{position:absolute;bottom:100%;left:50%;transform:translate(-50%);background-color:var(--text-primary);color:var(--pure-white);padding:var(--spacing-sm);border-radius:var(--border-radius);font-size:.75rem;white-space:nowrap;opacity:0;pointer-events:none;transition:opacity var(--transition-base);z-index:1000}.link-health-indicator:hover .health-tooltip{opacity:1}.backup-links{display:flex;flex-direction:column;gap:var(--spacing-sm);margin-top:var(--spacing-sm);padding:var(--spacing-md);background-color:rgba(14,165,233,.05);border-radius:var(--border-radius);border-left:3px solid var(--secondary-color)}.show-backups-btn{background:transparent;border:1px solid var(--border-color);color:var(--text-secondary);padding:var(--spacing-sm) var(--spacing-md);border-radius:var(--border-radius);cursor:pointer;transition:all var(--transition-base);margin-top:var(--spacing-sm);font-size:.75rem;min-height:36px}.show-backups-btn:hover{border-color:var(--secondary-color);color:var(--secondary-color)}.show-backups-btn.expanded{background-color:var(--gray-50);border-color:var(--secondary-color)}.no-results{text-align:center;padding:var(--spacing-2xl);background:var(--bg-primary);border-radius:var(--border-radius-lg);box-shadow:var(--shadow-card)}.no-results i{font-size:3rem;color:var(--text-light);margin-bottom:var(--spacing-lg)}.no-results h3{margin-bottom:var(--spacing-md);color:var(--text-primary)}.no-results p{color:var(--text-secondary)}.modal{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:1000;opacity:0;transition:opacity var(--transition-base)}.modal.show{opacity:1}.modal-content{background:var(--bg-primary);border-radius:var(--border-radius-lg);width:90%;max-width:800px;max-height:90vh;overflow:hidden;border:1px solid var(--border-color);display:flex;flex-direction:column}.modal-header{display:flex;justify-content:space-between;align-items:center;padding:var(--spacing-lg);border-bottom:1px solid var(--border-color)}.modal-header h2{margin:0;color:var(--text-primary)}.modal-close{background:transparent;border:none;font-size:1.5rem;cursor:pointer;color:var(--text-secondary);transition:color var(--transition-base);padding:var(--spacing-sm);border-radius:var(--border-radius);min-height:44px;min-width:44px}.modal-close:hover{color:var(--text-primary)}.modal-body{flex:1;overflow-y:auto;padding:var(--spacing-lg)}.modal-footer{display:flex;justify-content:flex-end;gap:var(--spacing-md);padding:var(--spacing-lg);border-top:1px solid var(--border-color)}.apartment-details{display:flex;flex-direction:column;gap:var(--spacing-lg)}.detail-header{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:var(--spacing-md)}.score-display,.price-display{text-align:center}.score-display .score-badge{position:static;width:12px;height:12px;display:inline-block;margin-right:var(--spacing-sm)}.score-label,.price-label{display:block;font-size:.75rem;color:var(--text-secondary);margin-top:var(--spacing-xs)}.price{font-size:1.5rem;font-weight:var(--font-weight-semibold);color:var(--primary-color)}.address-section,.specs-section,.amenities-section,.description-section,.listing-url-section,.contact-section{background:var(--gray-50);padding:var(--spacing-lg);border-radius:var(--border-radius)}.address-section h4,.specs-section h4,.amenities-section h4,.description-section h4,.listing-url-section h4,.contact-section h4{margin-bottom:var(--spacing-md);display:flex;align-items:center;gap:var(--spacing-sm);color:var(--text-primary)}.address-section h4 i,.specs-section h4 i,.amenities-section h4 i,.description-section h4 i,.listing-url-section h4 i,.contact-section h4 i{color:var(--secondary-color)}.specs-grid,.amenities-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:var(--spacing-md)}.spec-item,.amenity-item{display:flex;align-items:center;gap:var(--spacing-sm);color:var(--text-secondary)}.spec-item i,.amenity-item i{color:var(--text-light);width:16px;text-align:center}.amenity-item.highlight,.amenity-item.highlight i{color:var(--primary-color)}.health-status{display:flex;align-items:center;gap:var(--spacing-sm);padding:var(--spacing-md);border-radius:var(--border-radius);margin:var(--spacing-md) 0;font-size:.875rem}.health-status.healthy{background-color:rgba(16,185,129,.1);color:var(--success-color);border-left:4px solid var(--success-color)}.health-status.warning{background-color:rgba(245,158,11,.1);color:var(--warning-color);border-left:4px solid var(--warning-color)}.health-status.error{background-color:rgba(239,68,68,.1);color:var(--error-color);border-left:4px solid var(--error-color)}.url-disclaimer{color:var(--text-secondary);font-size:.875rem}.backup-options{margin-top:var(--spacing-lg);padding:var(--spacing-lg);background-color:var(--gray-50);border-radius:var(--border-radius)}.backup-info.urgent{color:var(--error-color);font-weight:var(--font-weight-semibold);padding:var(--spacing-sm);background-color:rgba(239,68,68,.1);border-radius:var(--border-radius);border-left:3px solid var(--error-color)}.backup-buttons{display:flex;flex-direction:column;gap:var(--spacing-sm);margin-top:var(--spacing-md)}.backup-buttons.priority{border:1px solid var(--secondary-color);background-color:rgba(14,165,233,.05);padding:var(--spacing-md);border-radius:var(--border-radius)}.backup-buttons h6{margin:0 0 var(--spacing-sm) 0;color:var(--text-primary);font-size:.875rem}.toast-container{position:fixed;top:var(--spacing-lg);right:var(--spacing-lg);z-index:1100;display:flex;flex-direction:column;gap:var(--spacing-sm)}.toast{background:var(--bg-primary);border-radius:var(--border-radius);padding:var(--spacing-md);min-width:300px;border-left:4px solid var(--primary-color);box-shadow:var(--shadow-card);transform:translate(100%);transition:transform var(--transition-base)}.toast.show{transform:translate(0)}.toast.success{border-left-color:var(--success-color)}.toast.error{border-left-color:var(--error-color)}.toast.warning{border-left-color:var(--warning-color)}.toast-content{display:flex;align-items:center;gap:var(--spacing-sm)}.toast-content i{font-size:1.125rem}.toast.success .toast-content i{color:var(--success-color)}.toast.error .toast-content i{color:var(--error-color)}.toast.warning .toast-content i{color:var(--warning-color)}.text-center{text-align:center}.text-left{text-align:left}.text-right{text-align:right}.mb-1{margin-bottom:var(--spacing-md)}.mb-2{margin-bottom:var(--spacing-xl)}.mb-3{margin-bottom:var(--spacing-2xl)}.mt-1{margin-top:var(--spacing-md)}.mt-2{margin-top:var(--spacing-xl)}.mt-3{margin-top:var(--spacing-2xl)}.hidden{display:none!important}.visible{display:block!important}.fade-in{animation:fadeIn .3s ease-in}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}@media (max-width: 768px){.header{height:60px}.header-title{font-size:1.25rem}.container{padding:0 var(--spacing-md)}.search-card,.loading-indicator{padding:var(--spacing-lg)}.criteria-grid{grid-template-columns:1fr;gap:var(--spacing-md)}.results-header{flex-direction:column;align-items:flex-start}.results-grid{grid-template-columns:1fr;gap:var(--spacing-lg)}.recent-grid,.filter-content,.card-details{grid-template-columns:1fr}.modal-content{width:95%;max-height:95vh}.modal-footer{flex-direction:column}.detail-header{flex-direction:column;align-items:flex-start}.specs-grid,.amenities-grid{grid-template-columns:1fr}.toast-container{left:var(--spacing-md);right:var(--spacing-md)}.toast{min-width:unset}.listing-info{flex-direction:column;align-items:flex-start;gap:var(--spacing-sm)}.link-health-indicator{font-size:.75rem;padding:1px var(--spacing-xs)}.backup-links{padding:var(--spacing-sm)}.backup-buttons{gap:var(--spacing-sm)}.health-status{padding:var(--spacing-sm);font-size:.75rem}}.data-attributions{background:linear-gradient(135deg,var(--surface-color) 0%,var(--background-color) 100%);border-top:1px solid var(--border-color);margin-top:var(--spacing-xl);padding:var(--spacing-xl) 0;color:var(--text-secondary);font-size:.875rem}.attribution-content h4{color:var(--text-primary);margin-bottom:var(--spacing-lg);text-align:center;font-size:1.25rem}.attribution-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:var(--spacing-lg);margin-bottom:var(--spacing-xl)}.attribution-item{background:rgba(255,255,255,.05);padding:var(--spacing-md);border-radius:var(--border-radius);border-left:3px solid var(--primary-color)}.attribution-item strong{color:var(--primary-color);display:block;margin-bottom:var(--spacing-xs);font-weight:600}.attribution-item span{color:var(--text-secondary);line-height:1.5}.disclaimer{background:rgba(245,158,11,.1);border:1px solid rgba(245,158,11,.3);border-radius:var(--border-radius);padding:var(--spacing-md);text-align:center}.disclaimer p{margin:0;color:var(--warning-color);font-size:.875rem;line-height:1.6}.disclaimer strong{color:var(--warning-color)}@media (max-width: 768px){.attribution-grid{grid-template-columns:1fr;gap:var(--spacing-md)}.attribution-item{padding:var(--spacing-sm)}.data-attributions{padding:var(--spacing-lg) 0}}@media (min-width: 1200px){.container{max-width:1400px}.results-grid,.criteria-grid{grid-template-columns:repeat(3,1fr)}}@media (max-width: 1199px){.search-card{padding:var(--spacing-xl)}}@media (max-width: 991px){.container{padding:0 var(--spacing-md)}.search-card{padding:var(--spacing-lg)}.criteria-grid{grid-template-columns:repeat(2,1fr);gap:var(--spacing-md)}.results-header{flex-direction:column;gap:var(--spacing-md);align-items:flex-start}.results-stats{width:100%;justify-content:space-between}.filter-content{grid-template-columns:repeat(2,1fr)}.results-grid{grid-template-columns:repeat(2,1fr);gap:var(--spacing-lg)}.modal-content{margin:var(--spacing-md);max-width:calc(100% - 2rem)}}@media (max-width: 767px){.main{padding:var(--spacing-xl) 0}.header{height:60px}.header-title{font-size:1.25rem}.header-subtitle{font-size:.8rem}.search-card{padding:var(--spacing-lg)}.search-card h2{font-size:1.375rem}.search-description{font-size:.875rem}.criteria-grid{grid-template-columns:1fr;gap:var(--spacing-sm)}.criteria-item{padding:var(--spacing-sm);font-size:.875rem;background:var(--gray-50);border-radius:var(--border-radius);border:1px solid var(--border-color)}.search-btn{width:100%;padding:var(--spacing-md) var(--spacing-xl);font-size:1rem;min-height:48px}.filter-content{grid-template-columns:1fr;gap:var(--spacing-md)}.results-header h2{font-size:1.375rem}.results-stats{flex-direction:column;gap:var(--spacing-sm);align-items:flex-start}.export-btn{width:100%;text-align:center;min-height:44px}.results-grid{grid-template-columns:1fr;gap:var(--spacing-lg)}.recent-grid{grid-template-columns:1fr}.card-details{grid-template-columns:1fr;gap:var(--spacing-xs)}.listing-buttons{gap:var(--spacing-sm)}.view-listing-btn{width:100%;justify-content:center;text-align:center;min-height:44px}.listing-source{text-align:center;font-size:.75rem}.modal-content{margin:var(--spacing-sm);max-width:calc(100% - 1rem);max-height:calc(100vh - 1rem)}.modal-body{padding:var(--spacing-md)}.modal-footer{flex-direction:column;gap:var(--spacing-sm)}.btn-secondary{width:100%;text-align:center;min-height:44px}.toast-container{right:var(--spacing-md);left:var(--spacing-md);top:var(--spacing-md)}.toast{margin-bottom:var(--spacing-sm)}.toggle-btn,.modal-close{min-height:44px;min-width:44px;padding:var(--spacing-md)}.show-backups-btn{min-height:44px;font-size:.875rem}}@media (max-width: 575px){.container{padding:0 var(--spacing-sm)}.header-title{font-size:1.125rem}.header-subtitle{font-size:.75rem}.main{padding:var(--spacing-lg) 0}.search-card{padding:var(--spacing-md);margin-bottom:var(--spacing-xl)}.search-card h2{font-size:1.25rem;margin-bottom:var(--spacing-sm)}.search-description{font-size:.8rem;margin-bottom:var(--spacing-md)}.criteria-item{padding:var(--spacing-sm);font-size:.8rem;text-align:center}.search-btn{padding:var(--spacing-md) var(--spacing-lg);font-size:.875rem}.loading-indicator{padding:var(--spacing-md)}.progress-steps{font-size:.8rem}.filter-panel{margin-bottom:var(--spacing-lg)}.filter-header{padding:var(--spacing-md)}.filter-header h3{font-size:1rem}.filter-content{padding:var(--spacing-md)}.results-section{margin-top:var(--spacing-lg)}.results-header{margin-bottom:var(--spacing-lg)}.results-header h2{font-size:1.25rem}.recent-listings h3{font-size:1.125rem;margin-bottom:var(--spacing-md)}.apartment-card{border-radius:var(--border-radius)}.card-image{height:180px}.score-badge{top:var(--spacing-sm);right:var(--spacing-sm);width:6px;height:6px}.card-content{padding:var(--spacing-md)}.card-title{font-size:1rem;margin-bottom:var(--spacing-xs)}.card-address{font-size:.8rem;margin-bottom:var(--spacing-sm)}.detail-item{font-size:.75rem}.card-price{font-size:1.125rem}.card-features{margin:var(--spacing-sm) 0;gap:var(--spacing-xs)}.feature-tag{padding:2px var(--spacing-xs);font-size:.7rem}.no-results{padding:var(--spacing-xl) var(--spacing-md)}.no-results i{font-size:2.5rem}.no-results h3{font-size:1.125rem}.checkbox-group input[type=checkbox]{width:18px;height:18px}.filter-group select{min-height:44px;padding:var(--spacing-sm) var(--spacing-md)}.link-health-indicator{font-size:.7rem;padding:1px var(--spacing-xs)}.backup-links{padding:var(--spacing-sm);margin-top:var(--spacing-xs)}.show-backups-btn{font-size:.75rem;margin-top:var(--spacing-xs)}}@media (max-width: 400px){.header-title{font-size:1rem}.search-card h2{font-size:1.125rem}.search-description br{display:none}.criteria-item{padding:var(--spacing-xs);font-size:.75rem}.search-btn{padding:var(--spacing-sm) var(--spacing-md);font-size:.8rem}.modal-content{margin:var(--spacing-xs);max-width:calc(100% - .5rem)}.toast-container{right:var(--spacing-xs);left:var(--spacing-xs)}.card-content{padding:var(--spacing-sm)}.card-title{font-size:.9rem}.card-price{font-size:1rem}}@media (max-height: 500px) and (orientation: landscape){.header{height:50px}.header-title{font-size:1.125rem}.main{padding:var(--spacing-md) 0}.search-card{padding:var(--spacing-md)}.modal-content{max-height:95vh}.card-image{height:140px}}@media (-webkit-min-device-pixel-ratio: 2),(min-resolution: 192dpi){.apartment-card,.search-card,.filter-panel,.modal-content{box-shadow:var(--shadow-card)}}@media print{.header,.search-section,.filter-panel,.modal,.toast-container{display:none!important}.results-section{margin-top:0}.apartment-card{box-shadow:none;border:1px solid var(--border-color);break-inside:avoid;margin-bottom:var(--spacing-md)}.results-grid{grid-template-columns:repeat(2,1fr);gap:var(--spacing-md)}body{background:#fff;color:#000}.card-price{color:#000}.feature-tag.highlight{border:1px solid #333;background:#f0f0f0}}@media (prefers-reduced-motion: reduce){*{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important}.fade-in{animation:none}}@media (prefers-color-scheme: dark){:root{color-scheme:light}}\n/*$vite$:1*/",document.head.appendChild(e);class a{constructor(){this.baseUrl=this.detectBackendUrl(),this.isBackendAvailable=!1,this.lastHealthCheck=null}detectBackendUrl(){return"localhost"===window.location.hostname||window.location.hostname,"http://localhost:8000"}async checkHealth(){if(!this.baseUrl)return{available:!1,reason:"Backend URL not configured"};try{const e=new AbortController,a=setTimeout(()=>e.abort(),5e3),t=await fetch(`${this.baseUrl}/health`,{method:"GET",headers:{"Content-Type":"application/json"},signal:e.signal});if(clearTimeout(a),t.ok){const e=await t.json();return this.isBackendAvailable=e.agent_ready,this.lastHealthCheck=new Date,{available:this.isBackendAvailable,health:e}}return{available:!1,reason:`HTTP ${t.status}`}}catch(e){return this.isBackendAvailable=!1,{available:!1,reason:"AbortError"===e.name?"Timeout":e.message}}}async searchApartments(e=null,a={}){const t=await this.checkHealth();if(!t.available)throw new Error(`DeepSearchAgent backend not available: ${t.reason}`);try{const t={zip_codes:e,max_results:a.maxResults||50,filters:{min_price:a.minPrice,max_price:a.maxPrice,min_score:a.minScore,required_amenities:a.requiredAmenities}};console.log("🔍 Sending search request to DeepSearchAgent:",t);const r=new AbortController,i=setTimeout(()=>r.abort(),6e4),n=await fetch(`${this.baseUrl}/search`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),signal:r.signal});if(clearTimeout(i),!n.ok){const e=await n.json().catch(()=>({}));throw new Error(e.detail||`Search failed with status ${n.status}`)}const o=await n.json();return console.log("✅ DeepSearchAgent search completed:",o),this.transformSearchResults(o)}catch(r){throw console.error("❌ DeepSearchAgent search failed:",r),r}}async verifyListing(e){const a=await this.checkHealth();if(!a.available)throw new Error(`DeepSearchAgent backend not available: ${a.reason}`);try{const a=new AbortController,t=setTimeout(()=>a.abort(),3e4),r=await fetch(`${this.baseUrl}/verify-listing`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({listing_url:e}),signal:a.signal});if(clearTimeout(t),!r.ok)throw new Error(`Verification failed with status ${r.status}`);return await r.json()}catch(t){throw console.error("❌ Listing verification failed:",t),t}}async getSearchConfig(){if(!(await this.checkHealth()).available)return null;try{const e=await fetch(`${this.baseUrl}/config`);if(e.ok)return await e.json()}catch(e){console.warn("Could not fetch search config:",e)}return null}transformSearchResults(e){return e.success&&e.apartments?e.apartments.map(e=>this.transformApartment(e)):[]}transformApartment(e){return{id:e.id||this.generateId(e),title:e.title||this.generateTitle(e),address:e.address||"Address not available",zipCode:e.zip_code||e.zipCode||"Unknown",price:e.price||0,bedrooms:e.bedrooms||2,bathrooms:e.bathrooms||1.5,sqft:e.sqft||null,floor:e.floor||null,features:this.transformAmenities(e.amenities||[]),highlightFeatures:this.getHighlightFeatures(e.amenities||[]),recentlyRenovated:this.hasAmenity(e.amenities,"recently_renovated"),premiumAmenities:this.hasPremiumAmenities(e.amenities||[]),datePosted:e.datePosted||e.found_at||(new Date).toISOString(),source:e.platform||e.source||"DeepSearch",url:e.url||e.source_url,contact:e.contact||{},images:e.images||[],description:e.description||this.generateDescription(e),score:this.calculateDisplayScore(e),scoreBreakdown:e.validation||{},urlHealth:this.transformUrlHealth(e),urlHealthSummary:this.generateUrlHealthSummary(e),backupUrls:e.backup_urls||[],searchMetadata:e.search_metadata||{},extractedAt:e.extracted_at||(new Date).toISOString()}}generateId(e){return`apt_${[e.address||"",e.price||"",e.bedrooms||"",Date.now()].join("_").replace(/[^a-zA-Z0-9_]/g,"_")}`}generateTitle(e){return`${e.bedrooms||2}-Bedroom Apartment in ${this.extractAreaFromAddress(e.address)||"West LA"}`}extractAreaFromAddress(e){if(!e)return null;const a=["Mar Vista","Culver City","Palms","Venice","Santa Monica"];for(const t of a)if(e.toLowerCase().includes(t.toLowerCase()))return t;return null}transformAmenities(e){const a={washer_dryer:"In-Unit Washer/Dryer",air_conditioning:"Central Air Conditioning",outdoor_space:"Private Balcony",parking:"Parking Garage",pool:"Swimming Pool",gym:"Fitness Center",dishwasher:"Dishwasher",hardwood:"Hardwood Floors",granite:"Granite Countertops",stainless:"Stainless Steel Appliances"};return e.map(e=>a[e]||this.capitalizeAmenity(e))}capitalizeAmenity(e){return e.replace(/_/g," ").split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}getHighlightFeatures(e){const a=["washer_dryer","air_conditioning","outdoor_space","recently_renovated","hardwood","granite"];return e.filter(e=>a.includes(e)).map(e=>this.transformAmenities([e])[0])}hasAmenity(e,a){return e&&e.includes(a)}hasPremiumAmenities(e){return["pool","gym","parking","granite","stainless"].some(a=>e.includes(a))}generateDescription(e){return`Beautiful ${e.bedrooms||2}-bedroom apartment in ${this.extractAreaFromAddress(e.address)||"West LA"}. Rent: ${e.price?`$${e.price.toLocaleString()}`:"Contact for pricing"}/month. Verified listing found through DeepSearch AI. Contact directly for viewing and more information.`}calculateDisplayScore(e){const a=e.validation;if(a&&a.percentage)return Math.round(a.percentage);let t=60;const r=e.price||0;r>=4400&&r<=5200&&(t+=20);const i=e.amenities||[];return i.includes("washer_dryer")&&(t+=5),i.includes("air_conditioning")&&(t+=5),i.includes("outdoor_space")&&(t+=5),this.hasPremiumAmenities(i)&&(t+=5),Math.min(100,Math.max(0,t))}transformUrlHealth(e){const a=e.verification;return a?{healthy:a.verified,status:a.verified?"verified":"failed",error:a.error,responseTime:a.response_time,verifiedAt:a.verified_at}:{healthy:!0,status:"unverified"}}generateUrlHealthSummary(e){return this.transformUrlHealth(e).healthy?{className:"healthy",icon:"fas fa-check-circle",message:"Link verified and accessible"}:{className:"error",icon:"fas fa-exclamation-triangle",message:"Primary link may not work - see alternatives"}}static async isAvailable(){const e=new a;return(await e.checkHealth()).available}getBackendStatus(){return{baseUrl:this.baseUrl,isAvailable:this.isBackendAvailable,lastHealthCheck:this.lastHealthCheck}}}class t{constructor(){this.searchCriteria={minRent:4400,maxRent:5200,bedrooms:2,minBathrooms:1.5,maxBathrooms:2,zipCodes:["90066","90230","90232","90034"],zipCodePriority:{90066:1,90230:2,90232:3,90034:4},requiredAmenities:["washer_dryer","air_conditioning","outdoor_space","above_ground_floor"],preferredFeatures:["recently_renovated","modern_interior","natural_light"]},this.deepSearchClient=new a,this.isDeepSearchAvailable=!1}async searchApartments(e){console.log("🏠 Starting live apartment search with DeepSearchAgent...");const a=await this.deepSearchClient.checkHealth();if(this.isDeepSearchAvailable=a.available,e&&e(10),!this.isDeepSearchAvailable)throw console.warn("⚠️ DeepSearchAgent not available:",a.reason),new Error(`DeepSearchAgent backend not available: ${a.reason}. Please start the backend server.`);try{e&&e(25);const a={minPrice:this.searchCriteria.minRent,maxPrice:this.searchCriteria.maxRent,maxResults:50,requiredAmenities:this.searchCriteria.requiredAmenities};console.log("🔍 Searching with DeepSearchAgent...",{zipCodes:this.searchCriteria.zipCodes,filters:a}),e&&e(50);const t=await this.deepSearchClient.searchApartments(this.searchCriteria.zipCodes,a);console.log(`✅ DeepSearchAgent found ${t.length} live apartments`),e&&e(75);const r=t.filter(e=>this.validateApartment(e));console.log(`✅ ${r.length} live apartments passed validation`);const i=this.sortApartmentsByPriority(r);return e&&e(100),this.logSearchSummary(i),i}catch(t){throw console.error("❌ DeepSearchAgent search failed:",t),new Error(`DeepSearchAgent search failed: ${t.message}. Please check backend configuration.`)}}validateApartment(e){const a=this.searchCriteria;return e.title&&e.address&&e.url?e.price<a.minRent||e.price>a.maxRent?(console.log(`❌ Apartment rejected - price ${e.price} outside range`),!1):e.bedrooms!==a.bedrooms?(console.log(`❌ Apartment rejected - ${e.bedrooms} bedrooms, need ${a.bedrooms}`),!1):e.bathrooms<a.minBathrooms||e.bathrooms>a.maxBathrooms?(console.log(`❌ Apartment rejected - ${e.bathrooms} bathrooms outside range`),!1):e.url&&""!==e.url.trim()?(console.log(`✅ Live apartment validated: ${e.title}`),!0):(console.log("❌ Apartment rejected - no valid URL"),!1):(console.log("❌ Apartment rejected - missing required fields"),!1)}sortApartmentsByPriority(e){return e.sort((e,a)=>{const t=this.searchCriteria.zipCodePriority[e.zipCode]||999,r=this.searchCriteria.zipCodePriority[a.zipCode]||999;return t!==r?t-r:(a.score||0)-(e.score||0)})}logSearchSummary(e){console.log("\n📊 LIVE SEARCH SUMMARY:"),console.log(`Total live apartments found: ${e.length}`);const a=e.reduce((e,a)=>(e[a.zipCode]=(e[a.zipCode]||0)+1,e),{});console.log("Breakdown by zip code:"),Object.entries(a).forEach(([e,a])=>{const t=this.getAreaName(e);console.log(`  ${e} (${t}): ${a} live apartments`)});const t=e.reduce((e,a)=>(e[a.source]=(e[a.source]||0)+1,e),{});console.log("Data sources:"),Object.entries(t).forEach(([e,a])=>{console.log(`  ${e}: ${a} listings`)});const r=e.map(e=>e.price).filter(e=>e>0);if(r.length>0){const e=Math.min(...r),a=Math.max(...r),t=Math.round(r.reduce((e,a)=>e+a,0)/r.length);console.log(`Price range: $${e.toLocaleString()} - $${a.toLocaleString()} (avg: $${t.toLocaleString()})`)}const i=e.map(e=>e.score).filter(e=>e>0);if(i.length>0){const e=Math.round(i.reduce((e,a)=>e+a,0)/i.length),a=Math.max(...i);console.log(`Score range: ${Math.min(...i)} - ${a} (avg: ${e})`)}console.log("\n🎯 Top 5 live matches:"),e.slice(0,5).forEach((e,a)=>{console.log(`${a+1}. ${e.title} - ${e.address} - $${e.price} (Score: ${e.score}) [${e.source}]`)})}getAreaName(e){return{90066:"Mar Vista",90230:"Culver City",90232:"Culver City",90034:"Palms"}[e]||"West LA"}getStatus(){return{type:"live",deepSearchAvailable:this.isDeepSearchAvailable,backendStatus:this.deepSearchClient.getBackendStatus(),searchCriteria:this.searchCriteria,message:"Live apartment search powered by DeepSearchAgent"}}delay(e){return new Promise(a=>setTimeout(a,e))}}class r{constructor(){this.weights={rentInRange:20,mandatoryAmenities:30,renovationRecency:25,naturalLight:15,outdoorSpaceQuality:10,zipCodePriority:10,premiumAmenities:5,locationRating:5,professionalPhotos:3,floorLevel:2},this.maxScore=100}calculateScore(e,a={minRent:4400,maxRent:5200,zipCodePriority:{90066:1,90230:2,90232:3,90034:4}}){let t=0;return t+=this.calculateRentScore(e.price,a),t+=this.calculateMandatoryAmenityScore(e),t+=this.calculateRenovationScore(e),t+=this.calculateNaturalLightScore(e),t+=this.calculateOutdoorSpaceScore(e),t+=this.calculateZipCodeScore(e.zipCode,a),t+=this.calculatePremiumAmenitiesScore(e),t+=this.calculateLocationRatingScore(e),t+=this.calculatePhotoScore(e),t+=this.calculateFloorScore(e),Math.round(Math.min(t,this.maxScore))}getScoreBreakdown(e,a={minRent:4400,maxRent:5200,zipCodePriority:{90066:1,90230:2,90232:3,90034:4}}){const t={};return t.price=this.calculateRentScore(e.price,a),t.specs=this.calculateMandatoryAmenityScore(e),t.floor=this.calculateFloorScore(e),t.features=this.calculateRenovationScore(e)+this.calculateNaturalLightScore(e)+this.calculateOutdoorSpaceScore(e),t.renovation=e.recentlyRenovated?10:0,t.total=Math.min(t.price+t.specs+t.floor+t.features+t.renovation,100),t}calculateRentScore(e,a){const{minRent:t,maxRent:r}=a;if(e<t||e>r)return 0;const i=(t+r)/2,n=(r-t)/2,o=Math.abs(e-i),s=this.weights.rentInRange*(1-o/n);return Math.round(s)}calculateMandatoryAmenityScore(e){const a={washerDryer:!1,airConditioning:!1,outdoorSpace:!1,aboveGroundFloor:!1},t=e.features.map(e=>e.toLowerCase());a.washerDryer=t.some(e=>e.includes("washer")&&e.includes("dryer")||e.includes("w/d")||e.includes("laundry")),a.airConditioning=t.some(e=>e.includes("air")||e.includes("conditioning")||e.includes("hvac")||e.includes("central air")),a.outdoorSpace=t.some(e=>e.includes("balcony")||e.includes("patio")||e.includes("terrace")||e.includes("deck")||e.includes("outdoor")),a.aboveGroundFloor=e.floor>1;const r=Object.values(a).filter(Boolean).length/Object.keys(a).length;return Math.round(this.weights.mandatoryAmenities*r)}calculateRenovationScore(e){const a=e.features.map(e=>e.toLowerCase()),t=["renovated","updated","remodeled","modern","new","contemporary","upgraded","refreshed","redesigned"],r=a.some(e=>t.some(a=>e.includes(a))),i=e.recentlyRenovated||!1,n=["stainless steel","granite","quartz","hardwood","modern kitchen","designer","luxury"],o=a.some(e=>n.some(a=>e.includes(a)));let s=0;return s=i?this.weights.renovationRecency:r&&o?.8*this.weights.renovationRecency:r||o?.5*this.weights.renovationRecency:.2*this.weights.renovationRecency,Math.round(s)}calculateNaturalLightScore(e){const a=e.features.map(e=>e.toLowerCase()),t=e.description?.toLowerCase()||"",r=["natural light","bright","sunny","light-filled","windows","large windows","floor-to-ceiling","multiple exposures","corner unit"],i=a.concat([t]).some(e=>r.some(a=>e.includes(a))),n=e.floor>5?.2:0;let o=0;return o=i?this.weights.naturalLight*(.8+n):this.weights.naturalLight*(.4+n),Math.round(o)}calculateOutdoorSpaceScore(e){const a=e.features.map(e=>e.toLowerCase()),t={"private balcony":1,terrace:1,"private patio":.9,deck:.8,balcony:.7,patio:.6,outdoor:.5};let r=0;for(const[i,n]of Object.entries(t))a.some(e=>e.includes(i))&&(r=Math.max(r,this.weights.outdoorSpaceQuality*n));return Math.round(r)}calculateZipCodeScore(e,a){const t=a.zipCodePriority[e]||5,r=Math.max(0,(5-t)/4);return Math.round(this.weights.zipCodePriority*r)}calculatePremiumAmenitiesScore(e){const a=e.features.map(e=>e.toLowerCase()),t=["swimming pool","fitness center","gym","concierge","doorman","roof deck","rooftop","parking garage","valet parking","business center","club room"],r=a.filter(e=>t.some(a=>e.includes(a))).length,i=Math.min(1.5*r,this.weights.premiumAmenities);return Math.round(i)}calculateLocationRatingScore(e){const a={90066:4.5,90230:4.2,90232:3.8,90034:3.5}[e.zipCode]||3,t=e.price>4800?.2:0,r=Math.min(a+t,5),i=Math.max(0,(r-3)/2);return Math.round(this.weights.locationRating*i)}calculatePhotoScore(e){const a=e.images?.length||0;return a>=5?this.weights.professionalPhotos:a>=3?Math.round(.7*this.weights.professionalPhotos):a>=1?Math.round(.4*this.weights.professionalPhotos):0}calculateFloorScore(e){const a=e.floor||2;return a>=3&&a<=6?this.weights.floorLevel:2===a||7===a||8===a?Math.round(.7*this.weights.floorLevel):a>8?Math.round(.5*this.weights.floorLevel):0}}const i=new class{constructor(e={}){this.options={rootMargin:"50px",threshold:.1,placeholderSrc:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9ImciIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPjxzdG9wIG9mZnNldD0iMCUiIHN0b3AtY29sb3I9IiNmNWY1ZjUiLz48c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiNlZWVlZWUiLz48L2xpbmVhckdyYWRpZW50PjwvZGVmcz48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ1cmwoI2cpIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNHB4IiBmaWxsPSIjOTk5OTk5IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIj5Mb2FkaW5nLi4uPC90ZXh0Pjwvc3ZnPg==",errorSrc:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjVmNWY1Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNHB4IiBmaWxsPSIjOTk5OTk5IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIj5JbWFnZSBVbmF2YWlsYWJsZTwvdGV4dD48L3N2Zz4=",fadeInDuration:300,retryAttempts:2,retryDelay:1e3,...e},this.observer=null,this.loadedImages=new Set,this.failedImages=new Set,this.retryCount=new Map,this.init()}init(){"IntersectionObserver"in window?(this.observer=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&this.loadImage(e.target)})},{rootMargin:this.options.rootMargin,threshold:this.options.threshold}),this.observeImages()):this.loadAllImages()}observeImages(){document.querySelectorAll("img[data-src]").forEach(e=>{this.loadedImages.has(e)||(this.setupImageForLazyLoading(e),this.observer.observe(e))})}setupImageForLazyLoading(e){e.src&&""!==e.src||(e.src=this.options.placeholderSrc),e.classList.add("lazy-loading"),this.addLoadingIndicator(e),e.style.opacity="0",e.style.transition=`opacity ${this.options.fadeInDuration}ms ease-in-out`}addLoadingIndicator(e){const a=e.parentElement;if(!a.classList.contains("image-container")){const a=document.createElement("div");a.className="image-container",e.parentNode.insertBefore(a,e),a.appendChild(e)}if(!a.querySelector(".loading-indicator")){const e=document.createElement("div");e.className="loading-indicator",e.innerHTML='\n                <div class="loading-spinner">\n                    <div class="spinner"></div>\n                </div>\n            ',a.appendChild(e)}}async loadImage(e){const a=e.getAttribute("data-src");if(a&&!this.loadedImages.has(e))try{this.observer&&this.observer.unobserve(e),await this.preloadImage(a),e.src=a,e.removeAttribute("data-src"),e.classList.remove("lazy-loading"),e.classList.add("lazy-loaded"),e.style.opacity="1",this.removeLoadingIndicator(e),this.loadedImages.add(e),e.dispatchEvent(new CustomEvent("lazyLoaded",{detail:{src:a,img:e}}))}catch(t){console.warn("Failed to load image:",a,t),await this.handleImageError(e,a)}}preloadImage(e){return new Promise((a,t)=>{const r=new Image;r.onload=()=>a(r),r.onerror=()=>t(new Error(`Failed to load image: ${e}`)),setTimeout(()=>{t(new Error(`Image load timeout: ${e}`))},1e4),r.src=e})}async handleImageError(e,a){const t=a,r=this.retryCount.get(t)||0;if(r<this.options.retryAttempts){this.retryCount.set(t,r+1),await new Promise(e=>setTimeout(e,this.options.retryDelay));try{return await this.preloadImage(a),e.src=a,e.removeAttribute("data-src"),e.classList.remove("lazy-loading"),e.classList.add("lazy-loaded"),e.style.opacity="1",this.removeLoadingIndicator(e),void this.loadedImages.add(e)}catch{console.warn(`Retry ${r+1} failed for image:`,a)}}e.src=this.options.errorSrc,e.classList.remove("lazy-loading"),e.classList.add("lazy-error"),e.style.opacity="1",this.removeLoadingIndicator(e),this.failedImages.add(e),e.dispatchEvent(new CustomEvent("lazyLoadError",{detail:{originalSrc:a,img:e}}))}removeLoadingIndicator(e){const a=e.parentElement.querySelector(".loading-indicator");a&&(a.classList.add("fade-out"),setTimeout(()=>{a.parentNode&&a.parentNode.removeChild(a)},200))}loadAllImages(){document.querySelectorAll("img[data-src]").forEach(e=>{this.setupImageForLazyLoading(e),this.loadImage(e)})}refresh(){this.observer&&this.observeImages()}observe(e){this.observer&&(Array.isArray(e)?e:[e]).forEach(e=>{"IMG"===e.tagName&&e.hasAttribute("data-src")&&(this.setupImageForLazyLoading(e),this.observer.observe(e))})}loadImagesInContainer(e){e.querySelectorAll("img[data-src]").forEach(e=>this.loadImage(e))}getStats(){return{loaded:this.loadedImages.size,failed:this.failedImages.size,pending:document.querySelectorAll("img[data-src]").length}}destroy(){this.observer&&(this.observer.disconnect(),this.observer=null),this.loadedImages.clear(),this.failedImages.clear(),this.retryCount.clear()}};"undefined"!=typeof window&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{i.refresh()}):i.refresh());const n=new class{constructor(){this.healthCache=new Map,this.maxCacheAge=3e5,this.timeoutDuration=1e4}async checkUrlHealth(e){const a=this.getFromCache(e);if(a)return a;const t=Date.now();let r;try{if(!this.isValidUrl(e))throw new Error("Invalid URL format");const a=new window.AbortController;let i;r=setTimeout(()=>a.abort(),this.timeoutDuration);try{i=await fetch(e,{method:"HEAD",signal:a.signal,mode:"no-cors",cache:"no-cache",redirect:"follow"})}catch{i=await fetch(e,{method:"GET",signal:a.signal,mode:"no-cors",cache:"no-cache",redirect:"follow"})}clearTimeout(r);const n=Date.now()-t;let o="accessible",s=!0;"opaque"===i.type?o="cors_accessible":i.status&&(o=i.status,s=i.status>=200&&i.status<400);const c={healthy:s,status:o,responseTime:n,lastChecked:Date.now(),method:"validated"};return this.setCache(e,c),c}catch(i){r&&clearTimeout(r);const a=Date.now()-t;let n="unknown",o=!1;"AbortError"===i.name?n="timeout":i.message.includes("CORS")||i.message.includes("cross-origin")?(n="cors_blocked",o=!0):i.message.includes("NetworkError")||i.message.includes("Failed to fetch")?this.isKnownGoodDomain(e)?(n="network_cors",o=!0):n="network_error":n=i.message.includes("404")||i.message.includes("Not Found")?"404_not_found":i.message.includes("Invalid URL")?"invalid_url":"error";const s={healthy:o,status:n,responseTime:a,error:i.message,lastChecked:Date.now(),method:"error_detected"};return this.setCache(e,s),s}}isValidUrl(e){try{const a=new URL(e);return"http:"===a.protocol||"https:"===a.protocol}catch{return!1}}isKnownGoodDomain(e){const a=["apartments.com","zillow.com","trulia.com","hotpads.com","westsiderentals.com","realtor.com","rent.com","padmapper.com","craigslist.org","facebook.com","google.com"];try{const t=new URL(e).hostname.toLowerCase();return a.some(e=>t.includes(e))}catch{return!1}}async checkMultipleUrls(e){const a=e.map(async e=>({url:e,health:await this.checkUrlHealth(e)}));return await Promise.all(a)}getFromCache(e){const a=this.healthCache.get(e);return a&&Date.now()-a.lastChecked<this.maxCacheAge?a:null}setCache(e,a){this.healthCache.set(e,a),this.healthCache.size>100&&this.cleanupCache()}cleanupCache(){const e=Date.now();for(const[a,t]of this.healthCache.entries())e-t.lastChecked>this.maxCacheAge&&this.healthCache.delete(a)}getHealthSummary(e){const{healthy:a,status:t,responseTime:r,error:i}=e;let n={className:"unknown",icon:"fas fa-question-circle",message:"Unknown status",color:"#6c757d"};if(a)n="cors_blocked"===t?{className:"warning",icon:"fas fa-exclamation-triangle",message:"Cannot verify (CORS), but likely accessible",color:"#f39c12"}:{className:"healthy",icon:"fas fa-check-circle",message:`Accessible (${r}ms)`,color:"#27ae60"};else switch(t){case"timeout":n={className:"error",icon:"fas fa-clock",message:"Connection timeout",color:"#e74c3c"};break;case"404_not_found":n={className:"error",icon:"fas fa-unlink",message:"Page not found (404)",color:"#e74c3c"};break;case"network_error":n={className:"error",icon:"fas fa-wifi",message:"Network error",color:"#e74c3c"};break;default:n={className:"error",icon:"fas fa-exclamation-circle",message:i?`Error: ${i.substring(0,50)}...`:"Connection failed",color:"#e74c3c"}}return n}generateAlternativeUrls(e,a,t){const r=encodeURIComponent(e||""),i=encodeURIComponent(`${e} CA ${a} apartments rent 2 bedroom`);return[{name:"Google Search",url:`https://www.google.com/search?q=${i}&tbm=&tbs=qdr:m`,type:"search",priority:1,description:"Comprehensive search results"},{name:"Apartments.com",url:"https://www.apartments.com/los-angeles-ca/",type:"listings",priority:1,description:"Browse LA apartments"},{name:"Zillow Rentals",url:"https://www.zillow.com/los-angeles-ca/rentals/",type:"listings",priority:1,description:"Rental listings on Zillow"},{name:"Rent.com Search",url:"https://www.rent.com/california/los-angeles-apartments",type:"listings",priority:2,description:"Rent.com listings"},{name:"HotPads",url:"https://hotpads.com/los-angeles-ca/apartments-for-rent",type:"listings",priority:2,description:"Map-based apartment search"},{name:"Trulia Rentals",url:"https://www.trulia.com/for_rent/Los_Angeles,CA/",type:"listings",priority:2,description:"Neighborhood-focused search"},{name:"Westside Rentals",url:"https://www.westsiderentals.com/",type:"listings",priority:2,description:"Westside LA specialist"},{name:"PadMapper",url:"https://www.padmapper.com/apartments/los-angeles-ca",type:"listings",priority:3,description:"Interactive map search"},{name:"Craigslist LA",url:`https://losangeles.craigslist.org/search/apa?query=${r}+${a}`,type:"community",priority:3,description:"Community listings"},{name:"Facebook Marketplace",url:"https://www.facebook.com/marketplace/los-angeles/propertyrentals",type:"community",priority:3,description:"Social marketplace"},{name:"Bing Search",url:`https://www.bing.com/search?q=${t?encodeURIComponent(`${e} apartments under ${t} rent`):i}`,type:"search",priority:4,description:"Alternative search engine"},{name:"Realtor.com",url:"https://www.realtor.com/apartments-for-rent/Los-Angeles_CA",type:"listings",priority:4,description:"Realtor apartment listings"}].sort((e,a)=>e.priority-a.priority)}generateSmartBackups(e,a,t,r,i){const n=this.generateAlternativeUrls(a,t,r);switch(i){case"cors_blocked":case"network_cors":return n.filter(e=>"search"===e.type||e.priority<=2).slice(0,4);case"timeout":return n.filter(e=>e.priority<=2&&"community"!==e.type).slice(0,3);case"404_not_found":case"invalid_url":return n.slice(0,6);default:return n.slice(0,5)}}async monitorApartmentUrls(e){console.log(`🔍 Monitoring health of ${e.length} apartment URLs...`);const a=[];for(const r of e)try{const e=await this.checkUrlHealth(r.url),t=this.getHealthSummary(e);a.push({...r,urlHealth:e,urlHealthSummary:t,alternativeUrls:e.healthy?r.backupUrls||[]:this.generateAlternativeUrls(r.address?.split(",")[1]?.trim(),r.zipCode,r.price)}),await new Promise(e=>setTimeout(e,100))}catch(t){console.warn(`Failed to monitor URL for apartment ${r.id}:`,t),a.push({...r,urlHealth:{healthy:!1,status:"monitor_error",error:t.message},urlHealthSummary:{className:"error",icon:"fas fa-exclamation-circle",message:"Monitoring failed",color:"#e74c3c"}})}return console.log(`✅ URL monitoring complete. ${a.filter(e=>e.urlHealth?.healthy).length}/${a.length} URLs appear healthy.`),a}clearCache(){this.healthCache.clear()}getCacheStats(){const e=Array.from(this.healthCache.values());return{totalEntries:this.healthCache.size,healthyUrls:e.filter(e=>e.healthy).length,unhealthyUrls:e.filter(e=>!e.healthy).length,averageResponseTime:e.length>0?e.reduce((e,a)=>e+(a.responseTime||0),0)/e.length:0,oldestEntry:e.length>0?Math.min(...e.map(e=>e.lastChecked)):null,newestEntry:e.length>0?Math.max(...e.map(e=>e.lastChecked)):null}}};class o{constructor(){this.apartments=[],this.filteredApartments=[],this.bookmarkedApartments=JSON.parse(localStorage.getItem("bookmarkedApartments")||"[]"),this.isSearching=!1,this.init()}init(){this.bindEvents(),this.loadBookmarks(),console.log("Apartment Finder App initialized")}bindEvents(){document.getElementById("searchBtn").addEventListener("click",()=>this.startSearch()),document.getElementById("sortBy").addEventListener("change",()=>this.applyFilters()),document.getElementById("minScore").addEventListener("input",e=>{document.getElementById("minScoreValue").textContent=e.target.value,this.applyFilters()}),["recentOnly","renovatedOnly","premiumOnly"].forEach(e=>{document.getElementById(e).addEventListener("change",()=>this.applyFilters())});const e=document.getElementById("toggleFilters"),a=document.querySelector(".filter-content");e.addEventListener("click",()=>{const t="none"!==a.style.display;a.style.display=t?"none":"block",e.innerHTML=t?'<i class="fas fa-chevron-down"></i>':'<i class="fas fa-chevron-up"></i>'});const t=document.getElementById("apartmentModal");document.getElementById("closeModal").addEventListener("click",()=>this.closeModal()),t.addEventListener("click",e=>{e.target===t&&this.closeModal()}),document.getElementById("exportBtn").addEventListener("click",()=>this.exportResults()),document.addEventListener("keydown",e=>{"Escape"===e.key&&"none"!==t.style.display&&this.closeModal(),"Enter"===e.key&&e.ctrlKey&&!this.isSearching&&this.startSearch()})}async startSearch(){if(!this.isSearching){this.isSearching=!0,this.showLoadingState();try{const e=new t,a=new r,i=e.getStatus();console.log("🔧 Search Engine Status:",i);const o=await e.searchApartments(e=>{this.updateProgress(e)});this.apartments=o.map(e=>({...e,score:a.calculateScore(e),scoreBreakdown:a.getScoreBreakdown(e)})),console.log("🔍 Checking apartment listing URLs..."),this.apartments=await n.monitorApartmentUrls(this.apartments),this.applyFilters(),this.showResults()}catch(e){console.error("Search failed:",e),this.showToast("Search failed. Please try again.","error")}finally{this.isSearching=!1,this.hideLoadingState()}}}showLoadingState(){const e=document.getElementById("searchBtn"),a=document.getElementById("loadingIndicator");e.style.display="none",a.style.display="block",document.getElementById("resultsSection").style.display="none",document.getElementById("filterPanel").style.display="none"}hideLoadingState(){const e=document.getElementById("searchBtn"),a=document.getElementById("loadingIndicator");e.style.display="inline-block",a.style.display="none"}updateProgress(e){const a=Math.min(Math.floor(e/25),3);["step1","step2","step3","step4"].forEach((e,t)=>{const r=document.getElementById(e);r.className=t<a?"step completed":t===a?"step active":"step"})}applyFilters(){if(!this.apartments.length)return;let e=[...this.apartments];const a=parseInt(document.getElementById("minScore").value);if(e=e.filter(e=>e.score>=a),document.getElementById("recentOnly").checked){const a=new Date(Date.now()-6048e5);e=e.filter(e=>new Date(e.datePosted)>a)}document.getElementById("renovatedOnly").checked&&(e=e.filter(e=>e.recentlyRenovated)),document.getElementById("premiumOnly").checked&&(e=e.filter(e=>e.premiumAmenities));const t=document.getElementById("sortBy").value;e.sort((e,a)=>{switch(t){case"score":default:return a.score-e.score;case"price-low":return e.price-a.price;case"price-high":return a.price-e.price;case"newest":return new Date(a.datePosted)-new Date(e.datePosted)}}),this.filteredApartments=e,this.renderResults()}showResults(){document.getElementById("resultsSection").style.display="block",document.getElementById("filterPanel").style.display="block",document.getElementById("resultsSection").scrollIntoView({behavior:"smooth"})}renderResults(){const e=document.getElementById("resultsGrid"),a=document.getElementById("recentResults"),t=document.getElementById("recentListings"),r=document.getElementById("noResults");if(document.getElementById("resultsCount").textContent=`${this.filteredApartments.length} apartments found`,0===this.filteredApartments.length)return e.innerHTML="",a.innerHTML="",t.style.display="none",void(r.style.display="block");r.style.display="none";const n=new Date(Date.now()-6048e5),o=this.filteredApartments.filter(e=>new Date(e.datePosted)>n),s=this.filteredApartments;o.length>0?(t.style.display="block",a.innerHTML=o.slice(0,6).map(e=>this.createApartmentCard(e,!0)).join("")):t.style.display="none",e.innerHTML=s.map(e=>this.createApartmentCard(e)).join(""),document.querySelectorAll(".apartment-card").forEach(e=>{e.addEventListener("click",()=>{const a=e.dataset.apartmentId,t=this.apartments.find(e=>e.id===a);this.showApartmentDetails(t)})}),document.querySelectorAll(".show-backups-btn").forEach(e=>{e.addEventListener("click",a=>{a.stopPropagation(),this.toggleBackupLinks(e)})}),document.querySelectorAll(".expand-more-backups").forEach(e=>{e.addEventListener("click",a=>{a.stopPropagation(),this.toggleAdditionalBackups(e)})}),setTimeout(()=>{i.refresh()},100)}createApartmentCard(e){const a=e.score>=80?"high":e.score>=60?"medium":"low",t=e.features.slice(0,3).map(a=>`<span class="feature-tag ${e.highlightFeatures?.includes(a)?"highlight":""}">${a}</span>`).join(""),r=this.bookmarkedApartments.includes(e.id);return`\n            <div class="apartment-card fade-in" data-apartment-id="${e.id}">\n                <div class="card-image">\n                    <div class="image-container">\n                        ${e.images&&e.images.length>0?`<img class="property-image" data-src="${e.images[0]}" alt="${e.title}" onerror="this.classList.add('lazy-error')">`:'<div class="no-image-placeholder"><i class="fas fa-image"></i><span>No Image Available</span></div>'}\n                    </div>\n                    <div class="score-badge ${a}">${e.score}</div>\n                    ${r?'<div class="bookmark-indicator"><i class="fas fa-bookmark"></i></div>':""}\n                </div>\n                <div class="card-content">\n                    <h3 class="card-title">${e.title}</h3>\n                    <p class="card-address">\n                        <i class="fas fa-map-marker-alt"></i>\n                        ${e.address}\n                    </p>\n                    \n                    <div class="card-details">\n                        <div class="detail-item">\n                            <i class="fas fa-bed"></i>\n                            ${e.bedrooms} bed\n                        </div>\n                        <div class="detail-item">\n                            <i class="fas fa-bath"></i>\n                            ${e.bathrooms} bath\n                        </div>\n                        <div class="detail-item">\n                            <i class="fas fa-ruler-combined"></i>\n                            ${e.sqft||"N/A"} sq ft\n                        </div>\n                        <div class="detail-item">\n                            <i class="fas fa-building"></i>\n                            Floor ${e.floor||"N/A"}\n                        </div>\n                    </div>\n                    \n                    <div class="card-features">\n                        ${t}\n                        ${e.features.length>3?`<span class="feature-tag">+${e.features.length-3} more</span>`:""}\n                    </div>\n                    \n                    <div class="card-price">$${e.price.toLocaleString()}/month</div>\n                    \n                    <div class="card-actions">\n                        <div class="listing-buttons">\n                            ${this.renderPrimaryListingButton(e)}\n                            ${this.renderBackupOptions(e)}\n                        </div>\n                        <div class="listing-info">\n                            <span class="listing-source">📍 Live data from: <strong>${e.source}</strong></span>\n                            ${e.urlHealthSummary?`\n                                <div class="link-health-indicator ${e.urlHealthSummary.className}">\n                                    <i class="${e.urlHealthSummary.icon}"></i>\n                                    <span class="health-tooltip">${e.urlHealthSummary.message}</span>\n                                </div>\n                            `:""}\n                            <small class="data-freshness">Updated: ${this.formatDatePosted(e.datePosted)}</small>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `}renderPrimaryListingButton(e){const a=e.urlHealth;let t="view-listing-btn primary",r=`View on ${e.source}`,i="fas fa-external-link-alt";return a&&!a.healthy&&(t+=" warning",r=`Try ${e.source}`,i="fas fa-exclamation-triangle"),`\n            <a href="${e.url}" target="_blank" rel="noopener noreferrer" \n               class="${t}" onclick="event.stopPropagation();"\n               title="${a?a.status:"Link status unknown"}">\n                <i class="${i}"></i>\n                ${r}\n            </a>\n        `}renderBackupOptions(e){const a=e.backupUrls||e.alternativeUrls||[];if(0===a.length)return"";const t=a.filter(e=>e.priority<=2).slice(0,3),r=a.filter(e=>e.priority>2);let i="";const n=e.urlHealth&&!e.urlHealth.healthy;return t.length>0&&(i+=`\n                <div class="backup-links" style="display: ${n?"block":"none"};">\n                    ${t.map(e=>`\n                        <a href="${e.url}" target="_blank" rel="noopener noreferrer" \n                           class="view-listing-btn backup ${"search"===e.type?"search":"listing"}" \n                           onclick="event.stopPropagation();"\n                           title="${e.description||e.name}">\n                            <i class="fas fa-${"search"===e.type?"search":"building"}"></i>\n                            ${e.name}\n                        </a>\n                    `).join("")}\n                </div>\n            `),(t.length>0||r.length>0)&&(i+=`\n                <button class="show-backups-btn ${n?"expanded":""}" \n                        onclick="event.stopPropagation();">\n                    <i class="fas fa-chevron-${n?"up":"down"}"></i>\n                    ${n?"Hide Alternatives":"More Options"}\n                </button>\n            `),i}showApartmentDetails(e){const a=document.getElementById("apartmentModal"),t=document.getElementById("modalTitle"),r=document.getElementById("modalBody"),n=document.getElementById("bookmarkBtn");t.textContent=e.title;const o=e.score>=80?"high":e.score>=60?"medium":"low",s=e.images&&e.images.length>0?`<div class="image-gallery">\n                ${e.images.map((e,a)=>`<div class="image-container" style="margin-bottom: 1rem;">\n                        <img class="property-image" \n                             ${0===a?`src="${e}"`:`data-src="${e}"`} \n                             alt="Apartment image" \n                             style="width: 100%; border-radius: 8px;"\n                             onerror="this.classList.add('lazy-error')">\n                    </div>`).join("")}\n            </div>`:'<div class="no-image">No images available</div>';r.innerHTML=`\n            ${s}\n            \n            <div class="apartment-details">\n                <div class="detail-header">\n                    <div class="score-display">\n                        <span class="score-badge ${o}">${e.score}</span>\n                        <span class="score-label">Match Score</span>\n                    </div>\n                    <div class="price-display">\n                        <span class="price">$${e.price.toLocaleString()}</span>\n                        <span class="price-label">per month</span>\n                    </div>\n                </div>\n                \n                <div class="address-section">\n                    <h4><i class="fas fa-map-marker-alt"></i> Address</h4>\n                    <p>${e.address}</p>\n                    <p><strong>Zip Code:</strong> ${e.zipCode}</p>\n                </div>\n                \n                <div class="specs-section">\n                    <h4><i class="fas fa-info-circle"></i> Specifications</h4>\n                    <div class="specs-grid">\n                        <div class="spec-item">\n                            <i class="fas fa-bed"></i>\n                            <span>${e.bedrooms} Bedrooms</span>\n                        </div>\n                        <div class="spec-item">\n                            <i class="fas fa-bath"></i>\n                            <span>${e.bathrooms} Bathrooms</span>\n                        </div>\n                        <div class="spec-item">\n                            <i class="fas fa-ruler-combined"></i>\n                            <span>${e.sqft||"N/A"} sq ft</span>\n                        </div>\n                        <div class="spec-item">\n                            <i class="fas fa-building"></i>\n                            <span>Floor ${e.floor||"N/A"}</span>\n                        </div>\n                    </div>\n                </div>\n                \n                <div class="amenities-section">\n                    <h4><i class="fas fa-star"></i> Amenities & Features</h4>\n                    <div class="amenities-grid">\n                        ${e.features.map(a=>`<div class="amenity-item ${e.highlightFeatures?.includes(a)?"highlight":""}">\n                                <i class="fas fa-check"></i>\n                                ${a}\n                            </div>`).join("")}\n                    </div>\n                </div>\n                \n                ${e.description?`\n                    <div class="description-section">\n                        <h4><i class="fas fa-file-text"></i> Description</h4>\n                        <p>${e.description}</p>\n                    </div>\n                `:""}\n                \n                <div class="listing-url-section">\n                    <h4><i class="fas fa-external-link-alt"></i> View Full Listing</h4>\n                    <div class="url-container">\n                        ${this.renderModalPrimaryButton(e)}\n                        ${this.renderModalHealthStatus(e)}\n                        ${this.renderModalBackupOptions(e)}\n                    </div>\n                </div>\n                \n                <div class="contact-section">\n                    <h4><i class="fas fa-phone"></i> Contact Information</h4>\n                    <p><strong>Phone:</strong> ${e.contact?.phone||"Not available"}</p>\n                    <p><strong>Email:</strong> ${e.contact?.email||"Not available"}</p>\n                    <p><strong>Source:</strong> ${e.source}</p>\n                    <p><strong>Posted:</strong> ${new Date(e.datePosted).toLocaleDateString()}</p>\n                </div>\n            </div>\n        `;const c=this.bookmarkedApartments.includes(e.id);n.innerHTML=c?'<i class="fas fa-bookmark"></i> Bookmarked':'<i class="far fa-bookmark"></i> Bookmark',n.onclick=()=>this.toggleBookmark(e.id),a.style.display="flex",setTimeout(()=>{a.classList.add("show"),i.refresh()},10)}closeModal(){const e=document.getElementById("apartmentModal");e.classList.remove("show"),setTimeout(()=>e.style.display="none",300)}toggleBookmark(e){const a=this.bookmarkedApartments.indexOf(e);a>-1?(this.bookmarkedApartments.splice(a,1),this.showToast("Bookmark removed","warning")):(this.bookmarkedApartments.push(e),this.showToast("Apartment bookmarked!","success")),localStorage.setItem("bookmarkedApartments",JSON.stringify(this.bookmarkedApartments)),this.renderResults();const t=document.getElementById("bookmarkBtn"),r=this.bookmarkedApartments.includes(e);t.innerHTML=r?'<i class="fas fa-bookmark"></i> Bookmarked':'<i class="far fa-bookmark"></i> Bookmark'}loadBookmarks(){console.log(`Loaded ${this.bookmarkedApartments.length} bookmarked apartments`)}exportResults(){if(0===this.filteredApartments.length)return void this.showToast("No results to export","warning");const e=this.filteredApartments.map(e=>({title:e.title,address:e.address,price:e.price,bedrooms:e.bedrooms,bathrooms:e.bathrooms,sqft:e.sqft,score:e.score,features:e.features.join(", "),contact:e.contact?.phone||"",source:e.source,datePosted:e.datePosted})),a=this.convertToCSV(e);this.downloadCSV(a,"apartment-search-results.csv"),this.showToast("Results exported successfully!","success")}convertToCSV(e){return[Object.keys(e[0]).join(","),...e.map(e=>Object.values(e).map(e=>"string"==typeof e&&e.includes(",")?`"${e}"`:e).join(","))].join("\n")}downloadCSV(e,a){const t=new Blob([e],{type:"text/csv"}),r=window.URL.createObjectURL(t),i=document.createElement("a");i.setAttribute("hidden",""),i.setAttribute("href",r),i.setAttribute("download",a),document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(r)}showToast(e,a="success"){const t=document.getElementById("toastContainer"),r=document.createElement("div");r.className=`toast ${a}`,r.innerHTML=`\n            <div class="toast-content">\n                <i class="fas fa-${"success"===a?"check-circle":"error"===a?"exclamation-circle":"exclamation-triangle"}"></i>\n                <span>${e}</span>\n            </div>\n        `,t.appendChild(r),setTimeout(()=>r.classList.add("show"),100),setTimeout(()=>{r.classList.remove("show"),setTimeout(()=>t.removeChild(r),300)},4e3)}renderModalPrimaryButton(e){const a=e.urlHealth;let t="modal-view-listing-btn primary",r=`View on ${e.source}`,i="fas fa-external-link-alt";return a&&!a.healthy&&(t+=" warning",r=`Try ${e.source} (may not work)`,i="fas fa-exclamation-triangle"),`\n            <a href="${e.url}" target="_blank" rel="noopener noreferrer" class="${t}">\n                <i class="${i}"></i>\n                ${r}\n            </a>\n        `}renderModalHealthStatus(e){const a=e.urlHealth,t=e.urlHealthSummary;if(!a||!t)return`<p class="url-disclaimer">Primary listing from ${e.source}. Link status unknown.</p>`;let r="";return r=a.healthy?"cors_accessible"===a.status||"cors_blocked"===a.status?'\n                    <div class="health-status warning">\n                        <i class="fas fa-info-circle"></i>\n                        <span>Link appears to work but cannot be fully verified due to browser security restrictions.</span>\n                    </div>\n                ':`\n                    <div class="health-status healthy">\n                        <i class="fas fa-check-circle"></i>\n                        <span>Link verified and accessible (response: ${a.responseTime}ms)</span>\n                    </div>\n                `:`\n                <div class="health-status error">\n                    <i class="fas fa-exclamation-triangle"></i>\n                    <span>Primary link may not work: ${t.message}. Try alternatives below.</span>\n                </div>\n            `,`${r}<p class="url-disclaimer">Primary listing from ${e.source}.</p>`}renderModalBackupOptions(e){const a=e.backupUrls||e.alternativeUrls||[];if(0===a.length)return"";const t=a.filter(e=>e.priority<=2),r=a.filter(e=>e.priority>2);let i='\n            <div class="backup-options">\n                <h5><i class="fas fa-life-ring"></i> Alternative Search Options</h5>\n        ';return e.urlHealth&&!e.urlHealth.healthy?i+='<p class="backup-info urgent">⚠️ Primary link issue detected. These alternatives are recommended:</p>':i+='<p class="backup-info">If the primary link doesn\'t work, try these alternatives:</p>',t.length>0&&(i+=`\n                <div class="backup-buttons priority">\n                    <h6>Recommended Alternatives:</h6>\n                    ${t.map(e=>`\n                        <a href="${e.url}" target="_blank" rel="noopener noreferrer" \n                           class="modal-view-listing-btn backup ${"search"===e.type?"search":"listing"}"\n                           title="${e.description||e.name}">\n                            <i class="fas fa-${"search"===e.type?"search":"building"}"></i>\n                            ${e.name}\n                            ${e.description?`<small>${e.description}</small>`:""}\n                        </a>\n                    `).join("")}\n                </div>\n            `),r.length>0&&(i+=`\n                <div class="additional-backups">\n                    <button class="expand-more-backups" onclick="event.stopPropagation();">\n                        <i class="fas fa-chevron-down"></i>\n                        Show More Options (${r.length})\n                    </button>\n                    <div class="backup-buttons additional" style="display: none;">\n                        ${r.map(e=>`\n                            <a href="${e.url}" target="_blank" rel="noopener noreferrer" \n                               class="modal-view-listing-btn backup ${e.type}"\n                               title="${e.description||e.name}">\n                                <i class="fas fa-${"search"===e.type?"search":"building"}"></i>\n                                ${e.name}\n                            </a>\n                        `).join("")}\n                    </div>\n                </div>\n            `),i+="</div>",i}toggleBackupLinks(e){const a=e.parentElement.querySelector(".backup-links"),t=e.querySelector("i");if(a){const r="none"!==a.style.display;a.style.display=r?"none":"block";const i=e.childNodes[1];r?(i.textContent=" More Options",t.className="fas fa-chevron-down",e.classList.remove("expanded")):(i.textContent=" Hide Alternatives",t.className="fas fa-chevron-up",e.classList.add("expanded"))}}toggleAdditionalBackups(e){const a=e.parentElement.querySelector(".backup-buttons.additional");if(a){const t="none"!==a.style.display;a.style.display=t?"none":"block",e.innerHTML=t?`<i class="fas fa-chevron-down"></i> Show More Options (${a.children.length})`:'<i class="fas fa-chevron-up"></i> Hide Additional Options'}}formatDatePosted(e){if(!e)return"Unknown";const a=new Date(e),t=new Date,r=Math.abs(t-a),i=Math.ceil(r/864e5);return 1===i?"Today":2===i?"Yesterday":i<=7?i-1+" days ago":a.toLocaleDateString()}}"undefined"!=typeof window&&document.addEventListener("DOMContentLoaded",()=>{new o})}}});
//# sourceMappingURL=index-legacy-BdsJLXqa.js.map
