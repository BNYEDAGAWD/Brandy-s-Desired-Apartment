function e(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();class t{constructor(){this.searchCriteria={minRent:4400,maxRent:5200,bedrooms:2,minBathrooms:1.5,maxBathrooms:2,zipCodes:["90066","90230","90232","90034"],zipCodePriority:{90066:1,90230:2,90232:3,90034:4},requiredAmenities:["washer_dryer","air_conditioning","outdoor_space","above_ground_floor"],preferredFeatures:["recently_renovated","modern_interior","natural_light"]},this.dataSources=[{name:"apartments.com",priority:1,active:!0},{name:"westside_rentals",priority:1,active:!0},{name:"zillow",priority:1,active:!0},{name:"trulia",priority:2,active:!0},{name:"hotpads",priority:2,active:!0},{name:"redfin",priority:2,active:!0},{name:"rentcafe",priority:2,active:!0},{name:"zumper",priority:2,active:!0},{name:"realtor.com",priority:2,active:!0},{name:"craigslist",priority:3,active:!0}]}async searchApartments(e){const t=[],n=this.searchCriteria.zipCodes.length+1;for(let s=0;s<this.searchCriteria.zipCodes.length;s++){const a=this.searchCriteria.zipCodes[s];e&&e(s/n*100);try{const e=await this.searchZipCode(a);t.push(...e),await this.delay(500)}catch(o){console.error("Error searching zip code ".concat(a,":"),o)}}e&&e((n-1)/n*100);const a=t.filter(e=>this.validateApartment(e));return e&&e(100),this.removeDuplicates(a)}async searchZipCode(e){return console.log("Searching zip code: ".concat(e)),this.generateMockApartments(e)}generateMockApartments(e){const t=Math.floor(15*Math.random())+5,n=[],a={90066:{areaName:"Mar Vista",basePrice:4800,priceVariance:300,neighborhoods:["Mar Vista","Venice Adjacent","Westside"]},90230:{areaName:"Culver City",basePrice:4600,priceVariance:400,neighborhoods:["Downtown Culver City","Arts District","Hayden Tract"]},90232:{areaName:"Culver City",basePrice:4500,priceVariance:350,neighborhoods:["Fox Hills","Culver West","Baldwin Hills Adjacent"]},90034:{areaName:"Palms",basePrice:4400,priceVariance:300,neighborhoods:["Palms","Motor Avenue","Mid City West"]}}[e],o=["Pacific Ave","Lincoln Blvd","Venice Blvd","Washington Blvd","Motor Ave","Sepulveda Blvd","Culver Blvd","Jefferson Blvd","Pico Blvd","Olympic Blvd","Exposition Blvd","National Blvd"],s=["Modern Apartment Complex","Luxury Townhome","Contemporary Loft","Garden Style Apartment","Mid-Rise Building","Renovated Complex"],r=["In-Unit Washer/Dryer","Central Air Conditioning","Private Balcony","Stainless Steel Appliances","Hardwood Floors","Walk-in Closet","Granite Countertops","Swimming Pool","Fitness Center","Parking Garage","Pet Friendly","Dishwasher","Recently Renovated","Natural Light","High Ceilings","Modern Kitchen","Patio/Deck","Storage Unit"];for(let i=0;i<t;i++){const t=Math.floor(9999*Math.random())+1e3,c=o[Math.floor(Math.random()*o.length)],l=s[Math.floor(Math.random()*s.length)],d=a.basePrice,m=(Math.random()-.5)*a.priceVariance*2,h=50*Math.round((d+m)/50),u=Math.max(4400,Math.min(5200,h)),p=this.selectRandomAmenities(r,8,12),g=Math.floor(8*Math.random())+2,y=900+Math.floor(400*Math.random()),f=Math.random()>.4?2:1.5,v=(u-4400)/800,w=Math.random()<.3+.4*v,b=Math.floor(30*Math.random()),I=new Date(Date.now()-24*b*60*60*1e3),k={id:"apt_".concat(e,"_").concat(i,"_").concat(Date.now()),title:"".concat(l," in ").concat(a.areaName),address:"".concat(t," ").concat(c,", ").concat(a.areaName,", CA ").concat(e),zipCode:e,price:u,bedrooms:2,bathrooms:f,sqft:y,floor:g,features:p,highlightFeatures:this.getHighlightFeatures(p),recentlyRenovated:w,premiumAmenities:p.includes("Swimming Pool")||p.includes("Fitness Center")||p.includes("Parking Garage"),datePosted:I.toISOString(),source:this.getRandomSource(),url:this.generateListingUrl(l,a.areaName,e,u),contact:{phone:this.generatePhoneNumber(),email:"leasing@".concat(l.toLowerCase().replace(/\s+/g,""),"apartments.com")},images:this.generateMockImages(),description:this.generateDescription(l,a.areaName,p),score:0};n.push(k)}return n}selectRandomAmenities(e,t,n){const a=Math.floor(Math.random()*(n-t+1))+t;return[...e].sort(()=>.5-Math.random()).slice(0,a)}getHighlightFeatures(e){const t=[],n={"In-Unit Washer/Dryer":"In-Unit Washer/Dryer","Central Air Conditioning":"Central Air Conditioning","Private Balcony":"Private Balcony","Recently Renovated":"Recently Renovated","Natural Light":"Natural Light","Modern Kitchen":"Modern Kitchen"};return e.forEach(e=>{n[e]&&t.push(e)}),t}getRandomSource(){const e=["Apartments.com","Westside Rentals","Zillow Rentals","Trulia","HotPads","Redfin","RentCafe","Zumper"];return e[Math.floor(Math.random()*e.length)]}generatePhoneNumber(){const e=["310","424","323"][Math.floor(3*Math.random())],t=Math.floor(900*Math.random())+100,n=Math.floor(9e3*Math.random())+1e3;return"(".concat(e,") ").concat(t,"-").concat(n)}generateListingUrl(e,t,n,a){const o=[{name:"Apartments.com",baseUrl:"https://www.apartments.com",template:(e,t,n,a)=>{const o=Math.floor(.9*a),s=Math.floor(1.1*a),r="".concat(t.replace(/\s+/g,"-"),"-ca");return"".concat(r,"/").concat(n,"/?bb=").concat(o,"-").concat(s,"&t=apartments")}},{name:"Zillow",baseUrl:"https://www.zillow.com",template:(e,t,n,a)=>{const o=Math.floor(.9*a),s=Math.floor(1.1*a);return"homes/for_rent/".concat(n,"_rb/?searchQueryState=%7B%22pagination%22%3A%7B%7D%2C%22usersSearchTerm%22%3A%22").concat(n,"%22%2C%22mapBounds%22%3A%7B%7D%2C%22regionSelection%22%3A%5B%7B%22regionId%22%3A").concat(n,"%2C%22regionType%22%3A7%7D%5D%2C%22isMapVisible%22%3Atrue%2C%22filterState%22%3A%7B%22price%22%3A%7B%22min%22%3A").concat(o,"%2C%22max%22%3A").concat(s,"%7D%2C%22beds%22%3A%7B%22min%22%3A2%7D%2C%22baths%22%3A%7B%22min%22%3A1%7D%7D%2C%22isListVisible%22%3Atrue%7D")}},{name:"Trulia",baseUrl:"https://www.trulia.com",template:(e,t,n,a)=>{const o=Math.floor(.9*a),s=Math.floor(1.1*a),r=t.toLowerCase().replace(/\s+/g,"_");return"for_rent/".concat(r,",ca/").concat(n,"_p/2p_beds/").concat(o,"-").concat(s,"_price/")}},{name:"HotPads",baseUrl:"https://hotpads.com",template:(e,t,n,a)=>{const o=Math.floor(.9*a),s=Math.floor(1.1*a),r=t.toLowerCase().replace(/\s+/g,"-");return"".concat(r,"-ca-").concat(n,"/apartments-for-rent?price=").concat(o,"-").concat(s,"&beds=2")}},{name:"Westside Rentals",baseUrl:"https://www.westsiderentals.com",template:(e,t,n,a)=>{const o=Math.floor(.9*a),s=Math.floor(1.1*a);return"listingsearch?search_form%5Bcity%5D=".concat(encodeURIComponent(t),"&search_form%5Bzipcode%5D=").concat(n,"&search_form%5Bmin_rent%5D=").concat(o,"&search_form%5Bmax_rent%5D=").concat(s,"&search_form%5Bbedrooms%5D=2")}},{name:"Realtor.com",baseUrl:"https://www.realtor.com",template:(e,t,n,a)=>{const o=Math.floor(.9*a),s=Math.floor(1.1*a),r=t.toLowerCase().replace(/\s+/g,"-");return"apartments-for-rent/".concat(r,"-ca-").concat(n,"?price-min=").concat(o,"&price-max=").concat(s,"&beds-min=2")}}],s=o[Math.floor(Math.random()*o.length)],r=s.template(e,t,n,a);return"".concat(s.baseUrl,"/").concat(r)}generateMockImages(){const e=Math.floor(5*Math.random())+1,t=[];for(let n=0;n<e;n++)t.push("https://via.placeholder.com/600x400/f0f0f0/666666?text=Apartment+Image+".concat(n+1));return t}generateDescription(e,t,n){const a=["Beautiful ".concat(e.toLowerCase()," located in the heart of ").concat(t,". This stunning 2-bedroom unit features modern finishes and premium amenities."),"Discover luxury living in this ".concat(e.toLowerCase()," in ").concat(t,". Perfectly designed for comfort and style."),"Spacious and bright 2-bedroom apartment in a desirable ".concat(t," location. This ").concat(e.toLowerCase()," offers the perfect blend of comfort and convenience.")],o=a[Math.floor(Math.random()*a.length)],s=n.slice(0,4).join(", ");return"".concat(o," Key features include: ").concat(s,". Contact us today to schedule a viewing!")}removeDuplicates(e){const t=new Set;return e.filter(e=>{const n="".concat(e.address,"_").concat(e.price,"_").concat(e.bedrooms);return!t.has(n)&&(t.add(n),!0)})}delay(e){return new Promise(t=>setTimeout(t,e))}validateApartment(e){const t=this.searchCriteria;if(e.price<t.minRent||e.price>t.maxRent)return!1;if(e.bedrooms!==t.bedrooms)return!1;if(e.bathrooms<t.minBathrooms||e.bathrooms>t.maxBathrooms)return!1;const n=e.features.map(e=>e.toLowerCase()),a=n.some(e=>e.includes("washer")&&e.includes("dryer")),o=n.some(e=>e.includes("air")||e.includes("conditioning")),s=n.some(e=>e.includes("balcony")||e.includes("patio")||e.includes("deck")),r=e.floor>1;return!!(a&&o&&s&&r)}}class n{constructor(){this.weights={rentInRange:20,mandatoryAmenities:30,renovationRecency:25,naturalLight:15,outdoorSpaceQuality:10,zipCodePriority:10,premiumAmenities:5,locationRating:5,professionalPhotos:3,floorLevel:2},this.maxScore=100}calculateScore(e,t={minRent:4400,maxRent:5200,zipCodePriority:{90066:1,90230:2,90232:3,90034:4}}){let n=0;n+=this.calculateRentScore(e.price,t);n+=this.calculateMandatoryAmenityScore(e);n+=this.calculateRenovationScore(e);n+=this.calculateNaturalLightScore(e);n+=this.calculateOutdoorSpaceScore(e);n+=this.calculateZipCodeScore(e.zipCode,t);n+=this.calculatePremiumAmenitiesScore(e);n+=this.calculateLocationRatingScore(e);n+=this.calculatePhotoScore(e);return n+=this.calculateFloorScore(e),Math.round(Math.min(n,this.maxScore))}getScoreBreakdown(e,t={minRent:4400,maxRent:5200,zipCodePriority:{90066:1,90230:2,90232:3,90034:4}}){const n={};return n.price=this.calculateRentScore(e.price,t),n.specs=this.calculateMandatoryAmenityScore(e),n.floor=this.calculateFloorScore(e),n.features=this.calculateRenovationScore(e)+this.calculateNaturalLightScore(e)+this.calculateOutdoorSpaceScore(e),n.renovation=e.recentlyRenovated?10:0,n.total=Math.min(n.price+n.specs+n.floor+n.features+n.renovation,100),n}calculateRentScore(e,t){const{minRent:n,maxRent:a}=t;if(e<n||e>a)return 0;const o=(n+a)/2,s=(a-n)/2,r=Math.abs(e-o),i=this.weights.rentInRange*(1-r/s);return Math.round(i)}calculateMandatoryAmenityScore(e){const t={washerDryer:!1,airConditioning:!1,outdoorSpace:!1,aboveGroundFloor:!1},n=e.features.map(e=>e.toLowerCase());t.washerDryer=n.some(e=>e.includes("washer")&&e.includes("dryer")||e.includes("w/d")||e.includes("laundry")),t.airConditioning=n.some(e=>e.includes("air")||e.includes("conditioning")||e.includes("hvac")||e.includes("central air")),t.outdoorSpace=n.some(e=>e.includes("balcony")||e.includes("patio")||e.includes("terrace")||e.includes("deck")||e.includes("outdoor")),t.aboveGroundFloor=e.floor>1;const a=Object.values(t).filter(Boolean).length/Object.keys(t).length;return Math.round(this.weights.mandatoryAmenities*a)}calculateRenovationScore(e){const t=e.features.map(e=>e.toLowerCase()),n=["renovated","updated","remodeled","modern","new","contemporary","upgraded","refreshed","redesigned"],a=t.some(e=>n.some(t=>e.includes(t))),o=e.recentlyRenovated||!1,s=["stainless steel","granite","quartz","hardwood","modern kitchen","designer","luxury"],r=t.some(e=>s.some(t=>e.includes(t)));let i=0;return i=o?this.weights.renovationRecency:a&&r?.8*this.weights.renovationRecency:a||r?.5*this.weights.renovationRecency:.2*this.weights.renovationRecency,Math.round(i)}calculateNaturalLightScore(e){var t;const n=e.features.map(e=>e.toLowerCase()),a=(null==(t=e.description)?void 0:t.toLowerCase())||"",o=["natural light","bright","sunny","light-filled","windows","large windows","floor-to-ceiling","multiple exposures","corner unit"],s=n.concat([a]).some(e=>o.some(t=>e.includes(t))),r=e.floor>5?.2:0;let i=0;return i=s?this.weights.naturalLight*(.8+r):this.weights.naturalLight*(.4+r),Math.round(i)}calculateOutdoorSpaceScore(e){const t=e.features.map(e=>e.toLowerCase()),n={"private balcony":1,terrace:1,"private patio":.9,deck:.8,balcony:.7,patio:.6,outdoor:.5};let a=0;for(const[o,s]of Object.entries(n))t.some(e=>e.includes(o))&&(a=Math.max(a,this.weights.outdoorSpaceQuality*s));return Math.round(a)}calculateZipCodeScore(e,t){const n=t.zipCodePriority[e]||5,a=Math.max(0,(5-n)/4);return Math.round(this.weights.zipCodePriority*a)}calculatePremiumAmenitiesScore(e){const t=e.features.map(e=>e.toLowerCase()),n=["swimming pool","fitness center","gym","concierge","doorman","roof deck","rooftop","parking garage","valet parking","business center","club room"],a=t.filter(e=>n.some(t=>e.includes(t))).length,o=Math.min(1.5*a,this.weights.premiumAmenities);return Math.round(o)}calculateLocationRatingScore(e){const t={90066:4.5,90230:4.2,90232:3.8,90034:3.5}[e.zipCode]||3,n=e.price>4800?.2:0,a=Math.min(t+n,5),o=Math.max(0,(a-3)/2);return Math.round(this.weights.locationRating*o)}calculatePhotoScore(e){var t;const n=(null==(t=e.images)?void 0:t.length)||0;return n>=5?this.weights.professionalPhotos:n>=3?Math.round(.7*this.weights.professionalPhotos):n>=1?Math.round(.4*this.weights.professionalPhotos):0}calculateFloorScore(e){const t=e.floor||2;return t>=3&&t<=6?this.weights.floorLevel:2===t||7===t||8===t?Math.round(.7*this.weights.floorLevel):t>8?Math.round(.5*this.weights.floorLevel):0}}new class{constructor(){this.modal=null,this.toastContainer=null,this.init()}init(){this.modal=document.getElementById("apartmentModal"),this.toastContainer=document.getElementById("toastContainer"),this.bindGlobalEvents()}bindGlobalEvents(){document.addEventListener("keydown",e=>{if("Escape"===e.key&&this.modal&&this.modal.classList.contains("show")&&this.closeModal(),e.ctrlKey&&"f"===e.key){e.preventDefault();const t=document.getElementById("searchBtn");t&&"none"!==t.style.display&&t.focus()}}),window.addEventListener("resize",this.debounce(()=>{this.adjustLayoutForViewport()},250)),window.addEventListener("scroll",this.throttle(()=>{this.handleScroll()},100))}showModal(e,t="Details"){if(!this.modal)return;const n=this.modal.querySelector("#modalTitle"),a=this.modal.querySelector("#modalBody");n&&(n.textContent=t),a&&(a.innerHTML=e),this.modal.style.display="flex",setTimeout(()=>{this.modal.classList.add("show"),this.trapFocus(this.modal)},10),document.body.style.overflow="hidden"}closeModal(){this.modal&&(this.modal.classList.remove("show"),setTimeout(()=>{this.modal.style.display="none",document.body.style.overflow=""},300))}showToast(e,t="info",n=4e3,a=null){if(!this.toastContainer)return;const o=document.createElement("div");o.className="toast ".concat(t);const s={success:"fa-check-circle",error:"fa-exclamation-circle",warning:"fa-exclamation-triangle",info:"fa-info-circle"},r=s[t]||s.info;let i="";a&&a.length>0&&(i='\n                <div class="toast-actions">\n                    '.concat(a.map(e=>'<button class="toast-action" data-action="'.concat(e.id,'">').concat(e.label,"</button>")).join(""),"\n                </div>\n            ")),o.innerHTML='\n            <div class="toast-content">\n                <div class="toast-icon">\n                    <i class="fas '.concat(r,'"></i>\n                </div>\n                <div class="toast-message">\n                    <span>').concat(e,"</span>\n                    ").concat(i,'\n                </div>\n                <button class="toast-close">\n                    <i class="fas fa-times"></i>\n                </button>\n            </div>\n        ');return o.querySelector(".toast-close").addEventListener("click",()=>this.removeToast(o)),a&&o.querySelectorAll(".toast-action").forEach(e=>{e.addEventListener("click",e=>{const t=e.target.dataset.action,n=a.find(e=>e.id===t);n&&n.callback&&n.callback(),this.removeToast(o)})}),this.toastContainer.appendChild(o),setTimeout(()=>o.classList.add("show"),100),n>0&&setTimeout(()=>this.removeToast(o),n),o}removeToast(e){e&&e.parentNode&&(e.classList.remove("show"),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},300))}showLoadingSpinner(e,t="Loading..."){if(!e)return;const n=document.createElement("div");return n.className="loading-overlay",n.innerHTML='\n            <div class="spinner-container">\n                <div class="spinner"></div>\n                <span class="loading-text">'.concat(t,"</span>\n            </div>\n        "),e.style.position="relative",e.appendChild(n),n}hideLoadingSpinner(e){if(!e)return;const t=e.querySelector(".loading-overlay");t&&t.remove()}adjustLayoutForViewport(){const e=this.getViewportSize(),t=document.querySelector(".results-grid");if(t&&(e.width<768?t.style.gridTemplateColumns="1fr":e.width<1200?t.style.gridTemplateColumns="repeat(2, 1fr)":t.style.gridTemplateColumns="repeat(3, 1fr)"),this.modal){const t=this.modal.querySelector(".modal-content");t&&(e.width<768?(t.style.margin="1rem",t.style.maxHeight="calc(100vh - 2rem)"):(t.style.margin="2rem",t.style.maxHeight="90vh"))}}getViewportSize(){return{width:window.innerWidth,height:window.innerHeight}}handleScroll(){const e=window.scrollY,t=document.querySelector(".header");t&&(e>50?t.classList.add("scrolled"):t.classList.remove("scrolled")),this.toggleBackToTop(e>300)}toggleBackToTop(e){let t=document.getElementById("backToTop");e&&!t&&(t=document.createElement("button"),t.id="backToTop",t.className="back-to-top",t.innerHTML='<i class="fas fa-chevron-up"></i>',t.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})}),document.body.appendChild(t)),t&&(t.style.display=e?"block":"none")}trapFocus(e){const t=e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),n=t[0],a=t[t.length-1];n&&n.focus(),e.addEventListener("keydown",e=>{"Tab"===e.key&&(e.shiftKey?document.activeElement===n&&(e.preventDefault(),a.focus()):document.activeElement===a&&(e.preventDefault(),n.focus()))})}fadeIn(e,t=300){e.style.opacity="0",e.style.display="block";let n=null;const a=o=>{n||(n=o);const s=(o-n)/t;e.style.opacity=Math.min(s,1),s<1&&requestAnimationFrame(a)};requestAnimationFrame(a)}fadeOut(e,t=300){let n=null;const a=o=>{n||(n=o);const s=(o-n)/t;e.style.opacity=1-Math.min(s,1),s>=1?e.style.display="none":requestAnimationFrame(a)};requestAnimationFrame(a)}slideDown(e,t=300){e.style.height="0",e.style.overflow="hidden",e.style.display="block";const n=e.scrollHeight;let a=null;const o=s=>{a||(a=s);const r=(s-a)/t;e.style.height="".concat(n*Math.min(r,1),"px"),r>=1?(e.style.height="",e.style.overflow=""):requestAnimationFrame(o)};requestAnimationFrame(o)}slideUp(e,t=300){const n=e.offsetHeight;let a=null;const o=s=>{a||(a=s);const r=(s-a)/t;e.style.height="".concat(n*(1-Math.min(r,1)),"px"),e.style.overflow="hidden",r>=1?(e.style.display="none",e.style.height="",e.style.overflow=""):requestAnimationFrame(o)};requestAnimationFrame(o)}debounce(e,t){let n;return function(...a){clearTimeout(n),n=setTimeout(()=>{clearTimeout(n),e(...a)},t)}}throttle(e,t){let n;return function(...a){n||(e.apply(this,a),n=!0,setTimeout(()=>n=!1,t))}}formatPrice(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}formatDate(e){return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(new Date(e))}formatPhoneNumber(e){const t=e.replace(/\D/g,"").match(/^(\d{3})(\d{3})(\d{4})$/);return t?"(".concat(t[1],") ").concat(t[2],"-").concat(t[3]):e}isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}isValidPhone(e){return 10===e.replace(/\D/g,"").length}saveToStorage(e,t){try{return localStorage.setItem(e,JSON.stringify(t)),!0}catch(n){return console.error("Error saving to localStorage:",n),!1}}loadFromStorage(e,t=null){try{const n=localStorage.getItem(e);return n?JSON.parse(n):t}catch(n){return console.error("Error loading from localStorage:",n),t}}removeFromStorage(e){try{return localStorage.removeItem(e),!0}catch(t){return console.error("Error removing from localStorage:",t),!1}}};const a=new class{constructor(e={}){this.options={rootMargin:"50px",threshold:.1,placeholderSrc:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9ImciIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPjxzdG9wIG9mZnNldD0iMCUiIHN0b3AtY29sb3I9IiNmNWY1ZjUiLz48c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiNlZWVlZWUiLz48L2xpbmVhckdyYWRpZW50PjwvZGVmcz48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ1cmwoI2cpIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNHB4IiBmaWxsPSIjOTk5OTk5IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIj5Mb2FkaW5nLi4uPC90ZXh0Pjwvc3ZnPg==",errorSrc:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjVmNWY1Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNHB4IiBmaWxsPSIjOTk5OTk5IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIj5JbWFnZSBVbmF2YWlsYWJsZTwvdGV4dD48L3N2Zz4=",fadeInDuration:300,retryAttempts:2,retryDelay:1e3,...e},this.observer=null,this.loadedImages=new Set,this.failedImages=new Set,this.retryCount=new Map,this.init()}init(){"IntersectionObserver"in window?(this.observer=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&this.loadImage(e.target)})},{rootMargin:this.options.rootMargin,threshold:this.options.threshold}),this.observeImages()):this.loadAllImages()}observeImages(){document.querySelectorAll("img[data-src]").forEach(e=>{this.loadedImages.has(e)||(this.setupImageForLazyLoading(e),this.observer.observe(e))})}setupImageForLazyLoading(e){e.src&&""!==e.src||(e.src=this.options.placeholderSrc),e.classList.add("lazy-loading"),this.addLoadingIndicator(e),e.style.opacity="0",e.style.transition="opacity ".concat(this.options.fadeInDuration,"ms ease-in-out")}addLoadingIndicator(e){const t=e.parentElement;if(!t.classList.contains("image-container")){const t=document.createElement("div");t.className="image-container",e.parentNode.insertBefore(t,e),t.appendChild(e)}if(!t.querySelector(".loading-indicator")){const e=document.createElement("div");e.className="loading-indicator",e.innerHTML='\n                <div class="loading-spinner">\n                    <div class="spinner"></div>\n                </div>\n            ',t.appendChild(e)}}async loadImage(e){const t=e.getAttribute("data-src");if(t&&!this.loadedImages.has(e))try{this.observer&&this.observer.unobserve(e),await this.preloadImage(t),e.src=t,e.removeAttribute("data-src"),e.classList.remove("lazy-loading"),e.classList.add("lazy-loaded"),e.style.opacity="1",this.removeLoadingIndicator(e),this.loadedImages.add(e),e.dispatchEvent(new CustomEvent("lazyLoaded",{detail:{src:t,img:e}}))}catch(n){console.warn("Failed to load image:",t,n),await this.handleImageError(e,t)}}preloadImage(e){return new Promise((t,n)=>{const a=new Image;a.onload=()=>t(a),a.onerror=()=>n(new Error("Failed to load image: ".concat(e))),setTimeout(()=>{n(new Error("Image load timeout: ".concat(e)))},1e4),a.src=e})}async handleImageError(e,t){const n=t,a=this.retryCount.get(n)||0;if(a<this.options.retryAttempts){this.retryCount.set(n,a+1),await new Promise(e=>setTimeout(e,this.options.retryDelay));try{return await this.preloadImage(t),e.src=t,e.removeAttribute("data-src"),e.classList.remove("lazy-loading"),e.classList.add("lazy-loaded"),e.style.opacity="1",this.removeLoadingIndicator(e),void this.loadedImages.add(e)}catch(o){console.warn("Retry ".concat(a+1," failed for image:"),t)}}e.src=this.options.errorSrc,e.classList.remove("lazy-loading"),e.classList.add("lazy-error"),e.style.opacity="1",this.removeLoadingIndicator(e),this.failedImages.add(e),e.dispatchEvent(new CustomEvent("lazyLoadError",{detail:{originalSrc:t,img:e}}))}removeLoadingIndicator(e){const t=e.parentElement.querySelector(".loading-indicator");t&&(t.classList.add("fade-out"),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},200))}loadAllImages(){document.querySelectorAll("img[data-src]").forEach(e=>{this.setupImageForLazyLoading(e),this.loadImage(e)})}refresh(){this.observer&&this.observeImages()}observe(e){if(!this.observer)return;(Array.isArray(e)?e:[e]).forEach(e=>{"IMG"===e.tagName&&e.hasAttribute("data-src")&&(this.setupImageForLazyLoading(e),this.observer.observe(e))})}loadImagesInContainer(e){e.querySelectorAll("img[data-src]").forEach(e=>this.loadImage(e))}getStats(){return{loaded:this.loadedImages.size,failed:this.failedImages.size,pending:document.querySelectorAll("img[data-src]").length}}destroy(){this.observer&&(this.observer.disconnect(),this.observer=null),this.loadedImages.clear(),this.failedImages.clear(),this.retryCount.clear()}};"undefined"!=typeof window&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{a.refresh()}):a.refresh());class o{constructor(){this.apartments=[],this.filteredApartments=[],this.bookmarkedApartments=JSON.parse(localStorage.getItem("bookmarkedApartments")||"[]"),this.isSearching=!1,this.init()}init(){this.bindEvents(),this.loadBookmarks(),console.log("Apartment Finder App initialized")}bindEvents(){document.getElementById("searchBtn").addEventListener("click",()=>this.startSearch());document.getElementById("sortBy").addEventListener("change",()=>this.applyFilters());document.getElementById("minScore").addEventListener("input",e=>{document.getElementById("minScoreValue").textContent=e.target.value,this.applyFilters()}),["recentOnly","renovatedOnly","premiumOnly"].forEach(e=>{document.getElementById(e).addEventListener("change",()=>this.applyFilters())});const e=document.getElementById("toggleFilters"),t=document.querySelector(".filter-content");e.addEventListener("click",()=>{const n="none"!==t.style.display;t.style.display=n?"none":"block",e.innerHTML=n?'<i class="fas fa-chevron-down"></i>':'<i class="fas fa-chevron-up"></i>'});const n=document.getElementById("apartmentModal");document.getElementById("closeModal").addEventListener("click",()=>this.closeModal()),n.addEventListener("click",e=>{e.target===n&&this.closeModal()});document.getElementById("exportBtn").addEventListener("click",()=>this.exportResults()),document.addEventListener("keydown",e=>{"Escape"===e.key&&"none"!==n.style.display&&this.closeModal(),"Enter"===e.key&&e.ctrlKey&&!this.isSearching&&this.startSearch()})}async startSearch(){if(!this.isSearching){this.isSearching=!0,this.showLoadingState();try{const e=new t,a=new n,o=await e.searchApartments(e=>{this.updateProgress(e)});this.apartments=o.map(e=>({...e,score:a.calculateScore(e),scoreBreakdown:a.getScoreBreakdown(e)})),this.applyFilters(),this.showResults()}catch(e){console.error("Search failed:",e),this.showToast("Search failed. Please try again.","error")}finally{this.isSearching=!1,this.hideLoadingState()}}}showLoadingState(){const e=document.getElementById("searchBtn"),t=document.getElementById("loadingIndicator");e.style.display="none",t.style.display="block",document.getElementById("resultsSection").style.display="none",document.getElementById("filterPanel").style.display="none"}hideLoadingState(){const e=document.getElementById("searchBtn"),t=document.getElementById("loadingIndicator");e.style.display="inline-block",t.style.display="none"}updateProgress(e){const t=Math.min(Math.floor(e/25),3);["step1","step2","step3","step4"].forEach((e,n)=>{const a=document.getElementById(e);a.className=n<t?"step completed":n===t?"step active":"step"})}applyFilters(){if(!this.apartments.length)return;let e=[...this.apartments];const t=parseInt(document.getElementById("minScore").value);if(e=e.filter(e=>e.score>=t),document.getElementById("recentOnly").checked){const t=new Date(Date.now()-6048e5);e=e.filter(e=>new Date(e.datePosted)>t)}document.getElementById("renovatedOnly").checked&&(e=e.filter(e=>e.recentlyRenovated)),document.getElementById("premiumOnly").checked&&(e=e.filter(e=>e.premiumAmenities));const n=document.getElementById("sortBy").value;e.sort((e,t)=>{switch(n){case"score":default:return t.score-e.score;case"price-low":return e.price-t.price;case"price-high":return t.price-e.price;case"newest":return new Date(t.datePosted)-new Date(e.datePosted)}}),this.filteredApartments=e,this.renderResults()}showResults(){document.getElementById("resultsSection").style.display="block",document.getElementById("filterPanel").style.display="block",document.getElementById("resultsSection").scrollIntoView({behavior:"smooth"})}renderResults(){const e=document.getElementById("resultsGrid"),t=document.getElementById("recentResults"),n=document.getElementById("recentListings"),o=document.getElementById("noResults");if(document.getElementById("resultsCount").textContent="".concat(this.filteredApartments.length," apartments found"),0===this.filteredApartments.length)return e.innerHTML="",t.innerHTML="",n.style.display="none",void(o.style.display="block");o.style.display="none";const s=new Date(Date.now()-6048e5),r=this.filteredApartments.filter(e=>new Date(e.datePosted)>s),i=this.filteredApartments;r.length>0?(n.style.display="block",t.innerHTML=r.slice(0,6).map(e=>this.createApartmentCard(e,!0)).join("")):n.style.display="none",e.innerHTML=i.map(e=>this.createApartmentCard(e)).join(""),document.querySelectorAll(".apartment-card").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.apartmentId,n=this.apartments.find(e=>e.id===t);this.showApartmentDetails(n)})}),setTimeout(()=>{a.refresh()},100)}createApartmentCard(e,t=!1){const n=e.score>=80?"high":e.score>=60?"medium":"low",a=e.features.slice(0,3).map(t=>{var n;return'<span class="feature-tag '.concat((null==(n=e.highlightFeatures)?void 0:n.includes(t))?"highlight":"",'">').concat(t,"</span>")}).join(""),o=this.bookmarkedApartments.includes(e.id);return'\n            <div class="apartment-card fade-in" data-apartment-id="'.concat(e.id,'">\n                <div class="card-image">\n                    <div class="image-container">\n                        ').concat(e.images&&e.images.length>0?'<img class="property-image" data-src="'.concat(e.images[0],'" alt="').concat(e.title,'" onerror="this.classList.add(\'lazy-error\')">'):'<div class="no-image-placeholder"><i class="fas fa-image"></i><span>No Image Available</span></div>','\n                    </div>\n                    <div class="score-badge ').concat(n,'">').concat(e.score,"</div>\n                    ").concat(o?'<div class="bookmark-indicator"><i class="fas fa-bookmark"></i></div>':"",'\n                </div>\n                <div class="card-content">\n                    <h3 class="card-title">').concat(e.title,'</h3>\n                    <p class="card-address">\n                        <i class="fas fa-map-marker-alt"></i>\n                        ').concat(e.address,'\n                    </p>\n                    \n                    <div class="card-details">\n                        <div class="detail-item">\n                            <i class="fas fa-bed"></i>\n                            ').concat(e.bedrooms,' bed\n                        </div>\n                        <div class="detail-item">\n                            <i class="fas fa-bath"></i>\n                            ').concat(e.bathrooms,' bath\n                        </div>\n                        <div class="detail-item">\n                            <i class="fas fa-ruler-combined"></i>\n                            ').concat(e.sqft||"N/A",' sq ft\n                        </div>\n                        <div class="detail-item">\n                            <i class="fas fa-building"></i>\n                            Floor ').concat(e.floor||"N/A",'\n                        </div>\n                    </div>\n                    \n                    <div class="card-features">\n                        ').concat(a,"\n                        ").concat(e.features.length>3?'<span class="feature-tag">+'.concat(e.features.length-3," more</span>"):"",'\n                    </div>\n                    \n                    <div class="card-price">$').concat(e.price.toLocaleString(),'/month</div>\n                    \n                    <div class="card-actions">\n                        <a href="').concat(e.url,'" target="_blank" rel="noopener noreferrer" class="view-listing-btn" onclick="event.stopPropagation();">\n                            <i class="fas fa-external-link-alt"></i>\n                            View Listing\n                        </a>\n                        <span class="listing-source">via ').concat(e.source,"</span>\n                    </div>\n                </div>\n            </div>\n        ")}showApartmentDetails(e){var t,n;const o=document.getElementById("apartmentModal"),s=document.getElementById("modalTitle"),r=document.getElementById("modalBody"),i=document.getElementById("bookmarkBtn");s.textContent=e.title;const c=e.score>=80?"high":e.score>=60?"medium":"low",l=e.images&&e.images.length>0?'<div class="image-gallery">\n                '.concat(e.images.map((e,t)=>'<div class="image-container" style="margin-bottom: 1rem;">\n                        <img class="property-image" \n                             '.concat(0===t?'src="'.concat(e,'"'):'data-src="'.concat(e,'"'),' \n                             alt="Apartment image" \n                             style="width: 100%; border-radius: 8px;"\n                             onerror="this.classList.add(\'lazy-error\')">\n                    </div>')).join(""),"\n            </div>"):'<div class="no-image">No images available</div>';r.innerHTML="\n            ".concat(l,'\n            \n            <div class="apartment-details">\n                <div class="detail-header">\n                    <div class="score-display">\n                        <span class="score-badge ').concat(c,'">').concat(e.score,'</span>\n                        <span class="score-label">Match Score</span>\n                    </div>\n                    <div class="price-display">\n                        <span class="price">$').concat(e.price.toLocaleString(),'</span>\n                        <span class="price-label">per month</span>\n                    </div>\n                </div>\n                \n                <div class="address-section">\n                    <h4><i class="fas fa-map-marker-alt"></i> Address</h4>\n                    <p>').concat(e.address,"</p>\n                    <p><strong>Zip Code:</strong> ").concat(e.zipCode,'</p>\n                </div>\n                \n                <div class="specs-section">\n                    <h4><i class="fas fa-info-circle"></i> Specifications</h4>\n                    <div class="specs-grid">\n                        <div class="spec-item">\n                            <i class="fas fa-bed"></i>\n                            <span>').concat(e.bedrooms,' Bedrooms</span>\n                        </div>\n                        <div class="spec-item">\n                            <i class="fas fa-bath"></i>\n                            <span>').concat(e.bathrooms,' Bathrooms</span>\n                        </div>\n                        <div class="spec-item">\n                            <i class="fas fa-ruler-combined"></i>\n                            <span>').concat(e.sqft||"N/A",' sq ft</span>\n                        </div>\n                        <div class="spec-item">\n                            <i class="fas fa-building"></i>\n                            <span>Floor ').concat(e.floor||"N/A",'</span>\n                        </div>\n                    </div>\n                </div>\n                \n                <div class="amenities-section">\n                    <h4><i class="fas fa-star"></i> Amenities & Features</h4>\n                    <div class="amenities-grid">\n                        ').concat(e.features.map(t=>{var n;return'<div class="amenity-item '.concat((null==(n=e.highlightFeatures)?void 0:n.includes(t))?"highlight":"",'">\n                                <i class="fas fa-check"></i>\n                                ').concat(t,"\n                            </div>")}).join(""),"\n                    </div>\n                </div>\n                \n                ").concat(e.description?'\n                    <div class="description-section">\n                        <h4><i class="fas fa-file-text"></i> Description</h4>\n                        <p>'.concat(e.description,"</p>\n                    </div>\n                "):"",'\n                \n                <div class="listing-url-section">\n                    <h4><i class="fas fa-external-link-alt"></i> View Full Listing</h4>\n                    <div class="url-container">\n                        <a href="').concat(e.url,'" target="_blank" rel="noopener noreferrer" class="modal-view-listing-btn">\n                            <i class="fas fa-external-link-alt"></i>\n                            View on ').concat(e.source,'\n                        </a>\n                        <p class="url-disclaimer">Opens in a new tab. Listing provided by ').concat(e.source,'.</p>\n                    </div>\n                </div>\n                \n                <div class="contact-section">\n                    <h4><i class="fas fa-phone"></i> Contact Information</h4>\n                    <p><strong>Phone:</strong> ').concat((null==(t=e.contact)?void 0:t.phone)||"Not available","</p>\n                    <p><strong>Email:</strong> ").concat((null==(n=e.contact)?void 0:n.email)||"Not available","</p>\n                    <p><strong>Source:</strong> ").concat(e.source,"</p>\n                    <p><strong>Posted:</strong> ").concat(new Date(e.datePosted).toLocaleDateString(),"</p>\n                </div>\n            </div>\n        ");const d=this.bookmarkedApartments.includes(e.id);i.innerHTML=d?'<i class="fas fa-bookmark"></i> Bookmarked':'<i class="far fa-bookmark"></i> Bookmark',i.onclick=()=>this.toggleBookmark(e.id),o.style.display="flex",setTimeout(()=>{o.classList.add("show"),a.refresh()},10)}closeModal(){const e=document.getElementById("apartmentModal");e.classList.remove("show"),setTimeout(()=>e.style.display="none",300)}toggleBookmark(e){const t=this.bookmarkedApartments.indexOf(e);t>-1?(this.bookmarkedApartments.splice(t,1),this.showToast("Bookmark removed","warning")):(this.bookmarkedApartments.push(e),this.showToast("Apartment bookmarked!","success")),localStorage.setItem("bookmarkedApartments",JSON.stringify(this.bookmarkedApartments)),this.renderResults();const n=document.getElementById("bookmarkBtn"),a=this.bookmarkedApartments.includes(e);n.innerHTML=a?'<i class="fas fa-bookmark"></i> Bookmarked':'<i class="far fa-bookmark"></i> Bookmark'}loadBookmarks(){console.log("Loaded ".concat(this.bookmarkedApartments.length," bookmarked apartments"))}exportResults(){if(0===this.filteredApartments.length)return void this.showToast("No results to export","warning");const e=this.filteredApartments.map(e=>{var t;return{title:e.title,address:e.address,price:e.price,bedrooms:e.bedrooms,bathrooms:e.bathrooms,sqft:e.sqft,score:e.score,features:e.features.join(", "),contact:(null==(t=e.contact)?void 0:t.phone)||"",source:e.source,datePosted:e.datePosted}}),t=this.convertToCSV(e);this.downloadCSV(t,"apartment-search-results.csv"),this.showToast("Results exported successfully!","success")}convertToCSV(e){return[Object.keys(e[0]).join(","),...e.map(e=>Object.values(e).map(e=>"string"==typeof e&&e.includes(",")?'"'.concat(e,'"'):e).join(","))].join("\n")}downloadCSV(e,t){const n=new Blob([e],{type:"text/csv"}),a=window.URL.createObjectURL(n),o=document.createElement("a");o.setAttribute("hidden",""),o.setAttribute("href",a),o.setAttribute("download",t),document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(a)}showToast(e,t="success"){const n=document.getElementById("toastContainer"),a=document.createElement("div");a.className="toast ".concat(t),a.innerHTML='\n            <div class="toast-content">\n                <i class="fas fa-'.concat("success"===t?"check-circle":"error"===t?"exclamation-circle":"exclamation-triangle",'"></i>\n                <span>').concat(e,"</span>\n            </div>\n        "),n.appendChild(a),setTimeout(()=>a.classList.add("show"),100),setTimeout(()=>{a.classList.remove("show"),setTimeout(()=>n.removeChild(a),300)},4e3)}}"undefined"!=typeof window&&document.addEventListener("DOMContentLoaded",()=>{new o});new class{constructor(){this.apiKey=null,this.baseURL="https://api.anthropic.com/v1/messages",this.model="claude-3-sonnet-20240229",this.maxTokens=1e3,this.init()}init(){this.apiKey=localStorage.getItem("claude_api_key"),this.apiKey||this.showAPIKeySetup()}showAPIKeySetup(){if(document.getElementById("apiKeySetup"))return;const e=document.createElement("div");e.id="apiKeySetup",e.className="api-key-setup",e.innerHTML='\n            <div class="setup-content">\n                <h3><i class="fas fa-key"></i> API Configuration</h3>\n                <p>To enable Claude AI enhanced search features, please enter your Anthropic API key:</p>\n                <div class="input-group">\n                    <input type="password" id="apiKeyInput" placeholder="sk-ant-api..." />\n                    <button id="saveApiKey" class="btn-primary">Save</button>\n                </div>\n                <div class="setup-info">\n                    <p><small>\n                        <i class="fas fa-info-circle"></i>\n                        Your API key is stored locally and never shared. \n                        <a href="https://console.anthropic.com/" target="_blank">Get your API key here</a>\n                    </small></p>\n                </div>\n                <button id="skipApiKey" class="btn-secondary">Skip (Use Mock Data)</button>\n            </div>\n        ',document.body.appendChild(e),document.getElementById("saveApiKey").addEventListener("click",()=>{const t=document.getElementById("apiKeyInput").value.trim();t&&(this.setAPIKey(t),e.remove())}),document.getElementById("skipApiKey").addEventListener("click",()=>{e.remove()}),document.getElementById("apiKeyInput").addEventListener("keypress",e=>{"Enter"===e.key&&document.getElementById("saveApiKey").click()})}setAPIKey(e){this.apiKey=e,localStorage.setItem("claude_api_key",e),console.log("Claude API key configured")}async enhanceApartmentDescriptions(e){if(!this.apiKey||0===e.length)return e;try{const t=this.buildDescriptionEnhancementPrompt(e),n=await this.callClaudeAPI(t);if(n&&n.enhanced_descriptions)return this.applyEnhancedDescriptions(e,n.enhanced_descriptions)}catch(t){console.error("Error enhancing descriptions:",t)}return e}async generateSearchInsights(e){if(!this.apiKey||0===e.length)return null;try{const t=this.buildInsightsPrompt(e);return await this.callClaudeAPI(t)}catch(t){return console.error("Error generating insights:",t),null}}buildDescriptionEnhancementPrompt(e){const t=e.slice(0,10).map((e,t)=>({id:t,title:e.title,address:e.address,price:e.price,features:e.features.slice(0,6),score:e.score}));return"\nYou are a real estate expert helping to enhance apartment descriptions for a luxury apartment search in West Los Angeles. \n\nHere are ".concat(t.length," apartments that match the search criteria:\n\n").concat(JSON.stringify(t,null,2),'\n\nPlease provide enhanced descriptions for these apartments that:\n1. Highlight the most appealing features\n2. Use professional real estate language\n3. Emphasize luxury and comfort aspects\n4. Keep descriptions concise (2-3 sentences)\n5. Focus on what makes each apartment unique\n\nRespond in JSON format:\n{\n  "enhanced_descriptions": [\n    {\n      "id": 0,\n      "enhanced_description": "Enhanced description here..."\n    }\n  ]\n}\n        ')}buildInsightsPrompt(e){const t=e.slice(0,5),n=e.reduce((e,t)=>e+t.price,0)/e.length,a={high:e.filter(e=>e.score>=80).length,medium:e.filter(e=>e.score>=60&&e.score<80).length,low:e.filter(e=>e.score<60).length};return"\nYou are a real estate market analyst. Analyze this apartment search data for West Los Angeles and provide insights.\n\nSearch Results Summary:\n- Total apartments found: ".concat(e.length,"\n- Average price: $").concat(Math.round(n),"\n- Score distribution: ").concat(a.high," high-scoring, ").concat(a.medium," medium-scoring, ").concat(a.low," low-scoring\n\nTop 5 apartments:\n").concat(JSON.stringify(t.map(e=>({title:e.title,address:e.address,price:e.price,score:e.score,zipCode:e.zipCode})),null,2),"\n\nPlease provide:\n1. Market insights about pricing trends\n2. Best value recommendations\n3. Areas to focus on for better options\n4. Red flags to watch for\n5. Negotiation opportunities\n\nRespond in JSON format with actionable insights.\n        ")}async callClaudeAPI(e){if(!this.apiKey)throw new Error("API key not configured");const t=await fetch(this.baseURL,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":this.apiKey,"anthropic-version":"2023-06-01"},body:JSON.stringify({model:this.model,max_tokens:this.maxTokens,messages:[{role:"user",content:e}]})});if(!t.ok)throw new Error("API call failed: ".concat(t.status," ").concat(t.statusText));const n=await t.json();try{return JSON.parse(n.content[0].text)}catch(a){return console.error("Error parsing Claude response:",a),{error:"Failed to parse response"}}}applyEnhancedDescriptions(e,t){const n=new Map;return t.forEach(e=>{n.set(e.id,e.enhanced_description)}),e.map((e,t)=>t<10&&n.has(t)?{...e,description:n.get(t),enhanced:!0}:e)}async intelligentFilter(e,t){if(!this.apiKey||!t.trim())return e;try{const n='\nYou are helping filter apartment listings based on user preferences. \n\nUser query: "'.concat(t,'"\n\nAvailable apartments (showing first 20):\n').concat(JSON.stringify(e.slice(0,20).map(e=>({id:e.id,title:e.title,address:e.address,price:e.price,features:e.features,score:e.score})),null,2),'\n\nBased on the user query, rank these apartments and explain why each is relevant or not relevant.\nFocus on matching user intent, not just keywords.\n\nRespond in JSON format:\n{\n  "filtered_apartments": [\n    {\n      "id": "apartment_id",\n      "relevance_score": 85,\n      "reason": "Why this apartment matches the query"\n    }\n  ]\n}\n            '),a=await this.callClaudeAPI(n);if(a&&a.filtered_apartments)return this.applyIntelligentFiltering(e,a.filtered_apartments)}catch(n){console.error("Error in intelligent filtering:",n)}return e}applyIntelligentFiltering(e,t){const n=new Map;return t.forEach(e=>{n.set(e.id,{relevance:e.relevance_score,reason:e.reason})}),e.map(e=>{const t=n.get(e.id);return t?{...e,aiRelevance:t.relevance,aiReason:t.reason}:e}).filter(e=>void 0!==e.aiRelevance).sort((e,t)=>(t.aiRelevance||0)-(e.aiRelevance||0))}async generateRecommendations(e,t={}){if(!this.apiKey)return this.generateMockRecommendations(e);try{const n="\nAs a real estate expert, provide personalized apartment recommendations based on user preferences and available listings.\n\nUser Preferences:\n".concat(JSON.stringify(t,null,2),"\n\nAvailable Apartments (top 10 by score):\n").concat(JSON.stringify(e.slice(0,10).map(e=>({title:e.title,address:e.address,price:e.price,features:e.features,score:e.score,zipCode:e.zipCode})),null,2),"\n\nProvide:\n1. Top 3 recommendations with detailed reasoning\n2. Alternative options to consider\n3. What to negotiate on\n4. Potential concerns to investigate\n\nRespond in JSON format with actionable recommendations.\n            ");return await this.callClaudeAPI(n)}catch(n){return console.error("Error generating recommendations:",n),this.generateMockRecommendations(e)}}generateMockRecommendations(e){var t;return{recommendations:e.slice(0,3).map((e,t)=>({apartment_id:e.id,ranking:t+1,reason:"High score of ".concat(e.score," with excellent ").concat(e.features.slice(0,2).join(" and ")),strengths:e.features.slice(0,3),concerns:["Verify parking availability","Check actual condition"]})),market_insights:{avg_price:Math.round(e.reduce((e,t)=>e+t.price,0)/e.length),best_value:(null==(t=e.find(e=>e.score>70&&e.price<4700))?void 0:t.id)||null,negotiation_tip:"Focus on move-in incentives rather than base rent"}}}async testAPIConnection(){if(!this.apiKey)return{success:!1,error:"No API key configured"};try{return{success:!0,response:await this.callClaudeAPI('Test connection. Respond with: {"status": "connected"}')}}catch(e){return{success:!1,error:e.message}}}};export{e as __vite_legacy_guard};
//# sourceMappingURL=index-DJHGC_bB.js.map
