function e(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();class t{constructor(){this.baseUrl=this.detectBackendUrl(),this.isBackendAvailable=!1,this.lastHealthCheck=null}detectBackendUrl(){"localhost"===window.location.hostname||window.location.hostname;return"http://localhost:8000"}async checkHealth(){if(!this.baseUrl)return{available:!1,reason:"Backend URL not configured"};try{const e=new AbortController,t=setTimeout(()=>e.abort(),5e3),a=await fetch("".concat(this.baseUrl,"/health"),{method:"GET",headers:{"Content-Type":"application/json"},signal:e.signal});if(clearTimeout(t),a.ok){const e=await a.json();return this.isBackendAvailable=e.agent_ready,this.lastHealthCheck=new Date,{available:this.isBackendAvailable,health:e}}return{available:!1,reason:"HTTP ".concat(a.status)}}catch(e){return this.isBackendAvailable=!1,{available:!1,reason:"AbortError"===e.name?"Timeout":e.message}}}async searchApartments(e=null,t={}){const a=await this.checkHealth();if(!a.available)throw new Error("DeepSearchAgent backend not available: ".concat(a.reason));try{const a={zip_codes:e,max_results:t.maxResults||50,filters:{min_price:t.minPrice,max_price:t.maxPrice,min_score:t.minScore,required_amenities:t.requiredAmenities}};console.log("üîç Sending search request to DeepSearchAgent:",a);const n=new AbortController,s=setTimeout(()=>n.abort(),6e4),r=await fetch("".concat(this.baseUrl,"/search"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a),signal:n.signal});if(clearTimeout(s),!r.ok){const e=await r.json().catch(()=>({}));throw new Error(e.detail||"Search failed with status ".concat(r.status))}const o=await r.json();return console.log("‚úÖ DeepSearchAgent search completed:",o),this.transformSearchResults(o)}catch(n){throw console.error("‚ùå DeepSearchAgent search failed:",n),n}}async verifyListing(e){const t=await this.checkHealth();if(!t.available)throw new Error("DeepSearchAgent backend not available: ".concat(t.reason));try{const t=new AbortController,a=setTimeout(()=>t.abort(),3e4),n=await fetch("".concat(this.baseUrl,"/verify-listing"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({listing_url:e}),signal:t.signal});if(clearTimeout(a),!n.ok)throw new Error("Verification failed with status ".concat(n.status));return await n.json()}catch(a){throw console.error("‚ùå Listing verification failed:",a),a}}async getSearchConfig(){if(!(await this.checkHealth()).available)return null;try{const e=await fetch("".concat(this.baseUrl,"/config"));if(e.ok)return await e.json()}catch(e){console.warn("Could not fetch search config:",e)}return null}transformSearchResults(e){return e.success&&e.apartments?e.apartments.map(e=>this.transformApartment(e)):[]}transformApartment(e){return{id:e.id||this.generateId(e),title:e.title||this.generateTitle(e),address:e.address||"Address not available",zipCode:e.zip_code||e.zipCode||"Unknown",price:e.price||0,bedrooms:e.bedrooms||2,bathrooms:e.bathrooms||1.5,sqft:e.sqft||null,floor:e.floor||null,features:this.transformAmenities(e.amenities||[]),highlightFeatures:this.getHighlightFeatures(e.amenities||[]),recentlyRenovated:this.hasAmenity(e.amenities,"recently_renovated"),premiumAmenities:this.hasPremiumAmenities(e.amenities||[]),datePosted:e.datePosted||e.found_at||(new Date).toISOString(),source:e.platform||e.source||"DeepSearch",url:e.url||e.source_url,contact:e.contact||{},images:e.images||[],description:e.description||this.generateDescription(e),score:this.calculateDisplayScore(e),scoreBreakdown:e.validation||{},urlHealth:this.transformUrlHealth(e),urlHealthSummary:this.generateUrlHealthSummary(e),backupUrls:e.backup_urls||[],searchMetadata:e.search_metadata||{},extractedAt:e.extracted_at||(new Date).toISOString()}}generateId(e){const t=[e.address||"",e.price||"",e.bedrooms||"",Date.now()];return"apt_".concat(t.join("_").replace(/[^a-zA-Z0-9_]/g,"_"))}generateTitle(e){const t=e.bedrooms||2,a=this.extractAreaFromAddress(e.address)||"West LA";return"".concat(t,"-Bedroom Apartment in ").concat(a)}extractAreaFromAddress(e){if(!e)return null;const t=["Mar Vista","Culver City","Palms","Venice","Santa Monica"];for(const a of t)if(e.toLowerCase().includes(a.toLowerCase()))return a;return null}transformAmenities(e){const t={washer_dryer:"In-Unit Washer/Dryer",air_conditioning:"Central Air Conditioning",outdoor_space:"Private Balcony",parking:"Parking Garage",pool:"Swimming Pool",gym:"Fitness Center",dishwasher:"Dishwasher",hardwood:"Hardwood Floors",granite:"Granite Countertops",stainless:"Stainless Steel Appliances"};return e.map(e=>t[e]||this.capitalizeAmenity(e))}capitalizeAmenity(e){return e.replace(/_/g," ").split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}getHighlightFeatures(e){const t=["washer_dryer","air_conditioning","outdoor_space","recently_renovated","hardwood","granite"];return e.filter(e=>t.includes(e)).map(e=>this.transformAmenities([e])[0])}hasAmenity(e,t){return e&&e.includes(t)}hasPremiumAmenities(e){return["pool","gym","parking","granite","stainless"].some(t=>e.includes(t))}generateDescription(e){const t=e.bedrooms||2,a=this.extractAreaFromAddress(e.address)||"West LA",n=e.price?"$".concat(e.price.toLocaleString()):"Contact for pricing";return"Beautiful ".concat(t,"-bedroom apartment in ").concat(a,". ")+"Rent: ".concat(n,"/month. Verified listing found through DeepSearch AI. ")+"Contact directly for viewing and more information."}calculateDisplayScore(e){const t=e.validation;if(t&&t.percentage)return Math.round(t.percentage);let a=60;const n=e.price||0;n>=4400&&n<=5200&&(a+=20);const s=e.amenities||[];return s.includes("washer_dryer")&&(a+=5),s.includes("air_conditioning")&&(a+=5),s.includes("outdoor_space")&&(a+=5),this.hasPremiumAmenities(s)&&(a+=5),Math.min(100,Math.max(0,a))}transformUrlHealth(e){const t=e.verification;return t?{healthy:t.verified,status:t.verified?"verified":"failed",error:t.error,responseTime:t.response_time,verifiedAt:t.verified_at}:{healthy:!0,status:"unverified"}}generateUrlHealthSummary(e){return this.transformUrlHealth(e).healthy?{className:"healthy",icon:"fas fa-check-circle",message:"Link verified and accessible"}:{className:"error",icon:"fas fa-exclamation-triangle",message:"Primary link may not work - see alternatives"}}static async isAvailable(){const e=new t;return(await e.checkHealth()).available}getBackendStatus(){return{baseUrl:this.baseUrl,isAvailable:this.isBackendAvailable,lastHealthCheck:this.lastHealthCheck}}}class a{constructor(){this.searchCriteria={minRent:4400,maxRent:5200,bedrooms:2,minBathrooms:1.5,maxBathrooms:2,zipCodes:["90066","90230","90232","90034"],zipCodePriority:{90066:1,90230:2,90232:3,90034:4},requiredAmenities:["washer_dryer","air_conditioning","outdoor_space","above_ground_floor"],preferredFeatures:["recently_renovated","modern_interior","natural_light"]},this.deepSearchClient=new t,this.isDeepSearchAvailable=!1}async searchApartments(e){console.log("üè† Starting live apartment search with DeepSearchAgent...");const t=await this.deepSearchClient.checkHealth();if(this.isDeepSearchAvailable=t.available,e&&e(10),!this.isDeepSearchAvailable)throw console.warn("‚ö†Ô∏è DeepSearchAgent not available:",t.reason),new Error("DeepSearchAgent backend not available: ".concat(t.reason,". Please start the backend server."));try{e&&e(25);const t={minPrice:this.searchCriteria.minRent,maxPrice:this.searchCriteria.maxRent,maxResults:50,requiredAmenities:this.searchCriteria.requiredAmenities};console.log("üîç Searching with DeepSearchAgent...",{zipCodes:this.searchCriteria.zipCodes,filters:t}),e&&e(50);const a=await this.deepSearchClient.searchApartments(this.searchCriteria.zipCodes,t);console.log("‚úÖ DeepSearchAgent found ".concat(a.length," live apartments")),e&&e(75);const n=a.filter(e=>this.validateApartment(e));console.log("‚úÖ ".concat(n.length," live apartments passed validation"));const s=this.sortApartmentsByPriority(n);return e&&e(100),this.logSearchSummary(s),s}catch(a){throw console.error("‚ùå DeepSearchAgent search failed:",a),new Error("DeepSearchAgent search failed: ".concat(a.message,". Please check backend configuration."))}}validateApartment(e){const t=this.searchCriteria;return e.title&&e.address&&e.url?e.price<t.minRent||e.price>t.maxRent?(console.log("‚ùå Apartment rejected - price ".concat(e.price," outside range")),!1):e.bedrooms!==t.bedrooms?(console.log("‚ùå Apartment rejected - ".concat(e.bedrooms," bedrooms, need ").concat(t.bedrooms)),!1):e.bathrooms<t.minBathrooms||e.bathrooms>t.maxBathrooms?(console.log("‚ùå Apartment rejected - ".concat(e.bathrooms," bathrooms outside range")),!1):e.url&&""!==e.url.trim()?(console.log("‚úÖ Live apartment validated: ".concat(e.title)),!0):(console.log("‚ùå Apartment rejected - no valid URL"),!1):(console.log("‚ùå Apartment rejected - missing required fields"),!1)}sortApartmentsByPriority(e){return e.sort((e,t)=>{const a=this.searchCriteria.zipCodePriority[e.zipCode]||999,n=this.searchCriteria.zipCodePriority[t.zipCode]||999;return a!==n?a-n:(t.score||0)-(e.score||0)})}logSearchSummary(e){console.log("\nüìä LIVE SEARCH SUMMARY:"),console.log("Total live apartments found: ".concat(e.length));const t=e.reduce((e,t)=>(e[t.zipCode]=(e[t.zipCode]||0)+1,e),{});console.log("Breakdown by zip code:"),Object.entries(t).forEach(([e,t])=>{const a=this.getAreaName(e);console.log("  ".concat(e," (").concat(a,"): ").concat(t," live apartments"))});const a=e.reduce((e,t)=>(e[t.source]=(e[t.source]||0)+1,e),{});console.log("Data sources:"),Object.entries(a).forEach(([e,t])=>{console.log("  ".concat(e,": ").concat(t," listings"))});const n=e.map(e=>e.price).filter(e=>e>0);if(n.length>0){const e=Math.min(...n),t=Math.max(...n),a=Math.round(n.reduce((e,t)=>e+t,0)/n.length);console.log("Price range: $".concat(e.toLocaleString()," - $").concat(t.toLocaleString()," (avg: $").concat(a.toLocaleString(),")"))}const s=e.map(e=>e.score).filter(e=>e>0);if(s.length>0){const e=Math.round(s.reduce((e,t)=>e+t,0)/s.length),t=Math.max(...s);console.log("Score range: ".concat(Math.min(...s)," - ").concat(t," (avg: ").concat(e,")"))}console.log("\nüéØ Top 5 live matches:"),e.slice(0,5).forEach((e,t)=>{console.log("".concat(t+1,". ").concat(e.title," - ").concat(e.address," - $").concat(e.price," (Score: ").concat(e.score,") [").concat(e.source,"]"))})}getAreaName(e){return{90066:"Mar Vista",90230:"Culver City",90232:"Culver City",90034:"Palms"}[e]||"West LA"}getStatus(){return{type:"live",deepSearchAvailable:this.isDeepSearchAvailable,backendStatus:this.deepSearchClient.getBackendStatus(),searchCriteria:this.searchCriteria,message:"Live apartment search powered by DeepSearchAgent"}}delay(e){return new Promise(t=>setTimeout(t,e))}}class n{constructor(){this.weights={rentInRange:20,mandatoryAmenities:30,renovationRecency:25,naturalLight:15,outdoorSpaceQuality:10,zipCodePriority:10,premiumAmenities:5,locationRating:5,professionalPhotos:3,floorLevel:2},this.maxScore=100}calculateScore(e,t={minRent:4400,maxRent:5200,zipCodePriority:{90066:1,90230:2,90232:3,90034:4}}){let a=0;a+=this.calculateRentScore(e.price,t);a+=this.calculateMandatoryAmenityScore(e);a+=this.calculateRenovationScore(e);a+=this.calculateNaturalLightScore(e);a+=this.calculateOutdoorSpaceScore(e);a+=this.calculateZipCodeScore(e.zipCode,t);a+=this.calculatePremiumAmenitiesScore(e);a+=this.calculateLocationRatingScore(e);a+=this.calculatePhotoScore(e);return a+=this.calculateFloorScore(e),Math.round(Math.min(a,this.maxScore))}getScoreBreakdown(e,t={minRent:4400,maxRent:5200,zipCodePriority:{90066:1,90230:2,90232:3,90034:4}}){const a={};return a.price=this.calculateRentScore(e.price,t),a.specs=this.calculateMandatoryAmenityScore(e),a.floor=this.calculateFloorScore(e),a.features=this.calculateRenovationScore(e)+this.calculateNaturalLightScore(e)+this.calculateOutdoorSpaceScore(e),a.renovation=e.recentlyRenovated?10:0,a.total=Math.min(a.price+a.specs+a.floor+a.features+a.renovation,100),a}calculateRentScore(e,t){const{minRent:a,maxRent:n}=t;if(e<a||e>n)return 0;const s=(a+n)/2,r=(n-a)/2,o=Math.abs(e-s),i=this.weights.rentInRange*(1-o/r);return Math.round(i)}calculateMandatoryAmenityScore(e){const t={washerDryer:!1,airConditioning:!1,outdoorSpace:!1,aboveGroundFloor:!1},a=e.features.map(e=>e.toLowerCase());t.washerDryer=a.some(e=>e.includes("washer")&&e.includes("dryer")||e.includes("w/d")||e.includes("laundry")),t.airConditioning=a.some(e=>e.includes("air")||e.includes("conditioning")||e.includes("hvac")||e.includes("central air")),t.outdoorSpace=a.some(e=>e.includes("balcony")||e.includes("patio")||e.includes("terrace")||e.includes("deck")||e.includes("outdoor")),t.aboveGroundFloor=e.floor>1;const n=Object.values(t).filter(Boolean).length/Object.keys(t).length;return Math.round(this.weights.mandatoryAmenities*n)}calculateRenovationScore(e){const t=e.features.map(e=>e.toLowerCase()),a=["renovated","updated","remodeled","modern","new","contemporary","upgraded","refreshed","redesigned"],n=t.some(e=>a.some(t=>e.includes(t))),s=e.recentlyRenovated||!1,r=["stainless steel","granite","quartz","hardwood","modern kitchen","designer","luxury"],o=t.some(e=>r.some(t=>e.includes(t)));let i=0;return i=s?this.weights.renovationRecency:n&&o?.8*this.weights.renovationRecency:n||o?.5*this.weights.renovationRecency:.2*this.weights.renovationRecency,Math.round(i)}calculateNaturalLightScore(e){var t;const a=e.features.map(e=>e.toLowerCase()),n=(null==(t=e.description)?void 0:t.toLowerCase())||"",s=["natural light","bright","sunny","light-filled","windows","large windows","floor-to-ceiling","multiple exposures","corner unit"],r=a.concat([n]).some(e=>s.some(t=>e.includes(t))),o=e.floor>5?.2:0;let i=0;return i=r?this.weights.naturalLight*(.8+o):this.weights.naturalLight*(.4+o),Math.round(i)}calculateOutdoorSpaceScore(e){const t=e.features.map(e=>e.toLowerCase()),a={"private balcony":1,terrace:1,"private patio":.9,deck:.8,balcony:.7,patio:.6,outdoor:.5};let n=0;for(const[s,r]of Object.entries(a))t.some(e=>e.includes(s))&&(n=Math.max(n,this.weights.outdoorSpaceQuality*r));return Math.round(n)}calculateZipCodeScore(e,t){const a=t.zipCodePriority[e]||5,n=Math.max(0,(5-a)/4);return Math.round(this.weights.zipCodePriority*n)}calculatePremiumAmenitiesScore(e){const t=e.features.map(e=>e.toLowerCase()),a=["swimming pool","fitness center","gym","concierge","doorman","roof deck","rooftop","parking garage","valet parking","business center","club room"],n=t.filter(e=>a.some(t=>e.includes(t))).length,s=Math.min(1.5*n,this.weights.premiumAmenities);return Math.round(s)}calculateLocationRatingScore(e){const t={90066:4.5,90230:4.2,90232:3.8,90034:3.5}[e.zipCode]||3,a=e.price>4800?.2:0,n=Math.min(t+a,5),s=Math.max(0,(n-3)/2);return Math.round(this.weights.locationRating*s)}calculatePhotoScore(e){var t;const a=(null==(t=e.images)?void 0:t.length)||0;return a>=5?this.weights.professionalPhotos:a>=3?Math.round(.7*this.weights.professionalPhotos):a>=1?Math.round(.4*this.weights.professionalPhotos):0}calculateFloorScore(e){const t=e.floor||2;return t>=3&&t<=6?this.weights.floorLevel:2===t||7===t||8===t?Math.round(.7*this.weights.floorLevel):t>8?Math.round(.5*this.weights.floorLevel):0}}const s=new class{constructor(e={}){this.options={rootMargin:"50px",threshold:.1,placeholderSrc:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9ImciIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPjxzdG9wIG9mZnNldD0iMCUiIHN0b3AtY29sb3I9IiNmNWY1ZjUiLz48c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiNlZWVlZWUiLz48L2xpbmVhckdyYWRpZW50PjwvZGVmcz48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ1cmwoI2cpIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNHB4IiBmaWxsPSIjOTk5OTk5IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIj5Mb2FkaW5nLi4uPC90ZXh0Pjwvc3ZnPg==",errorSrc:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjVmNWY1Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNHB4IiBmaWxsPSIjOTk5OTk5IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIj5JbWFnZSBVbmF2YWlsYWJsZTwvdGV4dD48L3N2Zz4=",fadeInDuration:300,retryAttempts:2,retryDelay:1e3,...e},this.observer=null,this.loadedImages=new Set,this.failedImages=new Set,this.retryCount=new Map,this.init()}init(){"IntersectionObserver"in window?(this.observer=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&this.loadImage(e.target)})},{rootMargin:this.options.rootMargin,threshold:this.options.threshold}),this.observeImages()):this.loadAllImages()}observeImages(){document.querySelectorAll("img[data-src]").forEach(e=>{this.loadedImages.has(e)||(this.setupImageForLazyLoading(e),this.observer.observe(e))})}setupImageForLazyLoading(e){e.src&&""!==e.src||(e.src=this.options.placeholderSrc),e.classList.add("lazy-loading"),this.addLoadingIndicator(e),e.style.opacity="0",e.style.transition="opacity ".concat(this.options.fadeInDuration,"ms ease-in-out")}addLoadingIndicator(e){const t=e.parentElement;if(!t.classList.contains("image-container")){const t=document.createElement("div");t.className="image-container",e.parentNode.insertBefore(t,e),t.appendChild(e)}if(!t.querySelector(".loading-indicator")){const e=document.createElement("div");e.className="loading-indicator",e.innerHTML='\n                <div class="loading-spinner">\n                    <div class="spinner"></div>\n                </div>\n            ',t.appendChild(e)}}async loadImage(e){const t=e.getAttribute("data-src");if(t&&!this.loadedImages.has(e))try{this.observer&&this.observer.unobserve(e),await this.preloadImage(t),e.src=t,e.removeAttribute("data-src"),e.classList.remove("lazy-loading"),e.classList.add("lazy-loaded"),e.style.opacity="1",this.removeLoadingIndicator(e),this.loadedImages.add(e),e.dispatchEvent(new CustomEvent("lazyLoaded",{detail:{src:t,img:e}}))}catch(a){console.warn("Failed to load image:",t,a),await this.handleImageError(e,t)}}preloadImage(e){return new Promise((t,a)=>{const n=new Image;n.onload=()=>t(n),n.onerror=()=>a(new Error("Failed to load image: ".concat(e))),setTimeout(()=>{a(new Error("Image load timeout: ".concat(e)))},1e4),n.src=e})}async handleImageError(e,t){const a=t,n=this.retryCount.get(a)||0;if(n<this.options.retryAttempts){this.retryCount.set(a,n+1),await new Promise(e=>setTimeout(e,this.options.retryDelay));try{return await this.preloadImage(t),e.src=t,e.removeAttribute("data-src"),e.classList.remove("lazy-loading"),e.classList.add("lazy-loaded"),e.style.opacity="1",this.removeLoadingIndicator(e),void this.loadedImages.add(e)}catch(s){console.warn("Retry ".concat(n+1," failed for image:"),t)}}e.src=this.options.errorSrc,e.classList.remove("lazy-loading"),e.classList.add("lazy-error"),e.style.opacity="1",this.removeLoadingIndicator(e),this.failedImages.add(e),e.dispatchEvent(new CustomEvent("lazyLoadError",{detail:{originalSrc:t,img:e}}))}removeLoadingIndicator(e){const t=e.parentElement.querySelector(".loading-indicator");t&&(t.classList.add("fade-out"),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},200))}loadAllImages(){document.querySelectorAll("img[data-src]").forEach(e=>{this.setupImageForLazyLoading(e),this.loadImage(e)})}refresh(){this.observer&&this.observeImages()}observe(e){if(!this.observer)return;(Array.isArray(e)?e:[e]).forEach(e=>{"IMG"===e.tagName&&e.hasAttribute("data-src")&&(this.setupImageForLazyLoading(e),this.observer.observe(e))})}loadImagesInContainer(e){e.querySelectorAll("img[data-src]").forEach(e=>this.loadImage(e))}getStats(){return{loaded:this.loadedImages.size,failed:this.failedImages.size,pending:document.querySelectorAll("img[data-src]").length}}destroy(){this.observer&&(this.observer.disconnect(),this.observer=null),this.loadedImages.clear(),this.failedImages.clear(),this.retryCount.clear()}};"undefined"!=typeof window&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{s.refresh()}):s.refresh());const r=new class{constructor(){this.healthCache=new Map,this.maxCacheAge=3e5,this.timeoutDuration=1e4}async checkUrlHealth(e){const t=this.getFromCache(e);if(t)return t;const a=Date.now();let n;try{if(!this.isValidUrl(e))throw new Error("Invalid URL format");const t=new window.AbortController;let r;n=setTimeout(()=>t.abort(),this.timeoutDuration);try{r=await fetch(e,{method:"HEAD",signal:t.signal,mode:"no-cors",cache:"no-cache",redirect:"follow"})}catch(s){r=await fetch(e,{method:"GET",signal:t.signal,mode:"no-cors",cache:"no-cache",redirect:"follow"})}clearTimeout(n);const o=Date.now()-a;let i="accessible",c=!0;"opaque"===r.type?i="cors_accessible":r.status&&(i=r.status,c=r.status>=200&&r.status<400);const l={healthy:c,status:i,responseTime:o,lastChecked:Date.now(),method:"validated"};return this.setCache(e,l),l}catch(r){n&&clearTimeout(n);const t=Date.now()-a;let s="unknown",o=!1;"AbortError"===r.name?s="timeout":r.message.includes("CORS")||r.message.includes("cross-origin")?(s="cors_blocked",o=!0):r.message.includes("NetworkError")||r.message.includes("Failed to fetch")?this.isKnownGoodDomain(e)?(s="network_cors",o=!0):s="network_error":s=r.message.includes("404")||r.message.includes("Not Found")?"404_not_found":r.message.includes("Invalid URL")?"invalid_url":"error";const i={healthy:o,status:s,responseTime:t,error:r.message,lastChecked:Date.now(),method:"error_detected"};return this.setCache(e,i),i}}isValidUrl(e){try{const t=new URL(e);return"http:"===t.protocol||"https:"===t.protocol}catch(t){return!1}}isKnownGoodDomain(e){const t=["apartments.com","zillow.com","trulia.com","hotpads.com","westsiderentals.com","realtor.com","rent.com","padmapper.com","craigslist.org","facebook.com","google.com"];try{const a=new URL(e).hostname.toLowerCase();return t.some(e=>a.includes(e))}catch(a){return!1}}async checkMultipleUrls(e){const t=e.map(async e=>({url:e,health:await this.checkUrlHealth(e)}));return await Promise.all(t)}getFromCache(e){const t=this.healthCache.get(e);return t&&Date.now()-t.lastChecked<this.maxCacheAge?t:null}setCache(e,t){this.healthCache.set(e,t),this.healthCache.size>100&&this.cleanupCache()}cleanupCache(){const e=Date.now();for(const[t,a]of this.healthCache.entries())e-a.lastChecked>this.maxCacheAge&&this.healthCache.delete(t)}getHealthSummary(e){const{healthy:t,status:a,responseTime:n,error:s}=e;let r={className:"unknown",icon:"fas fa-question-circle",message:"Unknown status",color:"#6c757d"};if(t)r="cors_blocked"===a?{className:"warning",icon:"fas fa-exclamation-triangle",message:"Cannot verify (CORS), but likely accessible",color:"#f39c12"}:{className:"healthy",icon:"fas fa-check-circle",message:"Accessible (".concat(n,"ms)"),color:"#27ae60"};else switch(a){case"timeout":r={className:"error",icon:"fas fa-clock",message:"Connection timeout",color:"#e74c3c"};break;case"404_not_found":r={className:"error",icon:"fas fa-unlink",message:"Page not found (404)",color:"#e74c3c"};break;case"network_error":r={className:"error",icon:"fas fa-wifi",message:"Network error",color:"#e74c3c"};break;default:r={className:"error",icon:"fas fa-exclamation-circle",message:s?"Error: ".concat(s.substring(0,50),"..."):"Connection failed",color:"#e74c3c"}}return r}generateAlternativeUrls(e,t,a){const n=encodeURIComponent(e||""),s=encodeURIComponent("".concat(e," CA ").concat(t," apartments rent 2 bedroom")),r=a?encodeURIComponent("".concat(e," apartments under ").concat(a," rent")):s;return[{name:"Google Search",url:"https://www.google.com/search?q=".concat(s,"&tbm=&tbs=qdr:m"),type:"search",priority:1,description:"Comprehensive search results"},{name:"Apartments.com",url:"https://www.apartments.com/los-angeles-ca/",type:"listings",priority:1,description:"Browse LA apartments"},{name:"Zillow Rentals",url:"https://www.zillow.com/los-angeles-ca/rentals/",type:"listings",priority:1,description:"Rental listings on Zillow"},{name:"Rent.com Search",url:"https://www.rent.com/california/los-angeles-apartments",type:"listings",priority:2,description:"Rent.com listings"},{name:"HotPads",url:"https://hotpads.com/los-angeles-ca/apartments-for-rent",type:"listings",priority:2,description:"Map-based apartment search"},{name:"Trulia Rentals",url:"https://www.trulia.com/for_rent/Los_Angeles,CA/",type:"listings",priority:2,description:"Neighborhood-focused search"},{name:"Westside Rentals",url:"https://www.westsiderentals.com/",type:"listings",priority:2,description:"Westside LA specialist"},{name:"PadMapper",url:"https://www.padmapper.com/apartments/los-angeles-ca",type:"listings",priority:3,description:"Interactive map search"},{name:"Craigslist LA",url:"https://losangeles.craigslist.org/search/apa?query=".concat(n,"+").concat(t),type:"community",priority:3,description:"Community listings"},{name:"Facebook Marketplace",url:"https://www.facebook.com/marketplace/los-angeles/propertyrentals",type:"community",priority:3,description:"Social marketplace"},{name:"Bing Search",url:"https://www.bing.com/search?q=".concat(r),type:"search",priority:4,description:"Alternative search engine"},{name:"Realtor.com",url:"https://www.realtor.com/apartments-for-rent/Los-Angeles_CA",type:"listings",priority:4,description:"Realtor apartment listings"}].sort((e,t)=>e.priority-t.priority)}generateSmartBackups(e,t,a,n,s){const r=this.generateAlternativeUrls(t,a,n);switch(s){case"cors_blocked":case"network_cors":return r.filter(e=>"search"===e.type||e.priority<=2).slice(0,4);case"timeout":return r.filter(e=>e.priority<=2&&"community"!==e.type).slice(0,3);case"404_not_found":case"invalid_url":return r.slice(0,6);default:return r.slice(0,5)}}async monitorApartmentUrls(e){var t,a;console.log("üîç Monitoring health of ".concat(e.length," apartment URLs..."));const n=[];for(const r of e)try{const e=await this.checkUrlHealth(r.url),s=this.getHealthSummary(e);n.push({...r,urlHealth:e,urlHealthSummary:s,alternativeUrls:e.healthy?r.backupUrls||[]:this.generateAlternativeUrls(null==(a=null==(t=r.address)?void 0:t.split(",")[1])?void 0:a.trim(),r.zipCode,r.price)}),await new Promise(e=>setTimeout(e,100))}catch(s){console.warn("Failed to monitor URL for apartment ".concat(r.id,":"),s),n.push({...r,urlHealth:{healthy:!1,status:"monitor_error",error:s.message},urlHealthSummary:{className:"error",icon:"fas fa-exclamation-circle",message:"Monitoring failed",color:"#e74c3c"}})}return console.log("‚úÖ URL monitoring complete. ".concat(n.filter(e=>{var t;return null==(t=e.urlHealth)?void 0:t.healthy}).length,"/").concat(n.length," URLs appear healthy.")),n}clearCache(){this.healthCache.clear()}getCacheStats(){const e=Array.from(this.healthCache.values());return{totalEntries:this.healthCache.size,healthyUrls:e.filter(e=>e.healthy).length,unhealthyUrls:e.filter(e=>!e.healthy).length,averageResponseTime:e.length>0?e.reduce((e,t)=>e+(t.responseTime||0),0)/e.length:0,oldestEntry:e.length>0?Math.min(...e.map(e=>e.lastChecked)):null,newestEntry:e.length>0?Math.max(...e.map(e=>e.lastChecked)):null}}};class o{constructor(){this.apartments=[],this.filteredApartments=[],this.bookmarkedApartments=JSON.parse(localStorage.getItem("bookmarkedApartments")||"[]"),this.isSearching=!1,this.init()}init(){this.bindEvents(),this.loadBookmarks(),console.log("Apartment Finder App initialized")}bindEvents(){document.getElementById("searchBtn").addEventListener("click",()=>this.startSearch());document.getElementById("sortBy").addEventListener("change",()=>this.applyFilters());document.getElementById("minScore").addEventListener("input",e=>{document.getElementById("minScoreValue").textContent=e.target.value,this.applyFilters()}),["recentOnly","renovatedOnly","premiumOnly"].forEach(e=>{document.getElementById(e).addEventListener("change",()=>this.applyFilters())});const e=document.getElementById("toggleFilters"),t=document.querySelector(".filter-content");e.addEventListener("click",()=>{const a="none"!==t.style.display;t.style.display=a?"none":"block",e.innerHTML=a?'<i class="fas fa-chevron-down"></i>':'<i class="fas fa-chevron-up"></i>'});const a=document.getElementById("apartmentModal");document.getElementById("closeModal").addEventListener("click",()=>this.closeModal()),a.addEventListener("click",e=>{e.target===a&&this.closeModal()});document.getElementById("exportBtn").addEventListener("click",()=>this.exportResults()),document.addEventListener("keydown",e=>{"Escape"===e.key&&"none"!==a.style.display&&this.closeModal(),"Enter"===e.key&&e.ctrlKey&&!this.isSearching&&this.startSearch()})}async startSearch(){if(!this.isSearching){this.isSearching=!0,this.showLoadingState();try{const e=new a,t=new n,s=e.getStatus();console.log("üîß Search Engine Status:",s);const o=await e.searchApartments(e=>{this.updateProgress(e)});this.apartments=o.map(e=>({...e,score:t.calculateScore(e),scoreBreakdown:t.getScoreBreakdown(e)})),console.log("üîç Checking apartment listing URLs..."),this.apartments=await r.monitorApartmentUrls(this.apartments),this.applyFilters(),this.showResults()}catch(e){console.error("Search failed:",e),this.showToast("Search failed. Please try again.","error")}finally{this.isSearching=!1,this.hideLoadingState()}}}showLoadingState(){const e=document.getElementById("searchBtn"),t=document.getElementById("loadingIndicator");e.style.display="none",t.style.display="block",document.getElementById("resultsSection").style.display="none",document.getElementById("filterPanel").style.display="none"}hideLoadingState(){const e=document.getElementById("searchBtn"),t=document.getElementById("loadingIndicator");e.style.display="inline-block",t.style.display="none"}updateProgress(e){const t=Math.min(Math.floor(e/25),3);["step1","step2","step3","step4"].forEach((e,a)=>{const n=document.getElementById(e);n.className=a<t?"step completed":a===t?"step active":"step"})}applyFilters(){if(!this.apartments.length)return;let e=[...this.apartments];const t=parseInt(document.getElementById("minScore").value);if(e=e.filter(e=>e.score>=t),document.getElementById("recentOnly").checked){const t=new Date(Date.now()-6048e5);e=e.filter(e=>new Date(e.datePosted)>t)}document.getElementById("renovatedOnly").checked&&(e=e.filter(e=>e.recentlyRenovated)),document.getElementById("premiumOnly").checked&&(e=e.filter(e=>e.premiumAmenities));const a=document.getElementById("sortBy").value;e.sort((e,t)=>{switch(a){case"score":default:return t.score-e.score;case"price-low":return e.price-t.price;case"price-high":return t.price-e.price;case"newest":return new Date(t.datePosted)-new Date(e.datePosted)}}),this.filteredApartments=e,this.renderResults()}showResults(){document.getElementById("resultsSection").style.display="block",document.getElementById("filterPanel").style.display="block",document.getElementById("resultsSection").scrollIntoView({behavior:"smooth"})}renderResults(){const e=document.getElementById("resultsGrid"),t=document.getElementById("recentResults"),a=document.getElementById("recentListings"),n=document.getElementById("noResults");if(document.getElementById("resultsCount").textContent="".concat(this.filteredApartments.length," apartments found"),0===this.filteredApartments.length)return e.innerHTML="",t.innerHTML="",a.style.display="none",void(n.style.display="block");n.style.display="none";const r=new Date(Date.now()-6048e5),o=this.filteredApartments.filter(e=>new Date(e.datePosted)>r),i=this.filteredApartments;o.length>0?(a.style.display="block",t.innerHTML=o.slice(0,6).map(e=>this.createApartmentCard(e,!0)).join("")):a.style.display="none",e.innerHTML=i.map(e=>this.createApartmentCard(e)).join(""),document.querySelectorAll(".apartment-card").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.apartmentId,a=this.apartments.find(e=>e.id===t);this.showApartmentDetails(a)})}),document.querySelectorAll(".show-backups-btn").forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation(),this.toggleBackupLinks(e)})}),document.querySelectorAll(".expand-more-backups").forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation(),this.toggleAdditionalBackups(e)})}),setTimeout(()=>{s.refresh()},100)}createApartmentCard(e){const t=e.score>=80?"high":e.score>=60?"medium":"low",a=e.features.slice(0,3).map(t=>{var a;return'<span class="feature-tag '.concat((null==(a=e.highlightFeatures)?void 0:a.includes(t))?"highlight":"",'">').concat(t,"</span>")}).join(""),n=this.bookmarkedApartments.includes(e.id);return'\n            <div class="apartment-card fade-in" data-apartment-id="'.concat(e.id,'">\n                <div class="card-image">\n                    <div class="image-container">\n                        ').concat(e.images&&e.images.length>0?'<img class="property-image" data-src="'.concat(e.images[0],'" alt="').concat(e.title,'" onerror="this.classList.add(\'lazy-error\')">'):'<div class="no-image-placeholder"><i class="fas fa-image"></i><span>No Image Available</span></div>','\n                    </div>\n                    <div class="score-badge ').concat(t,'">').concat(e.score,"</div>\n                    ").concat(n?'<div class="bookmark-indicator"><i class="fas fa-bookmark"></i></div>':"",'\n                </div>\n                <div class="card-content">\n                    <h3 class="card-title">').concat(e.title,'</h3>\n                    <p class="card-address">\n                        <i class="fas fa-map-marker-alt"></i>\n                        ').concat(e.address,'\n                    </p>\n                    \n                    <div class="card-details">\n                        <div class="detail-item">\n                            <i class="fas fa-bed"></i>\n                            ').concat(e.bedrooms,' bed\n                        </div>\n                        <div class="detail-item">\n                            <i class="fas fa-bath"></i>\n                            ').concat(e.bathrooms,' bath\n                        </div>\n                        <div class="detail-item">\n                            <i class="fas fa-ruler-combined"></i>\n                            ').concat(e.sqft||"N/A",' sq ft\n                        </div>\n                        <div class="detail-item">\n                            <i class="fas fa-building"></i>\n                            Floor ').concat(e.floor||"N/A",'\n                        </div>\n                    </div>\n                    \n                    <div class="card-features">\n                        ').concat(a,"\n                        ").concat(e.features.length>3?'<span class="feature-tag">+'.concat(e.features.length-3," more</span>"):"",'\n                    </div>\n                    \n                    <div class="card-price">$').concat(e.price.toLocaleString(),'/month</div>\n                    \n                    <div class="card-actions">\n                        <div class="listing-buttons">\n                            ').concat(this.renderPrimaryListingButton(e),"\n                            ").concat(this.renderBackupOptions(e),'\n                        </div>\n                        <div class="listing-info">\n                            <span class="listing-source">üìç Live data from: <strong>').concat(e.source,"</strong></span>\n                            ").concat(e.urlHealthSummary?'\n                                <div class="link-health-indicator '.concat(e.urlHealthSummary.className,'">\n                                    <i class="').concat(e.urlHealthSummary.icon,'"></i>\n                                    <span class="health-tooltip">').concat(e.urlHealthSummary.message,"</span>\n                                </div>\n                            "):"",'\n                            <small class="data-freshness">Updated: ').concat(this.formatDatePosted(e.datePosted),"</small>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        ")}renderPrimaryListingButton(e){const t=e.urlHealth;let a="view-listing-btn primary",n="View on ".concat(e.source),s="fas fa-external-link-alt";return t&&!t.healthy&&(a+=" warning",n="Try ".concat(e.source),s="fas fa-exclamation-triangle"),'\n            <a href="'.concat(e.url,'" target="_blank" rel="noopener noreferrer" \n               class="').concat(a,'" onclick="event.stopPropagation();"\n               title="').concat(t?t.status:"Link status unknown",'">\n                <i class="').concat(s,'"></i>\n                ').concat(n,"\n            </a>\n        ")}renderBackupOptions(e){const t=e.backupUrls||e.alternativeUrls||[];if(0===t.length)return"";const a=t.filter(e=>e.priority<=2).slice(0,3),n=t.filter(e=>e.priority>2);let s="";const r=e.urlHealth&&!e.urlHealth.healthy;if(a.length>0&&(s+='\n                <div class="backup-links" style="display: '.concat(r?"block":"none",';">\n                    ').concat(a.map(e=>'\n                        <a href="'.concat(e.url,'" target="_blank" rel="noopener noreferrer" \n                           class="view-listing-btn backup ').concat("search"===e.type?"search":"listing",'" \n                           onclick="event.stopPropagation();"\n                           title="').concat(e.description||e.name,'">\n                            <i class="fas fa-').concat("search"===e.type?"search":"building",'"></i>\n                            ').concat(e.name,"\n                        </a>\n                    ")).join(""),"\n                </div>\n            ")),a.length>0||n.length>0){const e=r?"Hide Alternatives":"More Options",t=r?"up":"down";s+='\n                <button class="show-backups-btn '.concat(r?"expanded":"",'" \n                        onclick="event.stopPropagation();">\n                    <i class="fas fa-chevron-').concat(t,'"></i>\n                    ').concat(e,"\n                </button>\n            ")}return s}showApartmentDetails(e){var t,a;const n=document.getElementById("apartmentModal"),r=document.getElementById("modalTitle"),o=document.getElementById("modalBody"),i=document.getElementById("bookmarkBtn");r.textContent=e.title;const c=e.score>=80?"high":e.score>=60?"medium":"low",l=e.images&&e.images.length>0?'<div class="image-gallery">\n                '.concat(e.images.map((e,t)=>'<div class="image-container" style="margin-bottom: 1rem;">\n                        <img class="property-image" \n                             '.concat(0===t?'src="'.concat(e,'"'):'data-src="'.concat(e,'"'),' \n                             alt="Apartment image" \n                             style="width: 100%; border-radius: 8px;"\n                             onerror="this.classList.add(\'lazy-error\')">\n                    </div>')).join(""),"\n            </div>"):'<div class="no-image">No images available</div>';o.innerHTML="\n            ".concat(l,'\n            \n            <div class="apartment-details">\n                <div class="detail-header">\n                    <div class="score-display">\n                        <span class="score-badge ').concat(c,'">').concat(e.score,'</span>\n                        <span class="score-label">Match Score</span>\n                    </div>\n                    <div class="price-display">\n                        <span class="price">$').concat(e.price.toLocaleString(),'</span>\n                        <span class="price-label">per month</span>\n                    </div>\n                </div>\n                \n                <div class="address-section">\n                    <h4><i class="fas fa-map-marker-alt"></i> Address</h4>\n                    <p>').concat(e.address,"</p>\n                    <p><strong>Zip Code:</strong> ").concat(e.zipCode,'</p>\n                </div>\n                \n                <div class="specs-section">\n                    <h4><i class="fas fa-info-circle"></i> Specifications</h4>\n                    <div class="specs-grid">\n                        <div class="spec-item">\n                            <i class="fas fa-bed"></i>\n                            <span>').concat(e.bedrooms,' Bedrooms</span>\n                        </div>\n                        <div class="spec-item">\n                            <i class="fas fa-bath"></i>\n                            <span>').concat(e.bathrooms,' Bathrooms</span>\n                        </div>\n                        <div class="spec-item">\n                            <i class="fas fa-ruler-combined"></i>\n                            <span>').concat(e.sqft||"N/A",' sq ft</span>\n                        </div>\n                        <div class="spec-item">\n                            <i class="fas fa-building"></i>\n                            <span>Floor ').concat(e.floor||"N/A",'</span>\n                        </div>\n                    </div>\n                </div>\n                \n                <div class="amenities-section">\n                    <h4><i class="fas fa-star"></i> Amenities & Features</h4>\n                    <div class="amenities-grid">\n                        ').concat(e.features.map(t=>{var a;return'<div class="amenity-item '.concat((null==(a=e.highlightFeatures)?void 0:a.includes(t))?"highlight":"",'">\n                                <i class="fas fa-check"></i>\n                                ').concat(t,"\n                            </div>")}).join(""),"\n                    </div>\n                </div>\n                \n                ").concat(e.description?'\n                    <div class="description-section">\n                        <h4><i class="fas fa-file-text"></i> Description</h4>\n                        <p>'.concat(e.description,"</p>\n                    </div>\n                "):"",'\n                \n                <div class="listing-url-section">\n                    <h4><i class="fas fa-external-link-alt"></i> View Full Listing</h4>\n                    <div class="url-container">\n                        ').concat(this.renderModalPrimaryButton(e),"\n                        ").concat(this.renderModalHealthStatus(e),"\n                        ").concat(this.renderModalBackupOptions(e),'\n                    </div>\n                </div>\n                \n                <div class="contact-section">\n                    <h4><i class="fas fa-phone"></i> Contact Information</h4>\n                    <p><strong>Phone:</strong> ').concat((null==(t=e.contact)?void 0:t.phone)||"Not available","</p>\n                    <p><strong>Email:</strong> ").concat((null==(a=e.contact)?void 0:a.email)||"Not available","</p>\n                    <p><strong>Source:</strong> ").concat(e.source,"</p>\n                    <p><strong>Posted:</strong> ").concat(new Date(e.datePosted).toLocaleDateString(),"</p>\n                </div>\n            </div>\n        ");const d=this.bookmarkedApartments.includes(e.id);i.innerHTML=d?'<i class="fas fa-bookmark"></i> Bookmarked':'<i class="far fa-bookmark"></i> Bookmark',i.onclick=()=>this.toggleBookmark(e.id),n.style.display="flex",setTimeout(()=>{n.classList.add("show"),s.refresh()},10)}closeModal(){const e=document.getElementById("apartmentModal");e.classList.remove("show"),setTimeout(()=>e.style.display="none",300)}toggleBookmark(e){const t=this.bookmarkedApartments.indexOf(e);t>-1?(this.bookmarkedApartments.splice(t,1),this.showToast("Bookmark removed","warning")):(this.bookmarkedApartments.push(e),this.showToast("Apartment bookmarked!","success")),localStorage.setItem("bookmarkedApartments",JSON.stringify(this.bookmarkedApartments)),this.renderResults();const a=document.getElementById("bookmarkBtn"),n=this.bookmarkedApartments.includes(e);a.innerHTML=n?'<i class="fas fa-bookmark"></i> Bookmarked':'<i class="far fa-bookmark"></i> Bookmark'}loadBookmarks(){console.log("Loaded ".concat(this.bookmarkedApartments.length," bookmarked apartments"))}exportResults(){if(0===this.filteredApartments.length)return void this.showToast("No results to export","warning");const e=this.filteredApartments.map(e=>{var t;return{title:e.title,address:e.address,price:e.price,bedrooms:e.bedrooms,bathrooms:e.bathrooms,sqft:e.sqft,score:e.score,features:e.features.join(", "),contact:(null==(t=e.contact)?void 0:t.phone)||"",source:e.source,datePosted:e.datePosted}}),t=this.convertToCSV(e);this.downloadCSV(t,"apartment-search-results.csv"),this.showToast("Results exported successfully!","success")}convertToCSV(e){return[Object.keys(e[0]).join(","),...e.map(e=>Object.values(e).map(e=>"string"==typeof e&&e.includes(",")?'"'.concat(e,'"'):e).join(","))].join("\n")}downloadCSV(e,t){const a=new Blob([e],{type:"text/csv"}),n=window.URL.createObjectURL(a),s=document.createElement("a");s.setAttribute("hidden",""),s.setAttribute("href",n),s.setAttribute("download",t),document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(n)}showToast(e,t="success"){const a=document.getElementById("toastContainer"),n=document.createElement("div");n.className="toast ".concat(t),n.innerHTML='\n            <div class="toast-content">\n                <i class="fas fa-'.concat("success"===t?"check-circle":"error"===t?"exclamation-circle":"exclamation-triangle",'"></i>\n                <span>').concat(e,"</span>\n            </div>\n        "),a.appendChild(n),setTimeout(()=>n.classList.add("show"),100),setTimeout(()=>{n.classList.remove("show"),setTimeout(()=>a.removeChild(n),300)},4e3)}renderModalPrimaryButton(e){const t=e.urlHealth;let a="modal-view-listing-btn primary",n="View on ".concat(e.source),s="fas fa-external-link-alt";return t&&!t.healthy&&(a+=" warning",n="Try ".concat(e.source," (may not work)"),s="fas fa-exclamation-triangle"),'\n            <a href="'.concat(e.url,'" target="_blank" rel="noopener noreferrer" class="').concat(a,'">\n                <i class="').concat(s,'"></i>\n                ').concat(n,"\n            </a>\n        ")}renderModalHealthStatus(e){const t=e.urlHealth,a=e.urlHealthSummary;if(!t||!a)return'<p class="url-disclaimer">Primary listing from '.concat(e.source,". Link status unknown.</p>");let n="";return n=t.healthy?"cors_accessible"===t.status||"cors_blocked"===t.status?'\n                    <div class="health-status warning">\n                        <i class="fas fa-info-circle"></i>\n                        <span>Link appears to work but cannot be fully verified due to browser security restrictions.</span>\n                    </div>\n                ':'\n                    <div class="health-status healthy">\n                        <i class="fas fa-check-circle"></i>\n                        <span>Link verified and accessible (response: '.concat(t.responseTime,"ms)</span>\n                    </div>\n                "):'\n                <div class="health-status error">\n                    <i class="fas fa-exclamation-triangle"></i>\n                    <span>Primary link may not work: '.concat(a.message,". Try alternatives below.</span>\n                </div>\n            "),"".concat(n,'<p class="url-disclaimer">Primary listing from ').concat(e.source,".</p>")}renderModalBackupOptions(e){const t=e.backupUrls||e.alternativeUrls||[];if(0===t.length)return"";const a=t.filter(e=>e.priority<=2),n=t.filter(e=>e.priority>2);let s='\n            <div class="backup-options">\n                <h5><i class="fas fa-life-ring"></i> Alternative Search Options</h5>\n        ';return e.urlHealth&&!e.urlHealth.healthy?s+='<p class="backup-info urgent">‚ö†Ô∏è Primary link issue detected. These alternatives are recommended:</p>':s+='<p class="backup-info">If the primary link doesn\'t work, try these alternatives:</p>',a.length>0&&(s+='\n                <div class="backup-buttons priority">\n                    <h6>Recommended Alternatives:</h6>\n                    '.concat(a.map(e=>'\n                        <a href="'.concat(e.url,'" target="_blank" rel="noopener noreferrer" \n                           class="modal-view-listing-btn backup ').concat("search"===e.type?"search":"listing",'"\n                           title="').concat(e.description||e.name,'">\n                            <i class="fas fa-').concat("search"===e.type?"search":"building",'"></i>\n                            ').concat(e.name,"\n                            ").concat(e.description?"<small>".concat(e.description,"</small>"):"","\n                        </a>\n                    ")).join(""),"\n                </div>\n            ")),n.length>0&&(s+='\n                <div class="additional-backups">\n                    <button class="expand-more-backups" onclick="event.stopPropagation();">\n                        <i class="fas fa-chevron-down"></i>\n                        Show More Options ('.concat(n.length,')\n                    </button>\n                    <div class="backup-buttons additional" style="display: none;">\n                        ').concat(n.map(e=>'\n                            <a href="'.concat(e.url,'" target="_blank" rel="noopener noreferrer" \n                               class="modal-view-listing-btn backup ').concat(e.type,'"\n                               title="').concat(e.description||e.name,'">\n                                <i class="fas fa-').concat("search"===e.type?"search":"building",'"></i>\n                                ').concat(e.name,"\n                            </a>\n                        ")).join(""),"\n                    </div>\n                </div>\n            ")),s+="</div>",s}toggleBackupLinks(e){const t=e.parentElement.querySelector(".backup-links"),a=e.querySelector("i");if(t){const n="none"!==t.style.display;t.style.display=n?"none":"block";const s=e.childNodes[1];n?(s.textContent=" More Options",a.className="fas fa-chevron-down",e.classList.remove("expanded")):(s.textContent=" Hide Alternatives",a.className="fas fa-chevron-up",e.classList.add("expanded"))}}toggleAdditionalBackups(e){const t=e.parentElement.querySelector(".backup-buttons.additional");if(t){const a="none"!==t.style.display;t.style.display=a?"none":"block",e.innerHTML=a?'<i class="fas fa-chevron-down"></i> Show More Options ('.concat(t.children.length,")"):'<i class="fas fa-chevron-up"></i> Hide Additional Options'}}formatDatePosted(e){if(!e)return"Unknown";const t=new Date(e),a=new Date,n=Math.abs(a-t),s=Math.ceil(n/864e5);return 1===s?"Today":2===s?"Yesterday":s<=7?"".concat(s-1," days ago"):t.toLocaleDateString()}}"undefined"!=typeof window&&document.addEventListener("DOMContentLoaded",()=>{new o});export{e as __vite_legacy_guard};
//# sourceMappingURL=index-DxzHSBEf.js.map
