System.register([],function(e,t){"use strict";return{execute:function(){var e=document.createElement("style");e.textContent='*{margin:0;padding:0;box-sizing:border-box}:root{--primary-color: #2c3e50;--secondary-color: #3498db;--accent-color: #e74c3c;--success-color: #27ae60;--warning-color: #f39c12;--light-bg: #f8f9fa;--dark-bg: #2c3e50;--text-dark: #2c3e50;--text-light: #7f8c8d;--border-color: #e0e6ed;--shadow: 0 2px 10px rgba(0,0,0,.1);--shadow-hover: 0 4px 20px rgba(0,0,0,.15);--border-radius: 8px;--transition: all .3s ease}body{font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;line-height:1.6;color:var(--text-dark);background-color:var(--light-bg)}.container{max-width:1200px;margin:0 auto;padding:0 20px}.header{background:linear-gradient(135deg,var(--primary-color),var(--secondary-color));color:#fff;padding:2rem 0;text-align:center}.header-title{font-size:2.5rem;font-weight:700;margin-bottom:.5rem}.header-title i{margin-right:1rem;color:#ecf0f1}.header-subtitle{font-size:1.2rem;opacity:.9;font-weight:300}.main{padding:3rem 0}.search-section{margin-bottom:3rem}.search-card{background:#fff;border-radius:var(--border-radius);padding:2.5rem;box-shadow:var(--shadow);text-align:center;transition:var(--transition)}.search-card:hover{box-shadow:var(--shadow-hover)}.search-card h2{font-size:2rem;margin-bottom:1rem;color:var(--primary-color)}.search-description{color:var(--text-light);font-size:1.1rem;margin-bottom:2rem}.search-criteria{margin-bottom:2.5rem}.criteria-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1.5rem;margin-top:1.5rem}.criteria-item{display:flex;align-items:center;justify-content:center;padding:1rem;background:var(--light-bg);border-radius:var(--border-radius);border:2px solid transparent;transition:var(--transition)}.criteria-item:hover{border-color:var(--secondary-color);transform:translateY(-2px)}.criteria-item i{color:var(--secondary-color);font-size:1.2rem;margin-right:.8rem}.criteria-item span{font-weight:500;color:var(--text-dark)}.search-btn{background:linear-gradient(135deg,var(--secondary-color),#2980b9);color:#fff;border:none;padding:1.2rem 3rem;font-size:1.2rem;font-weight:600;border-radius:50px;cursor:pointer;transition:var(--transition);box-shadow:var(--shadow)}.search-btn:hover{transform:translateY(-2px);box-shadow:var(--shadow-hover)}.search-btn:active{transform:translateY(0)}.search-btn i{margin-right:.8rem}.loading-indicator{text-align:center;padding:2rem}.spinner{width:50px;height:50px;border:4px solid #f3f3f3;border-top:4px solid var(--secondary-color);border-radius:50%;animation:spin 1s linear infinite;margin:0 auto 1rem}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.progress-steps{margin-top:1.5rem;text-align:left}.step{padding:.5rem 0;color:var(--text-light);opacity:.6;transition:var(--transition)}.step.active{color:var(--secondary-color);opacity:1;font-weight:600}.step.completed{color:var(--success-color);opacity:1}.step.completed:before{content:"âœ“ ";margin-right:.5rem}.filter-panel{background:#fff;border-radius:var(--border-radius);margin-bottom:2rem;box-shadow:var(--shadow);overflow:hidden}.filter-header{display:flex;justify-content:space-between;align-items:center;padding:1.5rem;background:var(--light-bg);border-bottom:1px solid var(--border-color);cursor:pointer}.filter-header h3{color:var(--primary-color);font-size:1.3rem}.filter-header i{margin-right:.8rem}.toggle-btn{background:none;border:none;color:var(--text-light);font-size:1.2rem;cursor:pointer;transition:var(--transition)}.toggle-btn:hover{color:var(--secondary-color)}.filter-content{padding:1.5rem;display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1.5rem}.filter-group label{display:block;margin-bottom:.5rem;font-weight:600;color:var(--text-dark)}.filter-group select,.filter-group input[type=range]{width:100%;padding:.8rem;border:1px solid var(--border-color);border-radius:var(--border-radius);font-size:1rem}.filter-group select:focus,.filter-group input:focus{outline:none;border-color:var(--secondary-color)}.checkbox-group{display:flex;flex-direction:column;gap:.8rem}.checkbox-group label{display:flex;align-items:center;font-weight:400;cursor:pointer}.checkbox-group input[type=checkbox]{margin-right:.8rem;width:auto}.results-section{margin-top:2rem}.results-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem;padding-bottom:1rem;border-bottom:2px solid var(--border-color)}.results-header h2{color:var(--primary-color);font-size:2rem}.results-stats{display:flex;align-items:center;gap:1rem}.results-stats span{color:var(--text-light);font-size:1.1rem}.export-btn{background:var(--success-color);color:#fff;border:none;padding:.8rem 1.5rem;border-radius:var(--border-radius);cursor:pointer;transition:var(--transition)}.export-btn:hover{background:#219a52;transform:translateY(-1px)}.recent-listings{margin-bottom:3rem;padding:2rem;background:linear-gradient(135deg,#fff5f5,#ffe8e8);border-radius:var(--border-radius);border-left:4px solid var(--accent-color)}.recent-listings h3{color:var(--accent-color);margin-bottom:1.5rem;font-size:1.5rem}.recent-listings h3 i{margin-right:.8rem}.results-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:2rem}.recent-grid{grid-template-columns:repeat(auto-fill,minmax(300px,1fr))}.apartment-card{background:#fff;border-radius:var(--border-radius);overflow:hidden;box-shadow:var(--shadow);transition:var(--transition);cursor:pointer}.apartment-card:hover{transform:translateY(-4px);box-shadow:var(--shadow-hover)}.card-image{width:100%;height:200px;background:linear-gradient(135deg,#f0f0f0,#e0e0e0);display:flex;align-items:center;justify-content:center;color:var(--text-light);font-size:1.2rem;position:relative}.card-image img{width:100%;height:100%;object-fit:cover}.score-badge{position:absolute;top:1rem;right:1rem;background:var(--success-color);color:#fff;padding:.5rem 1rem;border-radius:20px;font-weight:600;font-size:.9rem}.score-badge.high{background:var(--success-color)}.score-badge.medium{background:var(--warning-color)}.score-badge.low{background:var(--accent-color)}.card-content{padding:1.5rem}.card-title{font-size:1.3rem;font-weight:600;color:var(--primary-color);margin-bottom:.5rem}.card-address{color:var(--text-light);font-size:.95rem;margin-bottom:1rem}.card-details{display:grid;grid-template-columns:repeat(2,1fr);gap:.8rem;margin-bottom:1rem}.detail-item{display:flex;align-items:center;font-size:.9rem}.detail-item i{color:var(--secondary-color);margin-right:.5rem;width:1rem}.card-price{font-size:1.4rem;font-weight:700;color:var(--success-color);text-align:center;padding-top:1rem;border-top:1px solid var(--border-color)}.card-features{display:flex;flex-wrap:wrap;gap:.5rem;margin:1rem 0}.feature-tag{background:var(--light-bg);color:var(--text-dark);padding:.3rem .8rem;border-radius:15px;font-size:.8rem;font-weight:500}.feature-tag.highlight{background:var(--secondary-color);color:#fff}.modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.8);display:flex;align-items:center;justify-content:center;z-index:1000;opacity:0;visibility:hidden;transition:var(--transition)}.modal.show{opacity:1;visibility:visible}.modal-content{background:#fff;border-radius:var(--border-radius);max-width:800px;max-height:90vh;overflow-y:auto;transform:translateY(20px);transition:var(--transition)}.modal.show .modal-content{transform:translateY(0)}.modal-header{display:flex;justify-content:space-between;align-items:center;padding:1.5rem;border-bottom:1px solid var(--border-color)}.modal-header h2{color:var(--primary-color)}.modal-close{background:none;border:none;color:var(--text-light);font-size:1.5rem;cursor:pointer;transition:var(--transition)}.modal-close:hover{color:var(--accent-color)}.modal-body{padding:2rem}.modal-footer{display:flex;justify-content:flex-end;gap:1rem;padding:1.5rem;border-top:1px solid var(--border-color)}.bookmark-btn,.contact-btn{padding:.8rem 1.5rem;border:none;border-radius:var(--border-radius);cursor:pointer;transition:var(--transition);font-weight:600}.bookmark-btn{background:var(--light-bg);color:var(--text-dark)}.bookmark-btn:hover{background:var(--border-color)}.contact-btn{background:var(--secondary-color);color:#fff}.contact-btn:hover{background:#2980b9}.no-results{text-align:center;padding:4rem 2rem;color:var(--text-light)}.no-results i{font-size:4rem;margin-bottom:1rem;opacity:.5}.no-results h3{font-size:1.5rem;margin-bottom:1rem}.toast-container{position:fixed;top:2rem;right:2rem;z-index:1100}.toast{background:#fff;border-radius:var(--border-radius);padding:1rem 1.5rem;margin-bottom:1rem;box-shadow:var(--shadow-hover);border-left:4px solid var(--success-color);transform:translate(400px);transition:var(--transition)}.toast.show{transform:translate(0)}.toast.error{border-left-color:var(--accent-color)}.toast.warning{border-left-color:var(--warning-color)}.text-center{text-align:center}.text-left{text-align:left}.text-right{text-align:right}.mb-1{margin-bottom:1rem}.mb-2{margin-bottom:2rem}.mb-3{margin-bottom:3rem}.mt-1{margin-top:1rem}.mt-2{margin-top:2rem}.mt-3{margin-top:3rem}.hidden{display:none!important}.visible{display:block!important}.fade-in{animation:fadeIn .5s ease-in}@keyframes fadeIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@media (min-width: 1200px){.container{max-width:1400px}.results-grid,.criteria-grid{grid-template-columns:repeat(3,1fr)}}@media (max-width: 1199px){.header-title{font-size:2.2rem}.search-card{padding:2rem}}@media (max-width: 991px){.container{padding:0 15px}.header-title{font-size:2rem}.header-subtitle{font-size:1.1rem}.search-card{padding:1.5rem}.search-card h2{font-size:1.8rem}.criteria-grid{grid-template-columns:repeat(2,1fr);gap:1rem}.results-header{flex-direction:column;gap:1rem;align-items:flex-start}.results-stats{width:100%;justify-content:space-between}.filter-content{grid-template-columns:repeat(2,1fr)}.results-grid{grid-template-columns:repeat(2,1fr);gap:1.5rem}.modal-content{margin:1rem;max-width:calc(100% - 2rem)}}@media (max-width: 767px){.main{padding:2rem 0}.header{padding:1.5rem 0}.header-title{font-size:1.8rem}.header-subtitle{font-size:1rem}.search-card{padding:1.5rem 1rem}.search-card h2{font-size:1.6rem}.search-description{font-size:1rem}.criteria-grid{grid-template-columns:1fr;gap:.8rem}.criteria-item{padding:.8rem;font-size:.9rem}.search-btn{width:100%;padding:1rem 2rem;font-size:1.1rem}.filter-content{grid-template-columns:1fr;gap:1rem}.results-header h2{font-size:1.6rem}.results-stats{flex-direction:column;gap:1rem;align-items:flex-start}.export-btn{width:100%;text-align:center}.results-grid{grid-template-columns:1fr;gap:1rem}.recent-grid{grid-template-columns:1fr}.apartment-card{margin-bottom:1rem}.card-details{grid-template-columns:1fr;gap:.5rem}.modal-content{margin:.5rem;max-width:calc(100% - 1rem);max-height:calc(100vh - 1rem)}.modal-body{padding:1rem}.modal-footer{flex-direction:column;gap:.8rem}.bookmark-btn,.contact-btn{width:100%;text-align:center}.toast-container{right:1rem;left:1rem;top:1rem}.toast{margin-bottom:.8rem}}@media (max-width: 575px){.container{padding:0 10px}.header{padding:1rem 0}.header-title{font-size:1.5rem;margin-bottom:.3rem}.header-title i{margin-right:.5rem}.header-subtitle{font-size:.9rem}.main{padding:1.5rem 0}.search-card{padding:1rem;margin-bottom:2rem}.search-card h2{font-size:1.4rem;margin-bottom:.8rem}.search-description{font-size:.9rem;margin-bottom:1.5rem}.criteria-item{padding:.6rem;font-size:.85rem;flex-direction:column;text-align:center;gap:.3rem}.criteria-item i{margin-right:0;margin-bottom:.3rem}.search-btn{padding:.9rem 1.5rem;font-size:1rem}.loading-indicator{padding:1rem}.progress-steps{font-size:.9rem}.filter-panel{margin-bottom:1.5rem}.filter-header{padding:1rem}.filter-header h3{font-size:1.1rem}.filter-content{padding:1rem}.results-section{margin-top:1.5rem}.results-header{margin-bottom:1.5rem;padding-bottom:.8rem}.results-header h2{font-size:1.4rem}.recent-listings{padding:1rem;margin-bottom:2rem}.recent-listings h3{font-size:1.2rem;margin-bottom:1rem}.apartment-card{border-radius:6px}.card-image{height:180px}.score-badge{top:.8rem;right:.8rem;padding:.4rem .8rem;font-size:.8rem}.card-content{padding:1rem}.card-title{font-size:1.1rem;margin-bottom:.4rem}.card-address{font-size:.85rem;margin-bottom:.8rem}.card-details{gap:.4rem;margin-bottom:.8rem}.detail-item{font-size:.8rem}.card-price{font-size:1.2rem;padding-top:.8rem}.card-features{margin:.8rem 0;gap:.4rem}.feature-tag{padding:.2rem .6rem;font-size:.75rem}.no-results{padding:2rem 1rem}.no-results i{font-size:3rem}.no-results h3{font-size:1.2rem}}@media (max-width: 400px){.header-title{font-size:1.3rem}.search-card h2{font-size:1.2rem}.search-description br{display:none}.criteria-item{padding:.5rem;font-size:.8rem}.search-btn{padding:.8rem 1rem;font-size:.95rem}.modal-content{margin:.25rem;max-width:calc(100% - .5rem)}.toast-container{right:.5rem;left:.5rem}}@media (max-height: 500px) and (orientation: landscape){.header{padding:1rem 0}.header-title{font-size:1.8rem}.main{padding:1rem 0}.search-card{padding:1rem}.modal-content{max-height:95vh}}@media (-webkit-min-device-pixel-ratio: 2),(min-resolution: 192dpi){.apartment-card{box-shadow:0 1px 5px rgba(0,0,0,.15)}.search-card{box-shadow:0 1px 5px rgba(0,0,0,.1)}}@media print{.header,.search-section,.filter-panel,.modal,.toast-container{display:none!important}.results-section{margin-top:0}.apartment-card{box-shadow:none;border:1px solid #ccc;break-inside:avoid;margin-bottom:1rem}.results-grid{grid-template-columns:repeat(2,1fr);gap:1rem}body{background:#fff;color:#000}}\n/*$vite$:1*/',document.head.appendChild(e);class t{constructor(){this.searchCriteria={minRent:4400,maxRent:5200,bedrooms:2,minBathrooms:1.5,maxBathrooms:2,zipCodes:["90066","90230","90232","90034"],zipCodePriority:{90066:1,90230:2,90232:3,90034:4},requiredAmenities:["washer_dryer","air_conditioning","outdoor_space","above_ground_floor"],preferredFeatures:["recently_renovated","modern_interior","natural_light"]},this.dataSources=[{name:"apartments.com",priority:1,active:!0},{name:"westside_rentals",priority:1,active:!0},{name:"zillow",priority:1,active:!0},{name:"trulia",priority:2,active:!0},{name:"hotpads",priority:2,active:!0},{name:"redfin",priority:2,active:!0},{name:"rentcafe",priority:2,active:!0},{name:"zumper",priority:2,active:!0},{name:"realtor.com",priority:2,active:!0},{name:"craigslist",priority:3,active:!0}]}async searchApartments(e){const t=[],r=this.searchCriteria.zipCodes.length+1;for(let o=0;o<this.searchCriteria.zipCodes.length;o++){const a=this.searchCriteria.zipCodes[o];e&&e(o/r*100);try{const e=await this.searchZipCode(a);t.push(...e),await this.delay(500)}catch(n){console.error(`Error searching zip code ${a}:`,n)}}e&&e((r-1)/r*100);const a=t.filter(e=>this.validateApartment(e));return e&&e(100),this.removeDuplicates(a)}async searchZipCode(e){return console.log(`Searching zip code: ${e}`),this.generateMockApartments(e)}generateMockApartments(e){const t=Math.floor(15*Math.random())+5,r=[],a={90066:{areaName:"Mar Vista",basePrice:4800,priceVariance:300,neighborhoods:["Mar Vista","Venice Adjacent","Westside"]},90230:{areaName:"Culver City",basePrice:4600,priceVariance:400,neighborhoods:["Downtown Culver City","Arts District","Hayden Tract"]},90232:{areaName:"Culver City",basePrice:4500,priceVariance:350,neighborhoods:["Fox Hills","Culver West","Baldwin Hills Adjacent"]},90034:{areaName:"Palms",basePrice:4400,priceVariance:300,neighborhoods:["Palms","Motor Avenue","Mid City West"]}}[e],n=["Pacific Ave","Lincoln Blvd","Venice Blvd","Washington Blvd","Motor Ave","Sepulveda Blvd","Culver Blvd","Jefferson Blvd","Pico Blvd","Olympic Blvd","Exposition Blvd","National Blvd"],o=["Modern Apartment Complex","Luxury Townhome","Contemporary Loft","Garden Style Apartment","Mid-Rise Building","Renovated Complex"],i=["In-Unit Washer/Dryer","Central Air Conditioning","Private Balcony","Stainless Steel Appliances","Hardwood Floors","Walk-in Closet","Granite Countertops","Swimming Pool","Fitness Center","Parking Garage","Pet Friendly","Dishwasher","Recently Renovated","Natural Light","High Ceilings","Modern Kitchen","Patio/Deck","Storage Unit"];for(let s=0;s<t;s++){const t=Math.floor(9999*Math.random())+1e3,c=n[Math.floor(Math.random()*n.length)],l=o[Math.floor(Math.random()*o.length)],d=a.basePrice,m=(Math.random()-.5)*a.priceVariance*2,h=50*Math.round((d+m)/50),p=Math.max(4400,Math.min(5200,h)),u=this.selectRandomAmenities(i,8,12),g=Math.floor(8*Math.random())+2,f=900+Math.floor(400*Math.random()),y=Math.random()>.4?2:1.5,v=(p-4400)/800,b=Math.random()<.3+.4*v,w=Math.floor(30*Math.random()),k=new Date(Date.now()-24*w*60*60*1e3),x={id:`apt_${e}_${s}_${Date.now()}`,title:`${l} in ${a.areaName}`,address:`${t} ${c}, ${a.areaName}, CA ${e}`,zipCode:e,price:p,bedrooms:2,bathrooms:y,sqft:f,floor:g,features:u,highlightFeatures:this.getHighlightFeatures(u),recentlyRenovated:b,premiumAmenities:u.includes("Swimming Pool")||u.includes("Fitness Center")||u.includes("Parking Garage"),datePosted:k.toISOString(),source:this.getRandomSource(),contact:{phone:this.generatePhoneNumber(),email:`leasing@${l.toLowerCase().replace(/\s+/g,"")}apartments.com`},images:this.generateMockImages(),description:this.generateDescription(l,a.areaName,u),score:0};r.push(x)}return r}selectRandomAmenities(e,t,r){const a=Math.floor(Math.random()*(r-t+1))+t;return[...e].sort(()=>.5-Math.random()).slice(0,a)}getHighlightFeatures(e){const t=[],r={"In-Unit Washer/Dryer":"In-Unit Washer/Dryer","Central Air Conditioning":"Central Air Conditioning","Private Balcony":"Private Balcony","Recently Renovated":"Recently Renovated","Natural Light":"Natural Light","Modern Kitchen":"Modern Kitchen"};return e.forEach(e=>{r[e]&&t.push(e)}),t}getRandomSource(){const e=["Apartments.com","Westside Rentals","Zillow Rentals","Trulia","HotPads","Redfin","RentCafe","Zumper"];return e[Math.floor(Math.random()*e.length)]}generatePhoneNumber(){return`(${["310","424","323"][Math.floor(3*Math.random())]}) ${Math.floor(900*Math.random())+100}-${Math.floor(9e3*Math.random())+1e3}`}generateMockImages(){const e=Math.floor(5*Math.random())+1,t=[];for(let r=0;r<e;r++)t.push(`https://via.placeholder.com/600x400/f0f0f0/666666?text=Apartment+Image+${r+1}`);return t}generateDescription(e,t,r){const a=[`Beautiful ${e.toLowerCase()} located in the heart of ${t}. This stunning 2-bedroom unit features modern finishes and premium amenities.`,`Discover luxury living in this ${e.toLowerCase()} in ${t}. Perfectly designed for comfort and style.`,`Spacious and bright 2-bedroom apartment in a desirable ${t} location. This ${e.toLowerCase()} offers the perfect blend of comfort and convenience.`];return`${a[Math.floor(Math.random()*a.length)]} Key features include: ${r.slice(0,4).join(", ")}. Contact us today to schedule a viewing!`}removeDuplicates(e){const t=new Set;return e.filter(e=>{const r=`${e.address}_${e.price}_${e.bedrooms}`;return!t.has(r)&&(t.add(r),!0)})}delay(e){return new Promise(t=>setTimeout(t,e))}validateApartment(e){const t=this.searchCriteria;if(e.price<t.minRent||e.price>t.maxRent)return!1;if(e.bedrooms!==t.bedrooms)return!1;if(e.bathrooms<t.minBathrooms||e.bathrooms>t.maxBathrooms)return!1;const r=e.features.map(e=>e.toLowerCase()),a=r.some(e=>e.includes("washer")&&e.includes("dryer")),n=r.some(e=>e.includes("air")||e.includes("conditioning")),o=r.some(e=>e.includes("balcony")||e.includes("patio")||e.includes("deck")),i=e.floor>1;return!!(a&&n&&o&&i)}}class r{constructor(){this.weights={rentInRange:20,mandatoryAmenities:30,renovationRecency:25,naturalLight:15,outdoorSpaceQuality:10,zipCodePriority:10,premiumAmenities:5,locationRating:5,professionalPhotos:3,floorLevel:2},this.maxScore=100}calculateScore(e,t={minRent:4400,maxRent:5200,zipCodePriority:{90066:1,90230:2,90232:3,90034:4}}){let r=0;return r+=this.calculateRentScore(e.price,t),r+=this.calculateMandatoryAmenityScore(e),r+=this.calculateRenovationScore(e),r+=this.calculateNaturalLightScore(e),r+=this.calculateOutdoorSpaceScore(e),r+=this.calculateZipCodeScore(e.zipCode,t),r+=this.calculatePremiumAmenitiesScore(e),r+=this.calculateLocationRatingScore(e),r+=this.calculatePhotoScore(e),r+=this.calculateFloorScore(e),Math.round(Math.min(r,this.maxScore))}getScoreBreakdown(e,t={minRent:4400,maxRent:5200,zipCodePriority:{90066:1,90230:2,90232:3,90034:4}}){const r={};return r.price=this.calculateRentScore(e.price,t),r.specs=this.calculateMandatoryAmenityScore(e),r.floor=this.calculateFloorScore(e),r.features=this.calculateRenovationScore(e)+this.calculateNaturalLightScore(e)+this.calculateOutdoorSpaceScore(e),r.renovation=e.recentlyRenovated?10:0,r.total=Math.min(r.price+r.specs+r.floor+r.features+r.renovation,100),r}calculateRentScore(e,t){const{minRent:r,maxRent:a}=t;if(e<r||e>a)return 0;const n=(r+a)/2,o=(a-r)/2,i=Math.abs(e-n),s=this.weights.rentInRange*(1-i/o);return Math.round(s)}calculateMandatoryAmenityScore(e){const t={washerDryer:!1,airConditioning:!1,outdoorSpace:!1,aboveGroundFloor:!1},r=e.features.map(e=>e.toLowerCase());t.washerDryer=r.some(e=>e.includes("washer")&&e.includes("dryer")||e.includes("w/d")||e.includes("laundry")),t.airConditioning=r.some(e=>e.includes("air")||e.includes("conditioning")||e.includes("hvac")||e.includes("central air")),t.outdoorSpace=r.some(e=>e.includes("balcony")||e.includes("patio")||e.includes("terrace")||e.includes("deck")||e.includes("outdoor")),t.aboveGroundFloor=e.floor>1;const a=Object.values(t).filter(Boolean).length/Object.keys(t).length;return Math.round(this.weights.mandatoryAmenities*a)}calculateRenovationScore(e){const t=e.features.map(e=>e.toLowerCase()),r=["renovated","updated","remodeled","modern","new","contemporary","upgraded","refreshed","redesigned"],a=t.some(e=>r.some(t=>e.includes(t))),n=e.recentlyRenovated||!1,o=["stainless steel","granite","quartz","hardwood","modern kitchen","designer","luxury"],i=t.some(e=>o.some(t=>e.includes(t)));let s=0;return s=n?this.weights.renovationRecency:a&&i?.8*this.weights.renovationRecency:a||i?.5*this.weights.renovationRecency:.2*this.weights.renovationRecency,Math.round(s)}calculateNaturalLightScore(e){const t=e.features.map(e=>e.toLowerCase()),r=e.description?.toLowerCase()||"",a=["natural light","bright","sunny","light-filled","windows","large windows","floor-to-ceiling","multiple exposures","corner unit"],n=t.concat([r]).some(e=>a.some(t=>e.includes(t))),o=e.floor>5?.2:0;let i=0;return i=n?this.weights.naturalLight*(.8+o):this.weights.naturalLight*(.4+o),Math.round(i)}calculateOutdoorSpaceScore(e){const t=e.features.map(e=>e.toLowerCase()),r={"private balcony":1,terrace:1,"private patio":.9,deck:.8,balcony:.7,patio:.6,outdoor:.5};let a=0;for(const[n,o]of Object.entries(r))t.some(e=>e.includes(n))&&(a=Math.max(a,this.weights.outdoorSpaceQuality*o));return Math.round(a)}calculateZipCodeScore(e,t){const r=t.zipCodePriority[e]||5,a=Math.max(0,(5-r)/4);return Math.round(this.weights.zipCodePriority*a)}calculatePremiumAmenitiesScore(e){const t=e.features.map(e=>e.toLowerCase()),r=["swimming pool","fitness center","gym","concierge","doorman","roof deck","rooftop","parking garage","valet parking","business center","club room"],a=t.filter(e=>r.some(t=>e.includes(t))).length,n=Math.min(1.5*a,this.weights.premiumAmenities);return Math.round(n)}calculateLocationRatingScore(e){const t={90066:4.5,90230:4.2,90232:3.8,90034:3.5}[e.zipCode]||3,r=e.price>4800?.2:0,a=Math.min(t+r,5),n=Math.max(0,(a-3)/2);return Math.round(this.weights.locationRating*n)}calculatePhotoScore(e){const t=e.images?.length||0;return t>=5?this.weights.professionalPhotos:t>=3?Math.round(.7*this.weights.professionalPhotos):t>=1?Math.round(.4*this.weights.professionalPhotos):0}calculateFloorScore(e){const t=e.floor||2;return t>=3&&t<=6?this.weights.floorLevel:2===t||7===t||8===t?Math.round(.7*this.weights.floorLevel):t>8?Math.round(.5*this.weights.floorLevel):0}}new class{constructor(){this.modal=null,this.toastContainer=null,this.init()}init(){this.modal=document.getElementById("apartmentModal"),this.toastContainer=document.getElementById("toastContainer"),this.bindGlobalEvents()}bindGlobalEvents(){document.addEventListener("keydown",e=>{if("Escape"===e.key&&this.modal&&this.modal.classList.contains("show")&&this.closeModal(),e.ctrlKey&&"f"===e.key){e.preventDefault();const t=document.getElementById("searchBtn");t&&"none"!==t.style.display&&t.focus()}}),window.addEventListener("resize",this.debounce(()=>{this.adjustLayoutForViewport()},250)),window.addEventListener("scroll",this.throttle(()=>{this.handleScroll()},100))}showModal(e,t="Details"){if(!this.modal)return;const r=this.modal.querySelector("#modalTitle"),a=this.modal.querySelector("#modalBody");r&&(r.textContent=t),a&&(a.innerHTML=e),this.modal.style.display="flex",setTimeout(()=>{this.modal.classList.add("show"),this.trapFocus(this.modal)},10),document.body.style.overflow="hidden"}closeModal(){this.modal&&(this.modal.classList.remove("show"),setTimeout(()=>{this.modal.style.display="none",document.body.style.overflow=""},300))}showToast(e,t="info",r=4e3,a=null){if(!this.toastContainer)return;const n=document.createElement("div");n.className=`toast ${t}`;const o={success:"fa-check-circle",error:"fa-exclamation-circle",warning:"fa-exclamation-triangle",info:"fa-info-circle"},i=o[t]||o.info;let s="";return a&&a.length>0&&(s=`\n                <div class="toast-actions">\n                    ${a.map(e=>`<button class="toast-action" data-action="${e.id}">${e.label}</button>`).join("")}\n                </div>\n            `),n.innerHTML=`\n            <div class="toast-content">\n                <div class="toast-icon">\n                    <i class="fas ${i}"></i>\n                </div>\n                <div class="toast-message">\n                    <span>${e}</span>\n                    ${s}\n                </div>\n                <button class="toast-close">\n                    <i class="fas fa-times"></i>\n                </button>\n            </div>\n        `,n.querySelector(".toast-close").addEventListener("click",()=>this.removeToast(n)),a&&n.querySelectorAll(".toast-action").forEach(e=>{e.addEventListener("click",e=>{const t=e.target.dataset.action,r=a.find(e=>e.id===t);r&&r.callback&&r.callback(),this.removeToast(n)})}),this.toastContainer.appendChild(n),setTimeout(()=>n.classList.add("show"),100),r>0&&setTimeout(()=>this.removeToast(n),r),n}removeToast(e){e&&e.parentNode&&(e.classList.remove("show"),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},300))}showLoadingSpinner(e,t="Loading..."){if(!e)return;const r=document.createElement("div");return r.className="loading-overlay",r.innerHTML=`\n            <div class="spinner-container">\n                <div class="spinner"></div>\n                <span class="loading-text">${t}</span>\n            </div>\n        `,e.style.position="relative",e.appendChild(r),r}hideLoadingSpinner(e){if(!e)return;const t=e.querySelector(".loading-overlay");t&&t.remove()}adjustLayoutForViewport(){const e=this.getViewportSize(),t=document.querySelector(".results-grid");if(t&&(e.width<768?t.style.gridTemplateColumns="1fr":e.width<1200?t.style.gridTemplateColumns="repeat(2, 1fr)":t.style.gridTemplateColumns="repeat(3, 1fr)"),this.modal){const t=this.modal.querySelector(".modal-content");t&&(e.width<768?(t.style.margin="1rem",t.style.maxHeight="calc(100vh - 2rem)"):(t.style.margin="2rem",t.style.maxHeight="90vh"))}}getViewportSize(){return{width:window.innerWidth,height:window.innerHeight}}handleScroll(){const e=window.scrollY,t=document.querySelector(".header");t&&(e>50?t.classList.add("scrolled"):t.classList.remove("scrolled")),this.toggleBackToTop(e>300)}toggleBackToTop(e){let t=document.getElementById("backToTop");e&&!t&&(t=document.createElement("button"),t.id="backToTop",t.className="back-to-top",t.innerHTML='<i class="fas fa-chevron-up"></i>',t.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})}),document.body.appendChild(t)),t&&(t.style.display=e?"block":"none")}trapFocus(e){const t=e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),r=t[0],a=t[t.length-1];r&&r.focus(),e.addEventListener("keydown",e=>{"Tab"===e.key&&(e.shiftKey?document.activeElement===r&&(e.preventDefault(),a.focus()):document.activeElement===a&&(e.preventDefault(),r.focus()))})}fadeIn(e,t=300){e.style.opacity="0",e.style.display="block";let r=null;const a=n=>{r||(r=n);const o=(n-r)/t;e.style.opacity=Math.min(o,1),o<1&&requestAnimationFrame(a)};requestAnimationFrame(a)}fadeOut(e,t=300){let r=null;const a=n=>{r||(r=n);const o=(n-r)/t;e.style.opacity=1-Math.min(o,1),o>=1?e.style.display="none":requestAnimationFrame(a)};requestAnimationFrame(a)}slideDown(e,t=300){e.style.height="0",e.style.overflow="hidden",e.style.display="block";const r=e.scrollHeight;let a=null;const n=o=>{a||(a=o);const i=(o-a)/t;e.style.height=r*Math.min(i,1)+"px",i>=1?(e.style.height="",e.style.overflow=""):requestAnimationFrame(n)};requestAnimationFrame(n)}slideUp(e,t=300){const r=e.offsetHeight;let a=null;const n=o=>{a||(a=o);const i=(o-a)/t;e.style.height=r*(1-Math.min(i,1))+"px",e.style.overflow="hidden",i>=1?(e.style.display="none",e.style.height="",e.style.overflow=""):requestAnimationFrame(n)};requestAnimationFrame(n)}debounce(e,t){let r;return function(...a){clearTimeout(r),r=setTimeout(()=>{clearTimeout(r),e(...a)},t)}}throttle(e,t){let r;return function(...a){r||(e.apply(this,a),r=!0,setTimeout(()=>r=!1,t))}}formatPrice(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}formatDate(e){return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(new Date(e))}formatPhoneNumber(e){const t=e.replace(/\D/g,"").match(/^(\d{3})(\d{3})(\d{4})$/);return t?`(${t[1]}) ${t[2]}-${t[3]}`:e}isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}isValidPhone(e){return 10===e.replace(/\D/g,"").length}saveToStorage(e,t){try{return localStorage.setItem(e,JSON.stringify(t)),!0}catch(r){return console.error("Error saving to localStorage:",r),!1}}loadFromStorage(e,t=null){try{const r=localStorage.getItem(e);return r?JSON.parse(r):t}catch(r){return console.error("Error loading from localStorage:",r),t}}removeFromStorage(e){try{return localStorage.removeItem(e),!0}catch(t){return console.error("Error removing from localStorage:",t),!1}}};class a{constructor(){this.apartments=[],this.filteredApartments=[],this.bookmarkedApartments=JSON.parse(localStorage.getItem("bookmarkedApartments")||"[]"),this.isSearching=!1,this.init()}init(){this.bindEvents(),this.loadBookmarks(),console.log("Apartment Finder App initialized")}bindEvents(){document.getElementById("searchBtn").addEventListener("click",()=>this.startSearch()),document.getElementById("sortBy").addEventListener("change",()=>this.applyFilters()),document.getElementById("minScore").addEventListener("input",e=>{document.getElementById("minScoreValue").textContent=e.target.value,this.applyFilters()}),["recentOnly","renovatedOnly","premiumOnly"].forEach(e=>{document.getElementById(e).addEventListener("change",()=>this.applyFilters())});const e=document.getElementById("toggleFilters"),t=document.querySelector(".filter-content");e.addEventListener("click",()=>{const r="none"!==t.style.display;t.style.display=r?"none":"block",e.innerHTML=r?'<i class="fas fa-chevron-down"></i>':'<i class="fas fa-chevron-up"></i>'});const r=document.getElementById("apartmentModal");document.getElementById("closeModal").addEventListener("click",()=>this.closeModal()),r.addEventListener("click",e=>{e.target===r&&this.closeModal()}),document.getElementById("exportBtn").addEventListener("click",()=>this.exportResults()),document.addEventListener("keydown",e=>{"Escape"===e.key&&"none"!==r.style.display&&this.closeModal(),"Enter"===e.key&&e.ctrlKey&&!this.isSearching&&this.startSearch()})}async startSearch(){if(!this.isSearching){this.isSearching=!0,this.showLoadingState();try{const e=new t,a=new r,n=await e.searchApartments(e=>{this.updateProgress(e)});this.apartments=n.map(e=>({...e,score:a.calculateScore(e),scoreBreakdown:a.getScoreBreakdown(e)})),this.applyFilters(),this.showResults()}catch(e){console.error("Search failed:",e),this.showToast("Search failed. Please try again.","error")}finally{this.isSearching=!1,this.hideLoadingState()}}}showLoadingState(){const e=document.getElementById("searchBtn"),t=document.getElementById("loadingIndicator");e.style.display="none",t.style.display="block",document.getElementById("resultsSection").style.display="none",document.getElementById("filterPanel").style.display="none"}hideLoadingState(){const e=document.getElementById("searchBtn"),t=document.getElementById("loadingIndicator");e.style.display="inline-block",t.style.display="none"}updateProgress(e){const t=Math.min(Math.floor(e/25),3);["step1","step2","step3","step4"].forEach((e,r)=>{const a=document.getElementById(e);a.className=r<t?"step completed":r===t?"step active":"step"})}applyFilters(){if(!this.apartments.length)return;let e=[...this.apartments];const t=parseInt(document.getElementById("minScore").value);if(e=e.filter(e=>e.score>=t),document.getElementById("recentOnly").checked){const t=new Date(Date.now()-6048e5);e=e.filter(e=>new Date(e.datePosted)>t)}document.getElementById("renovatedOnly").checked&&(e=e.filter(e=>e.recentlyRenovated)),document.getElementById("premiumOnly").checked&&(e=e.filter(e=>e.premiumAmenities));const r=document.getElementById("sortBy").value;e.sort((e,t)=>{switch(r){case"score":default:return t.score-e.score;case"price-low":return e.price-t.price;case"price-high":return t.price-e.price;case"newest":return new Date(t.datePosted)-new Date(e.datePosted)}}),this.filteredApartments=e,this.renderResults()}showResults(){document.getElementById("resultsSection").style.display="block",document.getElementById("filterPanel").style.display="block",document.getElementById("resultsSection").scrollIntoView({behavior:"smooth"})}renderResults(){const e=document.getElementById("resultsGrid"),t=document.getElementById("recentResults"),r=document.getElementById("recentListings"),a=document.getElementById("noResults");if(document.getElementById("resultsCount").textContent=`${this.filteredApartments.length} apartments found`,0===this.filteredApartments.length)return e.innerHTML="",t.innerHTML="",r.style.display="none",void(a.style.display="block");a.style.display="none";const n=new Date(Date.now()-6048e5),o=this.filteredApartments.filter(e=>new Date(e.datePosted)>n),i=this.filteredApartments;o.length>0?(r.style.display="block",t.innerHTML=o.slice(0,6).map(e=>this.createApartmentCard(e,!0)).join("")):r.style.display="none",e.innerHTML=i.map(e=>this.createApartmentCard(e)).join(""),document.querySelectorAll(".apartment-card").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.apartmentId,r=this.apartments.find(e=>e.id===t);this.showApartmentDetails(r)})})}createApartmentCard(e,t=!1){const r=e.score>=80?"high":e.score>=60?"medium":"low",a=e.features.slice(0,3).map(t=>`<span class="feature-tag ${e.highlightFeatures?.includes(t)?"highlight":""}">${t}</span>`).join(""),n=this.bookmarkedApartments.includes(e.id);return`\n            <div class="apartment-card fade-in" data-apartment-id="${e.id}">\n                <div class="card-image">\n                    ${e.images&&e.images.length>0?`<img src="${e.images[0]}" alt="${e.title}" onerror="this.style.display='none'">`:'<i class="fas fa-image">No Image Available</i>'}\n                    <div class="score-badge ${r}">${e.score}</div>\n                    ${n?'<div class="bookmark-indicator"><i class="fas fa-bookmark"></i></div>':""}\n                </div>\n                <div class="card-content">\n                    <h3 class="card-title">${e.title}</h3>\n                    <p class="card-address">\n                        <i class="fas fa-map-marker-alt"></i>\n                        ${e.address}\n                    </p>\n                    \n                    <div class="card-details">\n                        <div class="detail-item">\n                            <i class="fas fa-bed"></i>\n                            ${e.bedrooms} bed\n                        </div>\n                        <div class="detail-item">\n                            <i class="fas fa-bath"></i>\n                            ${e.bathrooms} bath\n                        </div>\n                        <div class="detail-item">\n                            <i class="fas fa-ruler-combined"></i>\n                            ${e.sqft||"N/A"} sq ft\n                        </div>\n                        <div class="detail-item">\n                            <i class="fas fa-building"></i>\n                            Floor ${e.floor||"N/A"}\n                        </div>\n                    </div>\n                    \n                    <div class="card-features">\n                        ${a}\n                        ${e.features.length>3?`<span class="feature-tag">+${e.features.length-3} more</span>`:""}\n                    </div>\n                    \n                    <div class="card-price">$${e.price.toLocaleString()}/month</div>\n                </div>\n            </div>\n        `}showApartmentDetails(e){const t=document.getElementById("apartmentModal"),r=document.getElementById("modalTitle"),a=document.getElementById("modalBody"),n=document.getElementById("bookmarkBtn");r.textContent=e.title;const o=e.score>=80?"high":e.score>=60?"medium":"low",i=e.images&&e.images.length>0?`<div class="image-gallery">\n                ${e.images.map(e=>`<img src="${e}" alt="Apartment image" style="width: 100%; margin-bottom: 1rem; border-radius: 8px;">`).join("")}\n            </div>`:'<div class="no-image">No images available</div>';a.innerHTML=`\n            ${i}\n            \n            <div class="apartment-details">\n                <div class="detail-header">\n                    <div class="score-display">\n                        <span class="score-badge ${o}">${e.score}</span>\n                        <span class="score-label">Match Score</span>\n                    </div>\n                    <div class="price-display">\n                        <span class="price">$${e.price.toLocaleString()}</span>\n                        <span class="price-label">per month</span>\n                    </div>\n                </div>\n                \n                <div class="address-section">\n                    <h4><i class="fas fa-map-marker-alt"></i> Address</h4>\n                    <p>${e.address}</p>\n                    <p><strong>Zip Code:</strong> ${e.zipCode}</p>\n                </div>\n                \n                <div class="specs-section">\n                    <h4><i class="fas fa-info-circle"></i> Specifications</h4>\n                    <div class="specs-grid">\n                        <div class="spec-item">\n                            <i class="fas fa-bed"></i>\n                            <span>${e.bedrooms} Bedrooms</span>\n                        </div>\n                        <div class="spec-item">\n                            <i class="fas fa-bath"></i>\n                            <span>${e.bathrooms} Bathrooms</span>\n                        </div>\n                        <div class="spec-item">\n                            <i class="fas fa-ruler-combined"></i>\n                            <span>${e.sqft||"N/A"} sq ft</span>\n                        </div>\n                        <div class="spec-item">\n                            <i class="fas fa-building"></i>\n                            <span>Floor ${e.floor||"N/A"}</span>\n                        </div>\n                    </div>\n                </div>\n                \n                <div class="amenities-section">\n                    <h4><i class="fas fa-star"></i> Amenities & Features</h4>\n                    <div class="amenities-grid">\n                        ${e.features.map(t=>`<div class="amenity-item ${e.highlightFeatures?.includes(t)?"highlight":""}">\n                                <i class="fas fa-check"></i>\n                                ${t}\n                            </div>`).join("")}\n                    </div>\n                </div>\n                \n                ${e.description?`\n                    <div class="description-section">\n                        <h4><i class="fas fa-file-text"></i> Description</h4>\n                        <p>${e.description}</p>\n                    </div>\n                `:""}\n                \n                <div class="contact-section">\n                    <h4><i class="fas fa-phone"></i> Contact Information</h4>\n                    <p><strong>Phone:</strong> ${e.contact?.phone||"Not available"}</p>\n                    <p><strong>Email:</strong> ${e.contact?.email||"Not available"}</p>\n                    <p><strong>Source:</strong> ${e.source}</p>\n                    <p><strong>Posted:</strong> ${new Date(e.datePosted).toLocaleDateString()}</p>\n                </div>\n            </div>\n        `;const s=this.bookmarkedApartments.includes(e.id);n.innerHTML=s?'<i class="fas fa-bookmark"></i> Bookmarked':'<i class="far fa-bookmark"></i> Bookmark',n.onclick=()=>this.toggleBookmark(e.id),t.style.display="flex",setTimeout(()=>t.classList.add("show"),10)}closeModal(){const e=document.getElementById("apartmentModal");e.classList.remove("show"),setTimeout(()=>e.style.display="none",300)}toggleBookmark(e){const t=this.bookmarkedApartments.indexOf(e);t>-1?(this.bookmarkedApartments.splice(t,1),this.showToast("Bookmark removed","warning")):(this.bookmarkedApartments.push(e),this.showToast("Apartment bookmarked!","success")),localStorage.setItem("bookmarkedApartments",JSON.stringify(this.bookmarkedApartments)),this.renderResults();const r=document.getElementById("bookmarkBtn"),a=this.bookmarkedApartments.includes(e);r.innerHTML=a?'<i class="fas fa-bookmark"></i> Bookmarked':'<i class="far fa-bookmark"></i> Bookmark'}loadBookmarks(){console.log(`Loaded ${this.bookmarkedApartments.length} bookmarked apartments`)}exportResults(){if(0===this.filteredApartments.length)return void this.showToast("No results to export","warning");const e=this.filteredApartments.map(e=>({title:e.title,address:e.address,price:e.price,bedrooms:e.bedrooms,bathrooms:e.bathrooms,sqft:e.sqft,score:e.score,features:e.features.join(", "),contact:e.contact?.phone||"",source:e.source,datePosted:e.datePosted})),t=this.convertToCSV(e);this.downloadCSV(t,"apartment-search-results.csv"),this.showToast("Results exported successfully!","success")}convertToCSV(e){return[Object.keys(e[0]).join(","),...e.map(e=>Object.values(e).map(e=>"string"==typeof e&&e.includes(",")?`"${e}"`:e).join(","))].join("\n")}downloadCSV(e,t){const r=new Blob([e],{type:"text/csv"}),a=window.URL.createObjectURL(r),n=document.createElement("a");n.setAttribute("hidden",""),n.setAttribute("href",a),n.setAttribute("download",t),document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(a)}showToast(e,t="success"){const r=document.getElementById("toastContainer"),a=document.createElement("div");a.className=`toast ${t}`,a.innerHTML=`\n            <div class="toast-content">\n                <i class="fas fa-${"success"===t?"check-circle":"error"===t?"exclamation-circle":"exclamation-triangle"}"></i>\n                <span>${e}</span>\n            </div>\n        `,r.appendChild(a),setTimeout(()=>a.classList.add("show"),100),setTimeout(()=>{a.classList.remove("show"),setTimeout(()=>r.removeChild(a),300)},4e3)}}"undefined"!=typeof window&&document.addEventListener("DOMContentLoaded",()=>{new a}),new class{constructor(){this.apiKey=null,this.baseURL="https://api.anthropic.com/v1/messages",this.model="claude-3-sonnet-20240229",this.maxTokens=1e3,this.init()}init(){this.apiKey=localStorage.getItem("claude_api_key"),this.apiKey||this.showAPIKeySetup()}showAPIKeySetup(){if(document.getElementById("apiKeySetup"))return;const e=document.createElement("div");e.id="apiKeySetup",e.className="api-key-setup",e.innerHTML='\n            <div class="setup-content">\n                <h3><i class="fas fa-key"></i> API Configuration</h3>\n                <p>To enable Claude AI enhanced search features, please enter your Anthropic API key:</p>\n                <div class="input-group">\n                    <input type="password" id="apiKeyInput" placeholder="sk-ant-api..." />\n                    <button id="saveApiKey" class="btn-primary">Save</button>\n                </div>\n                <div class="setup-info">\n                    <p><small>\n                        <i class="fas fa-info-circle"></i>\n                        Your API key is stored locally and never shared. \n                        <a href="https://console.anthropic.com/" target="_blank">Get your API key here</a>\n                    </small></p>\n                </div>\n                <button id="skipApiKey" class="btn-secondary">Skip (Use Mock Data)</button>\n            </div>\n        ',document.body.appendChild(e),document.getElementById("saveApiKey").addEventListener("click",()=>{const t=document.getElementById("apiKeyInput").value.trim();t&&(this.setAPIKey(t),e.remove())}),document.getElementById("skipApiKey").addEventListener("click",()=>{e.remove()}),document.getElementById("apiKeyInput").addEventListener("keypress",e=>{"Enter"===e.key&&document.getElementById("saveApiKey").click()})}setAPIKey(e){this.apiKey=e,localStorage.setItem("claude_api_key",e),console.log("Claude API key configured")}async enhanceApartmentDescriptions(e){if(!this.apiKey||0===e.length)return e;try{const t=this.buildDescriptionEnhancementPrompt(e),r=await this.callClaudeAPI(t);if(r&&r.enhanced_descriptions)return this.applyEnhancedDescriptions(e,r.enhanced_descriptions)}catch(t){console.error("Error enhancing descriptions:",t)}return e}async generateSearchInsights(e){if(!this.apiKey||0===e.length)return null;try{const t=this.buildInsightsPrompt(e);return await this.callClaudeAPI(t)}catch(t){return console.error("Error generating insights:",t),null}}buildDescriptionEnhancementPrompt(e){const t=e.slice(0,10).map((e,t)=>({id:t,title:e.title,address:e.address,price:e.price,features:e.features.slice(0,6),score:e.score}));return`\nYou are a real estate expert helping to enhance apartment descriptions for a luxury apartment search in West Los Angeles. \n\nHere are ${t.length} apartments that match the search criteria:\n\n${JSON.stringify(t,null,2)}\n\nPlease provide enhanced descriptions for these apartments that:\n1. Highlight the most appealing features\n2. Use professional real estate language\n3. Emphasize luxury and comfort aspects\n4. Keep descriptions concise (2-3 sentences)\n5. Focus on what makes each apartment unique\n\nRespond in JSON format:\n{\n  "enhanced_descriptions": [\n    {\n      "id": 0,\n      "enhanced_description": "Enhanced description here..."\n    }\n  ]\n}\n        `}buildInsightsPrompt(e){const t=e.slice(0,5),r=e.reduce((e,t)=>e+t.price,0)/e.length,a=e.filter(e=>e.score>=80).length,n=e.filter(e=>e.score>=60&&e.score<80).length,o=e.filter(e=>e.score<60).length;return`\nYou are a real estate market analyst. Analyze this apartment search data for West Los Angeles and provide insights.\n\nSearch Results Summary:\n- Total apartments found: ${e.length}\n- Average price: $${Math.round(r)}\n- Score distribution: ${a} high-scoring, ${n} medium-scoring, ${o} low-scoring\n\nTop 5 apartments:\n${JSON.stringify(t.map(e=>({title:e.title,address:e.address,price:e.price,score:e.score,zipCode:e.zipCode})),null,2)}\n\nPlease provide:\n1. Market insights about pricing trends\n2. Best value recommendations\n3. Areas to focus on for better options\n4. Red flags to watch for\n5. Negotiation opportunities\n\nRespond in JSON format with actionable insights.\n        `}async callClaudeAPI(e){if(!this.apiKey)throw new Error("API key not configured");const t=await fetch(this.baseURL,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":this.apiKey,"anthropic-version":"2023-06-01"},body:JSON.stringify({model:this.model,max_tokens:this.maxTokens,messages:[{role:"user",content:e}]})});if(!t.ok)throw new Error(`API call failed: ${t.status} ${t.statusText}`);const r=await t.json();try{return JSON.parse(r.content[0].text)}catch(a){return console.error("Error parsing Claude response:",a),{error:"Failed to parse response"}}}applyEnhancedDescriptions(e,t){const r=new Map;return t.forEach(e=>{r.set(e.id,e.enhanced_description)}),e.map((e,t)=>t<10&&r.has(t)?{...e,description:r.get(t),enhanced:!0}:e)}async intelligentFilter(e,t){if(!this.apiKey||!t.trim())return e;try{const r=`\nYou are helping filter apartment listings based on user preferences. \n\nUser query: "${t}"\n\nAvailable apartments (showing first 20):\n${JSON.stringify(e.slice(0,20).map(e=>({id:e.id,title:e.title,address:e.address,price:e.price,features:e.features,score:e.score})),null,2)}\n\nBased on the user query, rank these apartments and explain why each is relevant or not relevant.\nFocus on matching user intent, not just keywords.\n\nRespond in JSON format:\n{\n  "filtered_apartments": [\n    {\n      "id": "apartment_id",\n      "relevance_score": 85,\n      "reason": "Why this apartment matches the query"\n    }\n  ]\n}\n            `,a=await this.callClaudeAPI(r);if(a&&a.filtered_apartments)return this.applyIntelligentFiltering(e,a.filtered_apartments)}catch(r){console.error("Error in intelligent filtering:",r)}return e}applyIntelligentFiltering(e,t){const r=new Map;return t.forEach(e=>{r.set(e.id,{relevance:e.relevance_score,reason:e.reason})}),e.map(e=>{const t=r.get(e.id);return t?{...e,aiRelevance:t.relevance,aiReason:t.reason}:e}).filter(e=>void 0!==e.aiRelevance).sort((e,t)=>(t.aiRelevance||0)-(e.aiRelevance||0))}async generateRecommendations(e,t={}){if(!this.apiKey)return this.generateMockRecommendations(e);try{const r=`\nAs a real estate expert, provide personalized apartment recommendations based on user preferences and available listings.\n\nUser Preferences:\n${JSON.stringify(t,null,2)}\n\nAvailable Apartments (top 10 by score):\n${JSON.stringify(e.slice(0,10).map(e=>({title:e.title,address:e.address,price:e.price,features:e.features,score:e.score,zipCode:e.zipCode})),null,2)}\n\nProvide:\n1. Top 3 recommendations with detailed reasoning\n2. Alternative options to consider\n3. What to negotiate on\n4. Potential concerns to investigate\n\nRespond in JSON format with actionable recommendations.\n            `;return await this.callClaudeAPI(r)}catch(r){return console.error("Error generating recommendations:",r),this.generateMockRecommendations(e)}}generateMockRecommendations(e){return{recommendations:e.slice(0,3).map((e,t)=>({apartment_id:e.id,ranking:t+1,reason:`High score of ${e.score} with excellent ${e.features.slice(0,2).join(" and ")}`,strengths:e.features.slice(0,3),concerns:["Verify parking availability","Check actual condition"]})),market_insights:{avg_price:Math.round(e.reduce((e,t)=>e+t.price,0)/e.length),best_value:e.find(e=>e.score>70&&e.price<4700)?.id||null,negotiation_tip:"Focus on move-in incentives rather than base rent"}}}async testAPIConnection(){if(!this.apiKey)return{success:!1,error:"No API key configured"};try{return{success:!0,response:await this.callClaudeAPI('Test connection. Respond with: {"status": "connected"}')}}catch(e){return{success:!1,error:e.message}}}}}}});
//# sourceMappingURL=index-legacy-CZkOFZSz.js.map
